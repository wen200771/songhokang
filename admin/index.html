<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÈÄÅÈΩÅÂ∫∑ÁÆ°ÁêÜÂæåÂè∞ - Á≥ªÁµ±ÁÆ°ÁêÜ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f8f7f6 0%, #e8e6e3 100%);
            min-height: 100vh;
            color: #1f2937;
            line-height: 1.6;
        }

        /* È†≠ÈÉ®Â∞éËà™ */
        .header {
            background: rgba(248, 247, 246, 0.9);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(252, 163, 17, 0.2);
            padding: 0 24px;
            height: 64px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(252, 163, 17, 0.1);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 20px;
            font-weight: 700;
            color: #1f2937;
        }

        .logo span {
            font-size: 24px;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .switch-info {
            background: rgba(252, 163, 17, 0.1);
            border: 1px solid rgba(252, 163, 17, 0.3);
            border-radius: 12px;
            padding: 8px 16px;
            font-size: 14px;
            color: #92400e;
            display: none;
        }

        /* ‰∏ªË¶ÅÂ∏ÉÂ±Ä */
        .layout {
            display: flex;
            min-height: calc(100vh - 64px);
        }

        /* ÂÅ¥ÈÇäÊ¨Ñ */
        .sidebar {
            width: 280px;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(252, 163, 17, 0.2);
            padding: 24px 0;
            overflow-y: auto;
        }

        .nav-menu {
            list-style: none;
            padding: 0 16px;
        }

        .nav-item {
            margin-bottom: 8px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: 12px;
            text-decoration: none;
            color: #6b7280;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
            font-size: 16px;
        }

        .nav-link:hover {
            background: rgba(252, 163, 17, 0.1);
            color: #FCA311;
        }

        .nav-link.active {
            background: linear-gradient(135deg, #FCA311 0%, #f59e0b 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(252, 163, 17, 0.3);
        }

        .nav-icon {
            font-size: 18px;
            width: 20px;
            text-align: center;
        }

        /* ‰∏ªÂÖßÂÆπÂçÄÂüü */
        .main-content {
            flex: 1;
            padding: 32px;
            overflow-y: auto;
        }

        .content {
            max-width: 1400px;
            margin: 0 auto;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        /* Âç°ÁâáÊ®£Âºè */
        .card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            border: 1px solid rgba(252, 163, 17, 0.2);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            margin-bottom: 24px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .card:hover {
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
        }

        .card-header {
            padding: 24px 32px;
            border-bottom: 1px solid rgba(252, 163, 17, 0.1);
            background: linear-gradient(135deg, rgba(252, 163, 17, 0.05) 0%, rgba(248, 247, 246, 0.8) 100%);
        }

        .card-title {
            font-size: 20px;
            font-weight: 700;
            color: #1f2937;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .card-body {
            padding: 32px;
        }

        /* Áµ±Ë®àÂç°ÁâáÁ∂≤Ê†º */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: linear-gradient(135deg, #fff 0%, #f8fafc 100%);
            border-radius: 16px;
            padding: 24px;
            border: 1px solid rgba(252, 163, 17, 0.1);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(252, 163, 17, 0.2);
        }

        .stat-icon {
            font-size: 32px;
            margin-bottom: 12px;
            display: block;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 14px;
            color: #6b7280;
            font-weight: 500;
        }

        .stat-change {
            font-size: 12px;
            margin-top: 8px;
            padding: 4px 8px;
            border-radius: 6px;
            font-weight: 500;
        }

        .stat-change.positive {
            background: #d1fae5;
            color: #065f46;
        }

        .stat-change.negative {
            background: #fee2e2;
            color: #991b1b;
        }

        /* ÊåâÈàïÊ®£Âºè */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            border-radius: 12px;
            font-weight: 500;
            text-decoration: none;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn.primary {
            background: linear-gradient(135deg, #FCA311 0%, #f59e0b 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(252, 163, 17, 0.3);
        }

        .btn.primary:hover:not(:disabled) {
            box-shadow: 0 6px 20px rgba(252, 163, 17, 0.4);
        }

        .btn.secondary {
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(252, 163, 17, 0.3);
            color: #FCA311;
        }

        .btn.secondary:hover {
            background: rgba(252, 163, 17, 0.1);
        }

        .btn.danger {
            background: #ef4444;
            color: white;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
        }

        .btn.danger:hover:not(:disabled) {
            background: #dc2626;
        }

        /* Ë°®Ê†ºÊ®£Âºè */
        .table-container {
            overflow-x: auto;
            border-radius: 12px;
            border: 1px solid rgba(252, 163, 17, 0.2);
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        .table th {
            background: linear-gradient(135deg, rgba(252, 163, 17, 0.1) 0%, rgba(248, 247, 246, 0.8) 100%);
            padding: 16px;
            text-align: left;
            font-weight: 600;
            color: #374151;
            border-bottom: 1px solid rgba(252, 163, 17, 0.2);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .table td {
            padding: 16px;
            border-bottom: 1px solid rgba(252, 163, 17, 0.1);
            vertical-align: middle;
        }

        .table tbody tr:hover {
            background: rgba(252, 163, 17, 0.05);
        }

        /* ÁãÄÊÖãÂæΩÁ´† */
        .badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge.status-pending {
            background: #fef3c7;
            color: #92400e;
            border: 1px solid #f59e0b;
        }

        .badge.status-approved {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #10b981;
        }

        .badge.status-active {
            background: #dbeafe;
            color: #1e40af;
            border: 1px solid #3b82f6;
        }

        .badge.status-rejected {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #ef4444;
        }

        .badge.status-expired {
            background: #f3f4f6;
            color: #374151;
            border: 1px solid #9ca3af;
        }

        .badge.status-inactive {
            background: #fecaca;
            color: #dc2626;
            border: 1px solid #f87171;
        }

        .badge.status-suspended {
            background: #fde68a;
            color: #d97706;
            border: 1px solid #f59e0b;
        }

        .badge.role-admin {
            background: #e0e7ff;
            color: #3730a3;
            border: 1px solid #6366f1;
        }

        .badge.role-vendor {
            background: #fef3c7;
            color: #92400e;
            border: 1px solid #f59e0b;
        }

        .badge.role-customer {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #10b981;
        }

        /* ÊêúÁ¥¢ÂíåÁØ©ÈÅ∏ */
        .search-filter-bar {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-box {
            flex: 1;
            min-width: 300px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 12px 16px 12px 48px;
            border: 1px solid rgba(252, 163, 17, 0.3);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #FCA311;
            box-shadow: 0 0 0 3px rgba(252, 163, 17, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: #9ca3af;
            font-size: 16px;
        }

        .filter-select {
            padding: 12px 16px;
            border: 1px solid rgba(252, 163, 17, 0.3);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            font-size: 14px;
            cursor: pointer;
        }

        .filter-select:focus {
            outline: none;
            border-color: #FCA311;
            box-shadow: 0 0 0 3px rgba(252, 163, 17, 0.1);
        }

        /* ËºâÂÖ•ÂãïÁï´ */
        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #f3f3f3;
            border-radius: 50%;
            border-top-color: #FCA311;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Á©∫ÁãÄÊÖã */
        .empty-state {
            text-align: center;
            padding: 64px 32px;
            color: #6b7280;
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 18px;
            margin-bottom: 8px;
            color: #374151;
        }

        /* ÂúñË°®ÂÆπÂô®Ê®£Âºè */
        .chart-container {
            position: relative;
            width: 100%;
            height: 300px;
            background: rgba(248, 250, 252, 0.5);
            border-radius: 12px;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chart-container canvas {
            max-width: 100%;
            max-height: 100%;
        }

        /* Ë°®ÂñÆÊ®£Âºè */
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-label {
            font-weight: 600;
            color: #374151;
            font-size: 14px;
        }

        .form-input,
        .form-select,
        .form-textarea {
            padding: 12px 16px;
            border: 1px solid rgba(252, 163, 17, 0.3);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: #FCA311;
            box-shadow: 0 0 0 3px rgba(252, 163, 17, 0.1);
        }

        .form-textarea {
            min-height: 80px;
            resize: vertical;
        }

        /* ÈüøÊáâÂºèË®≠Ë®à */
        @media (max-width: 1024px) {
            .sidebar {
                width: 260px;
            }

            .main-content {
                padding: 24px;
            }

            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 16px;
            }
        }

        @media (max-width: 768px) {
            .layout {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                padding: 16px 0;
            }

            .nav-menu {
                display: flex;
                overflow-x: auto;
                padding: 0 16px;
                gap: 8px;
            }

            .nav-item {
                margin-bottom: 0;
                flex-shrink: 0;
            }

            .main-content {
                padding: 16px;
            }

            .search-filter-bar {
                flex-direction: column;
                align-items: stretch;
            }

            .search-box {
                min-width: auto;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Êñ∞Â¢ûÂäüËÉΩÊ®°Â°äÊ®£Âºè */

        /* ÂçÄÊÆµÊ®ôÈ°åÊ®£Âºè */
        .section-header {
            margin-bottom: 32px;
            text-align: center;
        }

        .section-header h2 {
            font-size: 28px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 8px;
        }

        .section-header p {
            color: #6b7280;
            font-size: 16px;
        }

        /* Ëº™Êí≠ÂúñÁÆ°ÁêÜÊ®£Âºè */
        .banner-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 24px;
        }

        .banner-placeholder {
            border: 2px dashed rgba(252, 163, 17, 0.3);
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            background: rgba(252, 163, 17, 0.05);
        }

        .banner-placeholder-content span {
            font-size: 48px;
            display: block;
            margin-bottom: 16px;
        }

        .banner-placeholder-content p {
            color: #6b7280;
            margin-bottom: 16px;
        }

        /* FAQ ÁÆ°ÁêÜÊ®£Âºè */
        .faq-list {
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .faq-placeholder {
            text-align: center;
            color: #6b7280;
        }

        .faq-placeholder span {
            font-size: 48px;
            display: block;
            margin-bottom: 16px;
        }

        /* Âπ´Âä©ÊñáÊ™îÊ®£Âºè */
        .help-docs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
        }

        .help-doc-card {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 12px;
            padding: 24px;
            border: 1px solid rgba(252, 163, 17, 0.2);
            text-align: center;
            transition: all 0.3s ease;
        }

        .help-doc-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(252, 163, 17, 0.2);
        }

        .help-doc-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .help-doc-card h4 {
            margin-bottom: 8px;
            color: #1f2937;
        }

        .help-doc-card p {
            color: #6b7280;
            margin-bottom: 16px;
            font-size: 14px;
        }

        .help-doc-actions {
            display: flex;
            gap: 8px;
            justify-content: center;
        }

        /* ÂÆâÂÖ®ÁÆ°ÁêÜÊ®£Âºè */
        .security-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .security-stat-card {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(252, 163, 17, 0.2);
        }

        .security-stat-number {
            font-size: 24px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 4px;
        }

        .security-stat-label {
            font-size: 12px;
            color: #6b7280;
            font-weight: 500;
        }

        /* IP ÁôΩÂêçÂñÆÊ®£Âºè */
        .ip-whitelist-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .ip-rule {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 12px;
            border: 1px solid rgba(252, 163, 17, 0.2);
        }

        .ip-info {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .ip-address {
            font-weight: 600;
            color: #1f2937;
        }

        .ip-label {
            font-size: 12px;
            color: #6b7280;
        }

        .ip-actions {
            display: flex;
            gap: 8px;
        }

        /* ÂÖ©Ê≠•È©üÈ©óË≠âÊ®£Âºè */
        .two-factor-settings {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 12px;
            border: 1px solid rgba(252, 163, 17, 0.2);
        }

        .setting-info h4 {
            margin-bottom: 4px;
            color: #1f2937;
        }

        .setting-info p {
            font-size: 14px;
            color: #6b7280;
        }

        /* ÈñãÈóúÊ®£Âºè */
        .switch {
            position: relative;
            display: inline-block;
            width: 48px;
            height: 24px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked+.slider {
            background-color: #FCA311;
        }

        input:checked+.slider:before {
            transform: translateX(24px);
        }

        /* ÈÄöÁü•ÁÆ°ÁêÜÊ®£Âºè */
        .notification-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .notification-stat-card {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(252, 163, 17, 0.2);
        }

        .notification-stat-number {
            font-size: 24px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 4px;
        }

        .notification-stat-label {
            font-size: 12px;
            color: #6b7280;
            font-weight: 500;
        }

        .recent-notifications {
            margin-top: 24px;
        }

        .recent-notifications h4 {
            margin-bottom: 16px;
            color: #1f2937;
        }

        .notification-item {
            display: flex;
            align-items: center;
            padding: 12px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 8px;
            border: 1px solid rgba(252, 163, 17, 0.2);
            margin-bottom: 8px;
        }

        .notification-icon {
            font-size: 20px;
            margin-right: 12px;
        }

        .notification-content {
            flex: 1;
        }

        .notification-title {
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 2px;
        }

        .notification-time {
            font-size: 12px;
            color: #6b7280;
        }

        .notification-status {
            font-size: 12px;
            padding: 4px 8px;
            background: #d1fae5;
            color: #065f46;
            border-radius: 6px;
        }

        /* ÈÉµ‰ª∂Ê®°ÊùøÊ®£Âºè */
        .email-templates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
        }

        .email-template-card {
            display: flex;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(252, 163, 17, 0.2);
            transition: all 0.3s ease;
        }

        .email-template-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(252, 163, 17, 0.2);
        }

        .email-template-preview {
            margin-right: 16px;
            display: flex;
            align-items: center;
        }

        .email-template-icon {
            font-size: 32px;
        }

        .email-template-info {
            flex: 1;
        }

        .email-template-info h4 {
            margin-bottom: 4px;
            color: #1f2937;
        }

        .email-template-info p {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 12px;
        }

        .email-template-actions {
            display: flex;
            gap: 8px;
        }

        /* ÈÄöÁü•Ë®≠ÂÆöÊ®£Âºè */
        .notification-settings {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .setting-group {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(252, 163, 17, 0.2);
        }

        .setting-group h4 {
            margin-bottom: 16px;
            color: #1f2937;
            font-size: 16px;
        }

        .setting-group .setting-item {
            margin-bottom: 12px;
        }

        .setting-group .setting-item:last-child {
            margin-bottom: 0;
        }

        .setting-info span {
            font-weight: 500;
            color: #1f2937;
        }

        .setting-info small {
            display: block;
            color: #6b7280;
            font-size: 12px;
            margin-top: 2px;
        }

        /* Â§ñËßÄË®≠ÂÆöÊ®£Âºè */
        .theme-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .theme-option {
            cursor: pointer;
            border-radius: 12px;
            padding: 16px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            text-align: center;
        }

        .theme-option:hover {
            border-color: rgba(252, 163, 17, 0.3);
        }

        .theme-option.active {
            border-color: #FCA311;
            background: rgba(252, 163, 17, 0.05);
        }

        .theme-preview {
            width: 100%;
            height: 120px;
            border-radius: 8px;
            margin-bottom: 12px;
            overflow: hidden;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .light-theme {
            background: #ffffff;
        }

        .dark-theme {
            background: #1f2937;
        }

        .auto-theme {
            background: linear-gradient(45deg, #ffffff 50%, #1f2937 50%);
        }

        .theme-header {
            height: 20px;
            background: #FCA311;
        }

        .theme-content {
            display: flex;
            height: 100px;
        }

        .theme-sidebar {
            width: 30%;
            background: rgba(0, 0, 0, 0.05);
        }

        .theme-main {
            flex: 1;
            background: rgba(0, 0, 0, 0.02);
        }

        .theme-name {
            font-weight: 500;
            color: #1f2937;
        }

        /* Logo ÁÆ°ÁêÜÊ®£Âºè */
        .logo-management {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
            align-items: start;
        }

        .logo-upload-section {
            text-align: center;
        }

        .logo-preview {
            width: 120px;
            height: 120px;
            border-radius: 12px;
            border: 2px dashed rgba(252, 163, 17, 0.3);
            margin: 0 auto 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(252, 163, 17, 0.05);
        }

        .logo-preview img {
            max-width: 100%;
            max-height: 100%;
            border-radius: 8px;
        }

        .logo-controls {
            display: flex;
            gap: 8px;
            justify-content: center;
        }

        .logo-settings {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .logo-settings .setting-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .logo-settings label {
            font-weight: 500;
            color: #1f2937;
        }

        .logo-settings select {
            padding: 8px 12px;
            border: 1px solid rgba(252, 163, 17, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.8);
        }

        /* Ëâ≤ÂΩ©ÊñπÊ°àÊ®£Âºè */
        .color-scheme-settings {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .color-setting {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .color-setting label {
            font-weight: 500;
            color: #1f2937;
        }

        .color-input-group {
            display: flex;
            gap: 8px;
        }

        .color-input-group input[type="color"] {
            width: 50px;
            height: 40px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        .color-input-group input[type="text"] {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid rgba(252, 163, 17, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.8);
            font-family: monospace;
        }

        .color-preview {
            margin: 24px 0;
        }

        .color-preview h4 {
            margin-bottom: 16px;
            color: #1f2937;
        }

        .color-preview-card {
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .preview-header {
            padding: 16px;
            font-weight: 600;
        }

        .preview-content {
            padding: 16px;
        }

        .preview-content button {
            margin-top: 8px;
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }

        .color-actions {
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        /* Âç°ÁâáÂãï‰ΩúÂçÄÂüü */
        .card-actions {
            display: flex;
            gap: 8px;
        }

        /* ÂÑ™ÊÉ†Âà∏Ë°®Ê†ºÂ∞àÁî®Ê®£Âºè */
        .coupon-table {
            table-layout: fixed;
            min-width: 1080px;
        }

        .coupon-table td {
            vertical-align: top;
            padding: 18px 16px;
            word-wrap: break-word;
        }

        .coupon-table th {
            padding: 18px 16px;
            font-size: 14px;
            font-weight: 600;
        }

        /* Âª†ÂïÜË°®Ê†ºÂ∞àÁî®Ê®£Âºè */
        .vendor-table {
            table-layout: fixed;
            min-width: 1080px;
        }

        .vendor-table td {
            vertical-align: top;
            padding: 12px 8px;
            word-wrap: break-word;
            font-size: 13px;
        }

        .vendor-table th {
            padding: 12px 8px;
            font-size: 13px;
            font-weight: 600;
        }

        /* ÈÄöÁî®Ë°®Ê†ºÊ®£ÂºèÊîπÈÄ≤ */
        .table-container table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            table-layout: fixed;
            min-width: 1140px;
        }

        .table-container th {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            padding: 16px 14px;
            text-align: left;
            font-weight: 700;
            font-size: 14px;
            color: #1f2937;
            border-bottom: 2px solid #e5e7eb;
            white-space: nowrap;
        }

        .table-container td {
            padding: 16px 14px;
            border-bottom: 1px solid #f3f4f6;
            font-size: 14px;
            vertical-align: top;
            line-height: 1.6;
        }

        .table-container tr:hover {
            background: #f9fafb;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            transition: all 0.2s ease;
        }

        .table-container tr:last-child td {
            border-bottom: none;
        }

        /* ÈüøÊáâÂºèË®≠Ë®à */
        @media (max-width: 768px) {
            .main-content {
                padding: 16px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .logo-management {
                grid-template-columns: 1fr;
                gap: 24px;
            }

            .color-scheme-settings {
                grid-template-columns: 1fr;
            }

            .theme-options {
                grid-template-columns: 1fr;
            }

            .coupon-table,
            .vendor-table {
                min-width: auto;
                table-layout: auto;
            }

            .coupon-table td,
            .coupon-table th,
            .vendor-table td,
            .vendor-table th {
                padding: 12px 8px;
                font-size: 12px;
            }

            /* ÂÖßÂÆπÁÆ°ÁêÜÊ®£Âºè */
            .banner-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
                gap: 20px;
                margin-top: 16px;
            }

            .banner-item {
                border: 1px solid #e5e7eb;
                border-radius: 8px;
                overflow: hidden;
                position: relative;
            }

            .banner-item img {
                width: 100%;
                height: 200px;
                object-fit: cover;
            }

            .banner-item-info {
                padding: 12px;
                background: white;
            }

            .banner-item-actions {
                display: flex;
                gap: 8px;
                margin-top: 8px;
            }

            .banner-placeholder {
                border: 2px dashed #d1d5db;
                border-radius: 8px;
                padding: 40px;
                text-align: center;
                color: #6b7280;
            }

            .banner-placeholder-content span {
                font-size: 48px;
                display: block;
                margin-bottom: 16px;
            }

            .faq-list {
                display: flex;
                flex-direction: column;
                gap: 16px;
            }

            .faq-item {
                border: 1px solid #e5e7eb;
                border-radius: 8px;
                overflow: hidden;
            }

            .faq-question {
                padding: 16px;
                background: #f9fafb;
                font-weight: 500;
                cursor: pointer;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .faq-question:hover {
                background: #f3f4f6;
            }

            .faq-answer {
                padding: 16px;
                border-top: 1px solid #e5e7eb;
                background: white;
            }

            .faq-placeholder {
                text-align: center;
                padding: 40px;
                color: #6b7280;
            }

            .faq-placeholder span {
                font-size: 48px;
                display: block;
                margin-bottom: 16px;
            }

            .modal {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                z-index: 1000;
            }

            .modal.active {
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .modal-content {
                background: white;
                border-radius: 12px;
                padding: 24px;
                width: 90%;
                max-width: 600px;
                max-height: 80vh;
                overflow-y: auto;
            }

            .modal-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 20px;
                padding-bottom: 16px;
                border-bottom: 1px solid #e5e7eb;
            }

            .modal-title {
                font-size: 18px;
                font-weight: 600;
                color: #111827;
            }

            .modal-close {
                background: none;
                border: none;
                font-size: 24px;
                cursor: pointer;
                color: #6b7280;
                padding: 0;
                width: 32px;
                height: 32px;
                display: flex;
                align-items: center;
                justify-content: center;
                border-radius: 50%;
            }

            .modal-close:hover {
                background: #f3f4f6;
            }

            .form-group {
                margin-bottom: 16px;
            }

            .form-label {
                display: block;
                margin-bottom: 6px;
                font-weight: 500;
                color: #374151;
            }

            .form-input,
            .form-select,
            .form-textarea {
                width: 100%;
                padding: 8px 12px;
                border: 1px solid #d1d5db;
                border-radius: 6px;
                font-size: 14px;
                transition: border-color 0.2s;
            }

            .form-input:focus,
            .form-select:focus,
            .form-textarea:focus {
                outline: none;
                border-color: #FCA311;
                box-shadow: 0 0 0 3px rgba(252, 163, 17, 0.1);
            }

            .form-textarea {
                min-height: 100px;
                resize: vertical;
            }

            .modal-footer {
                display: flex;
                justify-content: flex-end;
                gap: 12px;
                margin-top: 24px;
                padding-top: 16px;
                border-top: 1px solid #e5e7eb;
            }

            /* ÂÆâÂÖ®ÁÆ°ÁêÜÊ®£Âºè */
            .risk-high {
                background-color: rgba(251, 191, 36, 0.1);
            }

            .risk-critical {
                background-color: rgba(239, 68, 68, 0.1);
            }

            .security-stat-card {
                text-align: center;
                padding: 20px;
                background: white;
                border-radius: 8px;
                border: 1px solid #e5e7eb;
            }

            .security-stat-number {
                font-size: 32px;
                font-weight: 700;
                color: #111827;
                margin-bottom: 8px;
            }

            .security-stat-label {
                font-size: 14px;
                color: #6b7280;
            }

            .ip-whitelist-item:hover {
                background-color: #f9fafb;
            }
    </style>
    <!-- Chart.js for analytics -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon"
        href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIiByeD0iMTAiIGZpbGw9IiNGQ0EzMTEiLz4KPHRleHQgeD0iNTAiIHk9IjU1IiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMzAiIGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+U0g8L3RleHQ+Cjwvc3ZnPg==">
</head>

<body>
    <!-- È†≠ÈÉ®Â∞éËà™ -->
    <div class="header">
        <div class="logo">
            <span>üéØ</span>
            <span>ÈÄÅÈΩÅÂ∫∑ÁÆ°ÁêÜÂæåÂè∞</span>
        </div>
        <div class="header-actions">
            <div class="switch-info" id="switchInfo">
                <span>üë§ Áï∂ÂâçÊü•ÁúãÔºö<strong id="currentUser">-</strong></span>
                <span>üë®‚Äçüíº ÁÆ°ÁêÜÂì°Ôºö<strong id="adminUser">-</strong></span>
            </div>
            <button class="btn secondary" id="switchBackBtn" style="display: none;" onclick="switchBackToAdmin()">
                ‚Ü©Ô∏è ÂàáÊèõÂõûÁÆ°ÁêÜÂì°
            </button>
            <button class="btn danger" onclick="logout()">
                üö™ ÁôªÂá∫
            </button>
        </div>
    </div>

    <!-- ‰∏ªË¶ÅÂ∏ÉÂ±Ä -->
    <div class="layout">
        <!-- ÂÅ¥ÈÇäÊ¨Ñ -->
        <div class="sidebar">
            <ul class="nav-menu">
                <li class="nav-item">
                    <a class="nav-link active" data-section="dashboard">
                        <span class="nav-icon">üìä</span>
                        <span>ÂÑÄË°®Êùø</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-section="users">
                        <span class="nav-icon">üë•</span>
                        <span>Áî®Êà∂ÁÆ°ÁêÜ</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-section="coupons">
                        <span class="nav-icon">üé´</span>
                        <span>ÂÑ™ÊÉ†Âà∏ÁÆ°ÁêÜ</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-section="vendors">
                        <span class="nav-icon">üè™</span>
                        <span>Âª†ÂïÜÁÆ°ÁêÜ</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-section="analytics">
                        <span class="nav-icon">üìà</span>
                        <span>Êï∏ÊìöÂàÜÊûê</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-section="content">
                        <span class="nav-icon">üìù</span>
                        <span>ÂÖßÂÆπÁÆ°ÁêÜ</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-section="security">
                        <span class="nav-icon">üõ°Ô∏è</span>
                        <span>ÂÆâÂÖ®ÁÆ°ÁêÜ</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-section="notifications">
                        <span class="nav-icon">üîî</span>
                        <span>ÈÄöÁü•ÁÆ°ÁêÜ</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-section="appearance">
                        <span class="nav-icon">üé®</span>
                        <span>Â§ñËßÄË®≠ÂÆö</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-section="system">
                        <span class="nav-icon">‚öôÔ∏è</span>
                        <span>Á≥ªÁµ±Ë®≠ÂÆö</span>
                    </a>
                </li>

            </ul>
        </div>

        <!-- ‰∏ªÂÖßÂÆπÂçÄÂüü -->
        <div class="main-content">
            <div class="content">
                <!-- ÂÑÄË°®Êùø -->
                <div class="section active" id="dashboard-section">
                    <!-- KPI Áµ±Ë®à -->
                    <div class="stats-grid" id="statsGrid">
                        <!-- Áµ±Ë®àÂç°ÁâáÂ∞áÈÄöÈÅé JavaScript ÂãïÊÖãÁîüÊàê -->
                    </div>

                    <!-- ÊúÄÊñ∞Ê¥ªÂãï -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <span>üî•</span>
                                <span>ÊúÄÊñ∞Ê¥ªÂãï</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <div id="recentActivities">
                                <div class="loading" style="margin: 20px auto;"></div>
                            </div>
                        </div>
                    </div>
                </div>



                <!-- Áî®Êà∂ÁÆ°ÁêÜ -->
                <div class="section" id="users-section">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <span>üë•</span>
                                <span>Áî®Êà∂ÁÆ°ÁêÜ</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <!-- ÊêúÁ¥¢ÂíåÁØ©ÈÅ∏ -->
                            <div class="search-filter-bar">
                                <div class="search-box">
                                    <span class="search-icon">üîç</span>
                                    <input type="text" class="search-input" id="userSearch" placeholder="ÊêúÁ¥¢Áî®Êà∂ÂêçÁ®±„ÄÅÈÉµÁÆ±...">
                                </div>
                                <select class="filter-select" id="roleFilter">
                                    <option value="">ÊâÄÊúâËßíËâ≤</option>
                                    <option value="customer">‰∏ÄËà¨ÊúÉÂì°</option>
                                    <option value="vendor">Âª†ÂïÜ</option>
                                    <option value="admin">ÁÆ°ÁêÜÂì°</option>
                                </select>
                                <select class="filter-select" id="statusFilter">
                                    <option value="">ÊâÄÊúâÁãÄÊÖã</option>
                                    <option value="active">Â∑≤ÂïüÁî®</option>
                                    <option value="pending">ÂæÖÂØ©Ê†∏</option>
                                    <option value="inactive">Â∑≤ÂÅúÁî®</option>
                                </select>
                            </div>

                            <!-- Áî®Êà∂Ë°®Ê†º -->
                            <div class="table-container">
                                <table>
                                    <thead>
                                        <tr>
                                            <th style="width:260px">Áî®Êà∂Ë≥áË®ä</th>
                                            <th style="width:100px">ËßíËâ≤</th>
                                            <th style="width:100px">ÁãÄÊÖã</th>
                                            <th style="width:120px">Ë®ªÂÜäÊôÇÈñì</th>
                                            <th style="width:140px">ÊúÄÂæåÁôªÂÖ•</th>
                                            <th style="width:320px">Êìç‰Ωú</th>
                                        </tr>
                                    </thead>
                                    <tbody id="usersTable">
                                        <tr>
                                            <td colspan="6" style="text-align: center; padding: 40px;">
                                                <div class="loading"></div>
                                                <div style="margin-top: 12px;">ËºâÂÖ•‰∏≠...</div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ÂÑ™ÊÉ†Âà∏ÁÆ°ÁêÜ -->
                <div class="section" id="coupons-section">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <span>üé´</span>
                                <span>ÂÑ™ÊÉ†Âà∏ÁÆ°ÁêÜ</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <!-- ÊêúÁ¥¢ÂíåÁØ©ÈÅ∏ -->
                            <div class="search-filter-bar">
                                <div class="search-box">
                                    <span class="search-icon">üîç</span>
                                    <input type="text" class="search-input" id="couponSearch"
                                        placeholder="ÊêúÁ¥¢ÂÑ™ÊÉ†Âà∏Ê®ôÈ°å„ÄÅÂª†ÂïÜ...">
                                </div>
                                <select class="filter-select" id="categoryFilter">
                                    <option value="">ÊâÄÊúâÂàÜÈ°û</option>
                                    <option value="ÁæéÈ£üÈ§êÈ£≤">ÁæéÈ£üÈ§êÈ£≤</option>
                                    <option value="Ë≥ºÁâ©ÂïÜÂüé">Ë≥ºÁâ©ÂïÜÂüé</option>
                                    <option value="ÁæéÂÆπ‰øùÈ§ä">ÁæéÂÆπ‰øùÈ§ä</option>
                                    <option value="‰ºëÈñíÂ®õÊ®Ç">‰ºëÈñíÂ®õÊ®Ç</option>
                                    <option value="ÊóÖÈÅä‰ΩèÂÆø">ÊóÖÈÅä‰ΩèÂÆø</option>
                                    <option value="ÂÅ•Â∫∑ÈÜ´ÁôÇ">ÂÅ•Â∫∑ÈÜ´ÁôÇ</option>
                                    <option value="3CÈõªÂ≠ê">3CÈõªÂ≠ê</option>
                                    <option value="ÁîüÊ¥ªÊúçÂãô">ÁîüÊ¥ªÊúçÂãô</option>
                                    <option value="ÂÖ∂‰ªñ">ÂÖ∂‰ªñ</option>
                                </select>
                                <select class="filter-select" id="couponStatusFilter">
                                    <option value="">ÊâÄÊúâÁãÄÊÖã</option>
                                    <option value="pending">ÂæÖÂØ©Ê†∏</option>
                                    <option value="approved">Â∑≤Ê†∏ÂáÜ</option>
                                    <option value="active">‰∏äÁ∑ö‰∏≠</option>
                                    <option value="expired">Â∑≤ÈÅéÊúü</option>
                                    <option value="rejected">Â∑≤ÈßÅÂõû</option>
                                </select>
                            </div>

                            <!-- ÂÑ™ÊÉ†Âà∏Ë°®Ê†º -->
                            <div class="table-container">
                                <table>
                                    <thead>
                                        <tr>
                                            <th style="width:60px">ID</th>
                                            <th style="width:280px">Ê®ôÈ°å</th>
                                            <th style="width:130px">Âª†ÂïÜ</th>
                                            <th style="width:90px">ÂàÜÈ°û</th>
                                            <th style="width:90px">ÁãÄÊÖã</th>
                                            <th style="width:110px">Êï∏Êìö</th>
                                            <th style="width:110px">Âà∞ÊúüÊó•</th>
                                            <th style="width:200px">Êìç‰Ωú</th>
                                        </tr>
                                    </thead>
                                    <tbody id="couponsTable">
                                        <tr>
                                            <td colspan="8" style="text-align: center; padding: 40px;">
                                                <div class="loading"></div>
                                                <div style="margin-top: 12px;">ËºâÂÖ•‰∏≠...</div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Âª†ÂïÜÁÆ°ÁêÜ -->
                <div class="section" id="vendors-section">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <span>üè™</span>
                                <span>Âª†ÂïÜÁÆ°ÁêÜ</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <!-- ÊêúÁ¥¢ÂíåÁØ©ÈÅ∏ -->
                            <div class="search-filter-bar">
                                <div class="search-box">
                                    <span class="search-icon">üîç</span>
                                    <input type="text" class="search-input" id="vendorSearch"
                                        placeholder="ÊêúÁ¥¢Âª†ÂïÜÂêçÁ®±„ÄÅËÅØÁµ°‰∫∫...">
                                </div>
                                <select class="filter-select" id="vendorStatusFilter">
                                    <option value="">ÊâÄÊúâÁãÄÊÖã</option>
                                    <option value="pending">ÂæÖÂØ©Ê†∏</option>
                                    <option value="approved">Â∑≤Ê†∏ÂáÜ</option>
                                    <option value="rejected">Â∑≤ÈßÅÂõû</option>
                                </select>
                                <select class="filter-select" id="vendorCategoryFilter">
                                    <option value="">ÊâÄÊúâÂàÜÈ°û</option>
                                    <option value="ÁæéÈ£üÈ§êÈ£≤">ÁæéÈ£üÈ§êÈ£≤</option>
                                    <option value="Ë≥ºÁâ©ÂïÜÂüé">Ë≥ºÁâ©ÂïÜÂüé</option>
                                    <option value="ÁæéÂÆπ‰øùÈ§ä">ÁæéÂÆπ‰øùÈ§ä</option>
                                    <option value="‰ºëÈñíÂ®õÊ®Ç">‰ºëÈñíÂ®õÊ®Ç</option>
                                    <option value="ÊóÖÈÅä‰ΩèÂÆø">ÊóÖÈÅä‰ΩèÂÆø</option>
                                    <option value="ÂÅ•Â∫∑ÈÜ´ÁôÇ">ÂÅ•Â∫∑ÈÜ´ÁôÇ</option>
                                    <option value="ÂÖ∂‰ªñ">ÂÖ∂‰ªñ</option>
                                </select>
                            </div>

                            <!-- Âª†ÂïÜË°®Ê†º -->
                            <div class="table-container">
                                <table>
                                    <thead>
                                        <tr>
                                            <th style="width:60px">ID</th>
                                            <th style="width:230px">ÂÖ¨Âè∏ÂêçÁ®±</th>
                                            <th style="width:110px">ËÅØÁµ°‰∫∫</th>
                                            <th style="width:180px">ËÅØÁµ°Ë≥áË®ä</th>
                                            <th style="width:90px">ÁãÄÊÖã</th>
                                            <th style="width:80px">ÂÑ™ÊÉ†Âà∏</th>
                                            <th style="width:110px">Áî≥Ë´ãÊôÇÈñì</th>
                                            <th style="width:200px">Êìç‰Ωú</th>
                                        </tr>
                                    </thead>
                                    <tbody id="vendorsTable">
                                        <tr>
                                            <td style="font-weight: 600; font-size: 15px; color: #1f2937;">1</td>
                                            <td>
                                                <div
                                                    style="font-weight: 600; margin-bottom: 4px; font-size: 15px; color: #1f2937;">
                                                    ÁæéÂë≥È§êÂª≥ËÇ°‰ªΩÊúâÈôêÂÖ¨Âè∏</div>
                                                <div style="font-size: 13px; color: #6b7280;">Áµ±Á∑®: 12345678</div>
                                            </td>
                                            <td style="font-size: 14px; font-weight: 500; color: #374151;">ÂºµÁ∂ìÁêÜ</td>
                                            <td style="font-size: 13px; color: #6b7280; line-height: 1.6;">
                                                <div style="margin-bottom: 3px;">üìß manager@delicious.com.tw</div>
                                                <div>üì± 02-1234-5678</div>
                                            </td>
                                            <td>
                                                <span
                                                    style="padding: 6px 12px; border-radius: 16px; font-size: 12px; font-weight: 600; background: #d1fae5; color: #059669; display: inline-block;">Â∑≤Ê†∏ÂáÜ</span>
                                            </td>
                                            <td
                                                style="text-align: center; font-weight: 700; color: #f97316; font-size: 16px;">
                                                8</td>
                                            <td style="font-size: 13px; color: #6b7280; font-weight: 500;">2024/1/10
                                            </td>
                                            <td>
                                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #f8fafc; color: #374151; border: 1px solid #e5e7eb; border-radius: 6px; font-weight: 500;">üëÅÔ∏è</button>
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #f59e0b; color: white; border-radius: 6px; font-weight: 500;">‚úèÔ∏è</button>
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #10b981; color: white; border-radius: 6px; font-weight: 500;">üîÑ</button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="font-weight: 600; font-size: 15px; color: #1f2937;">2</td>
                                            <td>
                                                <div
                                                    style="font-weight: 600; margin-bottom: 4px; font-size: 15px; color: #1f2937;">
                                                    ÊôÇÂ∞öÊúçÈ£æÊúâÈôêÂÖ¨Âè∏</div>
                                                <div style="font-size: 13px; color: #6b7280;">Áµ±Á∑®: 87654321</div>
                                            </td>
                                            <td style="font-size: 14px; font-weight: 500; color: #374151;">ÊùéÂ∞èÂßê</td>
                                            <td style="font-size: 13px; color: #6b7280; line-height: 1.6;">
                                                <div style="margin-bottom: 3px;">üìß service@fashion.com.tw</div>
                                                <div>üì± 02-9876-5432</div>
                                            </td>
                                            <td>
                                                <span
                                                    style="padding: 6px 12px; border-radius: 16px; font-size: 12px; font-weight: 600; background: #fef3c7; color: #d97706; display: inline-block;">ÂæÖÂØ©Ê†∏</span>
                                            </td>
                                            <td
                                                style="text-align: center; font-weight: 700; color: #6b7280; font-size: 16px;">
                                                0</td>
                                            <td style="font-size: 13px; color: #6b7280; font-weight: 500;">2024/1/12
                                            </td>
                                            <td>
                                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #f8fafc; color: #374151; border: 1px solid #e5e7eb; border-radius: 6px; font-weight: 500;">üëÅÔ∏è</button>
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #f59e0b; color: white; border-radius: 6px; font-weight: 500;">‚úèÔ∏è</button>
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #10b981; color: white; border-radius: 6px; font-weight: 500;">üîÑ</button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="font-weight: 600; font-size: 15px; color: #1f2937;">3</td>
                                            <td>
                                                <div
                                                    style="font-weight: 600; margin-bottom: 4px; font-size: 15px; color: #1f2937;">
                                                    ÂÅ•Â∫∑ÁîüÊ¥ªÈ§®</div>
                                                <div style="font-size: 13px; color: #6b7280;">Áµ±Á∑®: 11223344</div>
                                            </td>
                                            <td style="font-size: 14px; font-weight: 500; color: #374151;">ÁéãÂÖàÁîü</td>
                                            <td style="font-size: 13px; color: #6b7280; line-height: 1.6;">
                                                <div style="margin-bottom: 3px;">üìß info@health.com.tw</div>
                                                <div>üì± 02-5555-6666</div>
                                            </td>
                                            <td>
                                                <span
                                                    style="padding: 6px 12px; border-radius: 16px; font-size: 12px; font-weight: 600; background: #d1fae5; color: #059669; display: inline-block;">Â∑≤Ê†∏ÂáÜ</span>
                                            </td>
                                            <td
                                                style="text-align: center; font-weight: 700; color: #f97316; font-size: 16px;">
                                                12</td>
                                            <td style="font-size: 13px; color: #6b7280; font-weight: 500;">2024/1/8</td>
                                            <td>
                                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #f8fafc; color: #374151; border: 1px solid #e5e7eb; border-radius: 6px; font-weight: 500;">üëÅÔ∏è</button>
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #f59e0b; color: white; border-radius: 6px; font-weight: 500;">‚úèÔ∏è</button>
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #10b981; color: white; border-radius: 6px; font-weight: 500;">üîÑ</button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="font-weight: 600; font-size: 15px; color: #1f2937;">4</td>
                                            <td>
                                                <div
                                                    style="font-weight: 600; margin-bottom: 4px; font-size: 15px; color: #1f2937;">
                                                    Âø´Ê®ÇÊóÖÈÅäÁ§æ</div>
                                                <div style="font-size: 13px; color: #6b7280;">Áµ±Á∑®: 99887766</div>
                                            </td>
                                            <td style="font-size: 14px; font-weight: 500; color: #374151;">Èô≥Â∞èÂßê</td>
                                            <td style="font-size: 13px; color: #6b7280; line-height: 1.6;">
                                                <div style="margin-bottom: 3px;">üìß travel@happy.com.tw</div>
                                                <div>üì± 07-8888-9999</div>
                                            </td>
                                            <td>
                                                <span
                                                    style="padding: 6px 12px; border-radius: 16px; font-size: 12px; font-weight: 600; background: #fecaca; color: #dc2626; display: inline-block;">Â∑≤ÈßÅÂõû</span>
                                            </td>
                                            <td
                                                style="text-align: center; font-weight: 700; color: #6b7280; font-size: 16px;">
                                                3</td>
                                            <td style="font-size: 13px; color: #6b7280; font-weight: 500;">2024/1/5</td>
                                            <td>
                                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #f8fafc; color: #374151; border: 1px solid #e5e7eb; border-radius: 6px; font-weight: 500;">üëÅÔ∏è</button>
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #f59e0b; color: white; border-radius: 6px; font-weight: 500;">‚úèÔ∏è</button>
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #10b981; color: white; border-radius: 6px; font-weight: 500;">üîÑ</button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="font-weight: 600; font-size: 15px; color: #1f2937;">5</td>
                                            <td>
                                                <div
                                                    style="font-weight: 600; margin-bottom: 4px; font-size: 15px; color: #1f2937;">
                                                    ÁßëÊäÄÊï∏‰ΩçÊúâÈôêÂÖ¨Âè∏</div>
                                                <div style="font-size: 13px; color: #6b7280;">Áµ±Á∑®: 55443322</div>
                                            </td>
                                            <td style="font-size: 14px; font-weight: 500; color: #374151;">ÊûóÁ∂ìÁêÜ</td>
                                            <td style="font-size: 13px; color: #6b7280; line-height: 1.6;">
                                                <div style="margin-bottom: 3px;">üìß tech@digital.com.tw</div>
                                                <div>üì± 03-1111-2222</div>
                                            </td>
                                            <td>
                                                <span
                                                    style="padding: 6px 12px; border-radius: 16px; font-size: 12px; font-weight: 600; background: #fef3c7; color: #d97706; display: inline-block;">ÂæÖÂØ©Ê†∏</span>
                                            </td>
                                            <td
                                                style="text-align: center; font-weight: 700; color: #f97316; font-size: 16px;">
                                                5</td>
                                            <td style="font-size: 13px; color: #6b7280; font-weight: 500;">2024/1/14
                                            </td>
                                            <td>
                                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #f8fafc; color: #374151; border: 1px solid #e5e7eb; border-radius: 6px; font-weight: 500;">üëÅÔ∏è</button>
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #f59e0b; color: white; border-radius: 6px; font-weight: 500;">‚úèÔ∏è</button>
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #10b981; color: white; border-radius: 6px; font-weight: 500;">üîÑ</button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="font-weight: 600; font-size: 15px; color: #1f2937;">6</td>
                                            <td>
                                                <div
                                                    style="font-weight: 600; margin-bottom: 4px; font-size: 15px; color: #1f2937;">
                                                    ÂíñÂï°È¶ôÊøÉÂùä</div>
                                                <div style="font-size: 13px; color: #6b7280;">Áµ±Á∑®: 33445566</div>
                                            </td>
                                            <td style="font-size: 14px; font-weight: 500; color: #374151;">ÂäâËÄÅÈóÜ</td>
                                            <td style="font-size: 13px; color: #6b7280; line-height: 1.6;">
                                                <div style="margin-bottom: 3px;">üìß coffee@aroma.com.tw</div>
                                                <div>üì± 04-2222-3333</div>
                                            </td>
                                            <td>
                                                <span
                                                    style="padding: 6px 12px; border-radius: 16px; font-size: 12px; font-weight: 600; background: #d1fae5; color: #059669; display: inline-block;">Â∑≤Ê†∏ÂáÜ</span>
                                            </td>
                                            <td
                                                style="text-align: center; font-weight: 700; color: #f97316; font-size: 16px;">
                                                7</td>
                                            <td style="font-size: 13px; color: #6b7280; font-weight: 500;">2024/1/15
                                            </td>
                                            <td>
                                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #f8fafc; color: #374151; border: 1px solid #e5e7eb; border-radius: 6px; font-weight: 500;">üëÅÔ∏è</button>
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #f59e0b; color: white; border-radius: 6px; font-weight: 500;">‚úèÔ∏è</button>
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #10b981; color: white; border-radius: 6px; font-weight: 500;">üîÑ</button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="font-weight: 600; font-size: 15px; color: #1f2937;">7</td>
                                            <td>
                                                <div
                                                    style="font-weight: 600; margin-bottom: 4px; font-size: 15px; color: #1f2937;">
                                                    ÊòüÂÖâÂÅ•Ë∫´‰∏≠ÂøÉ</div>
                                                <div style="font-size: 13px; color: #6b7280;">Áµ±Á∑®: 77889900</div>
                                            </td>
                                            <td style="font-size: 14px; font-weight: 500; color: #374151;">Âë®ÊïôÁ∑¥</td>
                                            <td style="font-size: 13px; color: #6b7280; line-height: 1.6;">
                                                <div style="margin-bottom: 3px;">üìß fitness@star.com.tw</div>
                                                <div>üì± 02-7777-8888</div>
                                            </td>
                                            <td>
                                                <span
                                                    style="padding: 6px 12px; border-radius: 16px; font-size: 12px; font-weight: 600; background: #fef3c7; color: #d97706; display: inline-block;">ÂæÖÂØ©Ê†∏</span>
                                            </td>
                                            <td
                                                style="text-align: center; font-weight: 700; color: #f97316; font-size: 16px;">
                                                2</td>
                                            <td style="font-size: 13px; color: #6b7280; font-weight: 500;">2024/1/16
                                            </td>
                                            <td>
                                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #f8fafc; color: #374151; border: 1px solid #e5e7eb; border-radius: 6px; font-weight: 500;">üëÅÔ∏è</button>
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #f59e0b; color: white; border-radius: 6px; font-weight: 500;">‚úèÔ∏è</button>
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #10b981; color: white; border-radius: 6px; font-weight: 500;">üîÑ</button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="font-weight: 600; font-size: 15px; color: #1f2937;">8</td>
                                            <td>
                                                <div
                                                    style="font-weight: 600; margin-bottom: 4px; font-size: 15px; color: #1f2937;">
                                                    Á≤æÂìÅËä±ËóùÂ∑•‰ΩúÂÆ§</div>
                                                <div style="font-size: 13px; color: #6b7280;">Áµ±Á∑®: 11998877</div>
                                            </td>
                                            <td style="font-size: 14px; font-weight: 500; color: #374151;">Ëä±Ëä±Â∞èÂßê</td>
                                            <td style="font-size: 13px; color: #6b7280; line-height: 1.6;">
                                                <div style="margin-bottom: 3px;">üìß flowers@boutique.tw</div>
                                                <div>üì± 05-3333-4444</div>
                                            </td>
                                            <td>
                                                <span
                                                    style="padding: 6px 12px; border-radius: 16px; font-size: 12px; font-weight: 600; background: #d1fae5; color: #059669; display: inline-block;">Â∑≤Ê†∏ÂáÜ</span>
                                            </td>
                                            <td
                                                style="text-align: center; font-weight: 700; color: #f97316; font-size: 16px;">
                                                9</td>
                                            <td style="font-size: 13px; color: #6b7280; font-weight: 500;">2024/1/17
                                            </td>
                                            <td>
                                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #f8fafc; color: #374151; border: 1px solid #e5e7eb; border-radius: 6px; font-weight: 500;">üëÅÔ∏è</button>
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #f59e0b; color: white; border-radius: 6px; font-weight: 500;">‚úèÔ∏è</button>
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #10b981; color: white; border-radius: 6px; font-weight: 500;">üîÑ</button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="font-weight: 600; font-size: 15px; color: #1f2937;">9</td>
                                            <td>
                                                <div
                                                    style="font-weight: 600; margin-bottom: 4px; font-size: 15px; color: #1f2937;">
                                                    Â§¢ÊÉ≥Êõ∏Â∫ó</div>
                                                <div style="font-size: 13px; color: #6b7280;">Áµ±Á∑®: 44556677</div>
                                            </td>
                                            <td style="font-size: 14px; font-weight: 500; color: #374151;">Êõ∏È¶ôÂßê</td>
                                            <td style="font-size: 13px; color: #6b7280; line-height: 1.6;">
                                                <div style="margin-bottom: 3px;">üìß books@dream.com.tw</div>
                                                <div>üì± 06-5555-6666</div>
                                            </td>
                                            <td>
                                                <span
                                                    style="padding: 6px 12px; border-radius: 16px; font-size: 12px; font-weight: 600; background: #fef3c7; color: #d97706; display: inline-block;">ÂæÖÂØ©Ê†∏</span>
                                            </td>
                                            <td
                                                style="text-align: center; font-weight: 700; color: #f97316; font-size: 16px;">
                                                4</td>
                                            <td style="font-size: 13px; color: #6b7280; font-weight: 500;">2024/1/18
                                            </td>
                                            <td>
                                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #f8fafc; color: #374151; border: 1px solid #e5e7eb; border-radius: 6px; font-weight: 500;">üëÅÔ∏è</button>
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #f59e0b; color: white; border-radius: 6px; font-weight: 500;">‚úèÔ∏è</button>
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #10b981; color: white; border-radius: 6px; font-weight: 500;">üîÑ</button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="font-weight: 600; font-size: 15px; color: #1f2937;">10</td>
                                            <td>
                                                <div
                                                    style="font-weight: 600; margin-bottom: 4px; font-size: 15px; color: #1f2937;">
                                                    Ê•µÈÄüÊ±ΩËªäÁ∂≠‰øÆ</div>
                                                <div style="font-size: 13px; color: #6b7280;">Áµ±Á∑®: 88776655</div>
                                            </td>
                                            <td style="font-size: 14px; font-weight: 500; color: #374151;">Èòø‰øÆÂ∏´ÂÇÖ</td>
                                            <td style="font-size: 13px; color: #6b7280; line-height: 1.6;">
                                                <div style="margin-bottom: 3px;">üìß repair@speed.com.tw</div>
                                                <div>üì± 03-9999-0000</div>
                                            </td>
                                            <td>
                                                <span
                                                    style="padding: 6px 12px; border-radius: 16px; font-size: 12px; font-weight: 600; background: #d1fae5; color: #059669; display: inline-block;">Â∑≤Ê†∏ÂáÜ</span>
                                            </td>
                                            <td
                                                style="text-align: center; font-weight: 700; color: #f97316; font-size: 16px;">
                                                6</td>
                                            <td style="font-size: 13px; color: #6b7280; font-weight: 500;">2024/1/19
                                            </td>
                                            <td>
                                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #f8fafc; color: #374151; border: 1px solid #e5e7eb; border-radius: 6px; font-weight: 500;">üëÅÔ∏è</button>
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #f59e0b; color: white; border-radius: 6px; font-weight: 500;">‚úèÔ∏è</button>
                                                    <button class="btn"
                                                        style="padding: 7px 12px; font-size: 12px; background: #10b981; color: white; border-radius: 6px; font-weight: 500;">üîÑ</button>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Êï∏ÊìöÂàÜÊûê -->
                <div class="section" id="analytics-section">
                    <!-- Êï∏ÊìöÁ∏ΩË¶Ω -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <span>üìä</span>
                                <span>Êï∏ÊìöÁ∏ΩË¶Ω</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="stats-grid" id="analyticsStats">
                                <!-- Áµ±Ë®àÊï∏ÊìöÂ∞áÈÄöÈÅé JavaScript ÂãïÊÖãÁîüÊàê -->
                            </div>
                        </div>
                    </div>

                    <!-- Ë∂®Âã¢ÂúñË°® -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <span>üìà</span>
                                <span>Áî®Êà∂Ë®ªÂÜäË∂®Âã¢ (ÊúÄËøë30Â§©)</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="chart-container">
                                <canvas id="userTrendChart" width="800" height="300"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- ÂÑ™ÊÉ†Âà∏ÂàÜÊûê -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">
                                    <span>üé´</span>
                                    <span>ÂÑ™ÊÉ†Âà∏ÁãÄÊÖãÂàÜÂ∏É</span>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="couponStatusChart" width="400" height="300"></canvas>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">
                                    <span>üìÇ</span>
                                    <span>ÁÜ±ÈñÄÂàÜÈ°ûÊéíË°å</span>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="categoryChart" width="400" height="300"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Ë©≥Á¥∞Êï∏ÊìöË°® -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <span>üìã</span>
                                <span>ÁÜ±ÈñÄÂÑ™ÊÉ†Âà∏ÊéíË°å</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-container">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>ÊéíÂêç</th>
                                            <th>ÂÑ™ÊÉ†Âà∏</th>
                                            <th>Âª†ÂïÜ</th>
                                            <th>ÁÄèË¶ΩÊï∏</th>
                                            <th>Êî∂ËóèÊï∏</th>
                                            <th>‰ΩøÁî®Êï∏</th>
                                            <th>ËΩâÊèõÁéá</th>
                                        </tr>
                                    </thead>
                                    <tbody id="popularCouponsTable">
                                        <tr>
                                            <td colspan="7" style="text-align: center; padding: 40px;">
                                                <div class="loading"></div>
                                                <div style="margin-top: 12px;">ËºâÂÖ•‰∏≠...</div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ÂÖßÂÆπÁÆ°ÁêÜ -->
                <div class="section" id="content-section">

                    <!-- Á∂≤Á´ôÂÖ¨ÂëäÁÆ°ÁêÜ -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <span>üì¢</span>
                                <span>Á∂≤Á´ôÂÖ¨Âëä</span>
                            </div>
                            <button class="btn primary" onclick="addAnnouncement()">
                                ‚ûï Êñ∞Â¢ûÂÖ¨Âëä
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="table-container">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Ê®ôÈ°å</th>
                                            <th>È°ûÂûã</th>
                                            <th>ÁãÄÊÖã</th>
                                            <th>ÈñãÂßãÊôÇÈñì</th>
                                            <th>ÁµêÊùüÊôÇÈñì</th>
                                            <th>Êìç‰Ωú</th>
                                        </tr>
                                    </thead>
                                    <tbody id="announcementList">
                                        <tr>
                                            <td colspan="6" style="text-align: center; color: #6b7280; padding: 40px;">
                                                Êö´ÁÑ°ÂÖ¨ÂëäË≥áÊñô
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Ëº™Êí≠ÂúñÁÆ°ÁêÜ -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <span>üñºÔ∏è</span>
                                <span>Ëº™Êí≠ÂúñÁÆ°ÁêÜ</span>
                            </div>
                            <button class="btn primary" onclick="addBanner()">
                                ‚ûï Êñ∞Â¢ûËº™Êí≠Âúñ
                            </button>
                        </div>
                        <div class="card-body">
                            <div id="bannerGrid" class="banner-grid">
                                <div class="banner-placeholder">
                                    <div class="banner-placeholder-content">
                                        <span>üì∑</span>
                                        <p>Êö´ÁÑ°Ëº™Êí≠Âúñ</p>
                                        <button class="btn primary" onclick="addBanner()">‰∏äÂÇ≥ÂúñÁâá</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- FAQ ÁÆ°ÁêÜ -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <span>‚ùì</span>
                                <span>Â∏∏Ë¶ãÂïèÈ°å</span>
                            </div>
                            <button class="btn primary" onclick="addFAQ()">
                                ‚ûï Êñ∞Â¢ûÂïèÈ°å
                            </button>
                        </div>
                        <div class="card-body">
                            <div id="faqList" class="faq-list">
                                <div class="faq-placeholder">
                                    <span>‚ùì</span>
                                    <p>Êö´ÁÑ°Â∏∏Ë¶ãÂïèÈ°å</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Âπ´Âä©ÊñáÊ™î -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <span>üìö</span>
                                <span>Âπ´Âä©ÊñáÊ™î</span>
                            </div>
                            <button class="btn primary" onclick="addHelpDoc()">
                                ‚ûï Êñ∞Â¢ûÊñáÊ™î
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="help-docs-grid">
                                <div class="help-doc-card">
                                    <div class="help-doc-icon">üìñ</div>
                                    <h4>Áî®Êà∂ÊåáÂçó</h4>
                                    <p>Â¶Ç‰Ωï‰ΩøÁî®Âπ≥Âè∞ÁöÑÂü∫Êú¨ÂäüËÉΩ</p>
                                    <div class="help-doc-actions">
                                        <button class="btn secondary" onclick="editHelpDoc('user-guide')">Á∑®ËºØ</button>
                                        <button class="btn secondary" onclick="previewHelpDoc('user-guide')">È†êË¶Ω</button>
                                    </div>
                                </div>
                                <div class="help-doc-card">
                                    <div class="help-doc-icon">üè™</div>
                                    <h4>Âª†ÂïÜÊâãÂÜä</h4>
                                    <p>Âª†ÂïÜÂ¶Ç‰ΩïÁôºÂ∏ÉÂíåÁÆ°ÁêÜÂÑ™ÊÉ†Âà∏</p>
                                    <div class="help-doc-actions">
                                        <button class="btn secondary" onclick="editHelpDoc('vendor-guide')">Á∑®ËºØ</button>
                                        <button class="btn secondary"
                                            onclick="previewHelpDoc('vendor-guide')">È†êË¶Ω</button>
                                    </div>
                                </div>
                                <div class="help-doc-card">
                                    <div class="help-doc-icon">‚ùì</div>
                                    <h4>Â∏∏Ë¶ãÂïèÈ°åËß£Á≠î</h4>
                                    <p>Áî®Êà∂ÊúÄÂ∏∏ÈÅáÂà∞ÁöÑÂïèÈ°åÂèäËß£Ê±∫ÊñπÊ°à</p>
                                    <div class="help-doc-actions">
                                        <button class="btn secondary" onclick="editHelpDoc('faq-guide')">Á∑®ËºØ</button>
                                        <button class="btn secondary" onclick="previewHelpDoc('faq-guide')">È†êË¶Ω</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ÂÆâÂÖ®ÁÆ°ÁêÜ -->
                <div class="section" id="security-section">

                    <!-- ÁôªÂÖ•Êó•Ë™å -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <span>üìä</span>
                                <span>ÁôªÂÖ•Êó•Ë™å</span>
                            </div>
                            <div class="card-actions">
                                <button class="btn secondary" onclick="exportLoginLogs()">üì• ÂåØÂá∫Êó•Ë™å</button>
                                <button class="btn secondary" onclick="clearOldLogs()">üóëÔ∏è Ê∏ÖÁêÜËàäÊó•Ë™å</button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="security-stats">
                                <div class="security-stat-card">
                                    <div class="security-stat-number">127</div>
                                    <div class="security-stat-label">‰ªäÊó•ÁôªÂÖ•</div>
                                </div>
                                <div class="security-stat-card">
                                    <div class="security-stat-number">3</div>
                                    <div class="security-stat-label">Â§±ÊïóÂòóË©¶</div>
                                </div>
                                <div class="security-stat-card">
                                    <div class="security-stat-number">12</div>
                                    <div class="security-stat-label">Áï∞Â∏∏IP</div>
                                </div>
                                <div class="security-stat-card">
                                    <div class="security-stat-number">95%</div>
                                    <div class="security-stat-label">ÂÆâÂÖ®Ë©ïÂàÜ</div>
                                </div>
                            </div>
                            <div class="table-container">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>ÊôÇÈñì</th>
                                            <th>Áî®Êà∂</th>
                                            <th>IPÂú∞ÂùÄ</th>
                                            <th>Âú∞ÂçÄ</th>
                                            <th>Ë£ùÁΩÆ</th>
                                            <th>ÁãÄÊÖã</th>
                                            <th>Êìç‰Ωú</th>
                                        </tr>
                                    </thead>
                                    <tbody id="loginLogsList">
                                        <tr>
                                            <td colspan="7" style="text-align: center; color: #6b7280; padding: 40px;">
                                                ËºâÂÖ•‰∏≠...
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- IP ÁôΩÂêçÂñÆ -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <span>üåê</span>
                                <span>IP ÁôΩÂêçÂñÆ</span>
                            </div>
                            <button class="btn primary" onclick="addIPWhitelist()">
                                ‚ûï Êñ∞Â¢ûIP
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="ip-whitelist-container">
                                <div class="ip-rule">
                                    <div class="ip-info">
                                        <span class="ip-address">192.168.1.100</span>
                                        <span class="ip-label">ÁÆ°ÁêÜÂì°Ëæ¶ÂÖ¨ÂÆ§</span>
                                    </div>
                                    <div class="ip-actions">
                                        <button class="btn secondary" onclick="editIPRule('192.168.1.100')">Á∑®ËºØ</button>
                                        <button class="btn danger" onclick="deleteIPRule('192.168.1.100')">Âà™Èô§</button>
                                    </div>
                                </div>
                                <div class="ip-rule">
                                    <div class="ip-info">
                                        <span class="ip-address">203.74.*.* </span>
                                        <span class="ip-label">ÂÖ¨Âè∏Á∂≤ÊÆµ</span>
                                    </div>
                                    <div class="ip-actions">
                                        <button class="btn secondary" onclick="editIPRule('203.74.*.*')">Á∑®ËºØ</button>
                                        <button class="btn danger" onclick="deleteIPRule('203.74.*.*')">Âà™Èô§</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ÂÖ©Ê≠•È©üÈ©óË≠â -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <span>üîê</span>
                                <span>ÂÖ©Ê≠•È©üÈ©óË≠â</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="two-factor-settings">
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>ÁÆ°ÁêÜÂì°Â∏≥Ëôü 2FA</h4>
                                        <p>ÁÇ∫ÁÆ°ÁêÜÂì°Â∏≥ËôüÂïüÁî®ÂÖ©Ê≠•È©üÈ©óË≠â</p>
                                    </div>
                                    <div class="setting-control">
                                        <label class="switch">
                                            <input type="checkbox" id="admin2FA" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Âª†ÂïÜÂ∏≥Ëôü 2FA</h4>
                                        <p>Âª∫Ë≠∞Âª†ÂïÜÂïüÁî®ÂÖ©Ê≠•È©üÈ©óË≠â</p>
                                    </div>
                                    <div class="setting-control">
                                        <label class="switch">
                                            <input type="checkbox" id="vendor2FA">
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Âº∑Âà∂ 2FA</h4>
                                        <p>Âº∑Âà∂ÊâÄÊúâÁÆ°ÁêÜÂì°‰ΩøÁî®ÂÖ©Ê≠•È©üÈ©óË≠â</p>
                                    </div>
                                    <div class="setting-control">
                                        <label class="switch">
                                            <input type="checkbox" id="force2FA">
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ÈÄöÁü•ÁÆ°ÁêÜ -->
                <div class="section" id="notifications-section">

                    <!-- Âç≥ÊôÇÈÄöÁü• -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <span>‚ö°</span>
                                <span>Âç≥ÊôÇÈÄöÁü•</span>
                            </div>
                            <button class="btn primary" onclick="sendBroadcast()">
                                üì¢ ÁôºÈÄÅÂª£Êí≠
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="notification-stats">
                                <div class="notification-stat-card">
                                    <div class="notification-stat-number">24</div>
                                    <div class="notification-stat-label">‰ªäÊó•ÈÄöÁü•</div>
                                </div>
                                <div class="notification-stat-card">
                                    <div class="notification-stat-number">156</div>
                                    <div class="notification-stat-label">ÂæÖËôïÁêÜ</div>
                                </div>
                                <div class="notification-stat-card">
                                    <div class="notification-stat-number">89%</div>
                                    <div class="notification-stat-label">ÈÄÅÈÅîÁéá</div>
                                </div>
                            </div>
                            <div class="recent-notifications">
                                <h4>ÊúÄËøëÈÄöÁü•</h4>
                                <div class="notification-item">
                                    <div class="notification-icon">üé´</div>
                                    <div class="notification-content">
                                        <div class="notification-title">Êñ∞ÂÑ™ÊÉ†Âà∏ÂæÖÂØ©Ê†∏</div>
                                        <div class="notification-time">2 ÂàÜÈêòÂâç</div>
                                    </div>
                                    <div class="notification-status">Â∑≤ÈÄÅÈÅî</div>
                                </div>
                                <div class="notification-item">
                                    <div class="notification-icon">üë§</div>
                                    <div class="notification-content">
                                        <div class="notification-title">Êñ∞Áî®Êà∂Ë®ªÂÜä</div>
                                        <div class="notification-time">5 ÂàÜÈêòÂâç</div>
                                    </div>
                                    <div class="notification-status">Â∑≤ÈÄÅÈÅî</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ÈÉµ‰ª∂Ê®°Êùø -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <span>‚úâÔ∏è</span>
                                <span>ÈÉµ‰ª∂Ê®°Êùø</span>
                            </div>
                            <button class="btn primary" onclick="createEmailTemplate()">
                                ‚ûï Êñ∞Â¢ûÊ®°Êùø
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="email-templates-grid">
                                <div class="email-template-card">
                                    <div class="email-template-preview">
                                        <div class="email-template-icon">üëã</div>
                                    </div>
                                    <div class="email-template-info">
                                        <h4>Ê≠°ËøéÈÉµ‰ª∂</h4>
                                        <p>Êñ∞Áî®Êà∂Ë®ªÂÜäÊ≠°ËøéÈÉµ‰ª∂</p>
                                        <div class="email-template-actions">
                                            <button class="btn secondary"
                                                onclick="editEmailTemplate('welcome')">Á∑®ËºØ</button>
                                            <button class="btn secondary" onclick="previewEmail('welcome')">È†êË¶Ω</button>
                                        </div>
                                    </div>
                                </div>
                                <div class="email-template-card">
                                    <div class="email-template-preview">
                                        <div class="email-template-icon">üîê</div>
                                    </div>
                                    <div class="email-template-info">
                                        <h4>ÂØÜÁ¢ºÈáçÁΩÆ</h4>
                                        <p>ÂØÜÁ¢ºÈáçÁΩÆÁ¢∫Ë™çÈÉµ‰ª∂</p>
                                        <div class="email-template-actions">
                                            <button class="btn secondary"
                                                onclick="editEmailTemplate('password-reset')">Á∑®ËºØ</button>
                                            <button class="btn secondary"
                                                onclick="previewEmail('password-reset')">È†êË¶Ω</button>
                                        </div>
                                    </div>
                                </div>
                                <div class="email-template-card">
                                    <div class="email-template-preview">
                                        <div class="email-template-icon">üé´</div>
                                    </div>
                                    <div class="email-template-info">
                                        <h4>ÂÑ™ÊÉ†Âà∏ÈÄöÁü•</h4>
                                        <p>Êñ∞ÂÑ™ÊÉ†Âà∏ÁôºÂ∏ÉÈÄöÁü•</p>
                                        <div class="email-template-actions">
                                            <button class="btn secondary"
                                                onclick="editEmailTemplate('coupon-notify')">Á∑®ËºØ</button>
                                            <button class="btn secondary"
                                                onclick="previewEmail('coupon-notify')">È†êË¶Ω</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ÈÄöÁü•Ë®≠ÂÆö -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <span>‚öôÔ∏è</span>
                                <span>ÈÄöÁü•Ë®≠ÂÆö</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="notification-settings">
                                <div class="setting-group">
                                    <h4>Á≥ªÁµ±ÈÄöÁü•</h4>
                                    <div class="setting-item">
                                        <div class="setting-info">
                                            <span>Êñ∞Áî®Êà∂Ë®ªÂÜä</span>
                                            <small>ÊúâÊñ∞Áî®Êà∂Ë®ªÂÜäÊôÇÈÄöÁü•</small>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="setting-item">
                                        <div class="setting-info">
                                            <span>ÂÑ™ÊÉ†Âà∏ÂØ©Ê†∏</span>
                                            <small>ÊúâÂÑ™ÊÉ†Âà∏ÂæÖÂØ©Ê†∏ÊôÇÈÄöÁü•</small>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="setting-item">
                                        <div class="setting-info">
                                            <span>Âª†ÂïÜÁî≥Ë´ã</span>
                                            <small>ÊúâÊñ∞Âª†ÂïÜÁî≥Ë´ãÊôÇÈÄöÁü•</small>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                </div>
                                <div class="setting-group">
                                    <h4>ÈÉµ‰ª∂ÈÄöÁü•</h4>
                                    <div class="setting-item">
                                        <div class="setting-info">
                                            <span>ÊØèÊó•ÊëòË¶Å</span>
                                            <small>ÊØèÊó•Á≥ªÁµ±ÈÅãÁáüÊëòË¶ÅÈÉµ‰ª∂</small>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox">
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="setting-item">
                                        <div class="setting-info">
                                            <span>ÈÄ±Â†±</span>
                                            <small>ÊØèÈÄ±Á≥ªÁµ±Áµ±Ë®àÂ†±Âëä</small>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Â§ñËßÄË®≠ÂÆö -->
                <div class="section" id="appearance-section">
                    <!-- ÁßªÈô§È†ÅÈù¢Ê®ôÈ°åÔºà‰æùÈúÄÊ±Ç‰∏çÈ°ØÁ§∫È†ÅÂÖßÂ§ßÊ®ôÈ°åÔºâ -->

                    <!-- ‰∏ªÈ°åË®≠ÂÆöÔºàÁßªÈô§Âç°ÁâáÊä¨È†≠Ôºâ -->
                    <div class="card">

                        <div class="card-body">
                            <div class="theme-options">
                                <div class="theme-option active" onclick="selectTheme('light')">
                                    <div class="theme-preview light-theme">
                                        <div class="theme-header"></div>
                                        <div class="theme-content">
                                            <div class="theme-sidebar"></div>
                                            <div class="theme-main"></div>
                                        </div>
                                    </div>
                                    <div class="theme-name">Ê∑∫Ëâ≤‰∏ªÈ°å</div>
                                </div>
                                <div class="theme-option" onclick="selectTheme('dark')">
                                    <div class="theme-preview dark-theme">
                                        <div class="theme-header"></div>
                                        <div class="theme-content">
                                            <div class="theme-sidebar"></div>
                                            <div class="theme-main"></div>
                                        </div>
                                    </div>
                                    <div class="theme-name">Ê∑±Ëâ≤‰∏ªÈ°å</div>
                                </div>
                                <div class="theme-option" onclick="selectTheme('auto')">
                                    <div class="theme-preview auto-theme">
                                        <div class="theme-header"></div>
                                        <div class="theme-content">
                                            <div class="theme-sidebar"></div>
                                            <div class="theme-main"></div>
                                        </div>
                                    </div>
                                    <div class="theme-name">Ëá™ÂãïÂàáÊèõ</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Logo ÁÆ°ÁêÜÔºàÁßªÈô§Âç°ÁâáÊä¨È†≠Ôºâ -->
                    <div class="card">

                        <div class="card-body">
                            <div class="logo-management">
                                <div class="logo-upload-section">
                                    <div class="logo-preview">
                                        <img id="logoPreview"
                                            src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIiByeD0iMTAiIGZpbGw9IiNGQ0EzMTEiLz4KPHRleHQgeD0iNTAiIHk9IjU1IiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMzAiIGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+U0g8L3RleHQ+Cjwvc3ZnPg=="
                                            alt="Á∂≤Á´ôLogo">
                                    </div>
                                    <div class="logo-controls">
                                        <input type="file" id="logoUpload" accept="image/*" style="display: none;"
                                            onchange="uploadLogo(this)">
                                        <button class="btn primary"
                                            onclick="document.getElementById('logoUpload').click()">
                                            üìÅ ‰∏äÂÇ≥Logo
                                        </button>
                                        <button class="btn primary" onclick="saveLogo()" style="margin-left: 8px;">
                                            üíæ ‰øùÂ≠òLogo
                                        </button>
                                        <button class="btn secondary" onclick="resetLogo()">
                                            üîÑ ÈáçÁΩÆÁÇ∫È†êË®≠
                                        </button>
                                    </div>
                                </div>
                                <div class="logo-settings">
                                    <div class="setting-item">
                                        <label>LogoÂ∞∫ÂØ∏</label>
                                        <select id="logoSize">
                                            <option value="small">Â∞è (32px)</option>
                                            <option value="medium" selected>‰∏≠ (48px)</option>
                                            <option value="large">Â§ß (64px)</option>
                                        </select>
                                    </div>
                                    <div class="setting-item">
                                        <label>È°ØÁ§∫‰ΩçÁΩÆ</label>
                                        <select id="logoPosition">
                                            <option value="left" selected>Â∑¶ÂÅ¥</option>
                                            <option value="center">‰∏≠Â§Æ</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Ëâ≤ÂΩ©ÊñπÊ°àÔºàÁßªÈô§Âç°ÁâáÊä¨È†≠Ôºâ -->
                    <div class="card">

                        <div class="card-body">
                            <div class="color-scheme-settings">
                                <div class="color-setting">
                                    <label>‰∏ªË¶ÅËâ≤ÂΩ©</label>
                                    <div class="color-input-group">
                                        <input type="color" id="primaryColor" value="#FCA311">
                                        <input type="text" value="#FCA311" readonly>
                                    </div>
                                </div>
                                <div class="color-setting">
                                    <label>Ê¨°Ë¶ÅËâ≤ÂΩ©</label>
                                    <div class="color-input-group">
                                        <input type="color" id="secondaryColor" value="#14213D">
                                        <input type="text" value="#14213D" readonly>
                                    </div>
                                </div>
                                <div class="color-setting">
                                    <label>ËÉåÊôØËâ≤ÂΩ©</label>
                                    <div class="color-input-group">
                                        <input type="color" id="backgroundColor" value="#F8F7F6">
                                        <input type="text" value="#F8F7F6" readonly>
                                    </div>
                                </div>
                                <div class="color-setting">
                                    <label>ÊñáÂ≠óËâ≤ÂΩ©</label>
                                    <div class="color-input-group">
                                        <input type="color" id="textColor" value="#333333">
                                        <input type="text" value="#333333" readonly>
                                    </div>
                                </div>
                            </div>
                            <div class="color-preview">
                                <h4>È†êË¶ΩÊïàÊûú</h4>
                                <div class="color-preview-card">
                                    <div class="preview-header" style="background: #FCA311;">
                                        <span style="color: white;">Á∂≤Á´ôÊ®ôÈ°å</span>
                                    </div>
                                    <div class="preview-content" style="background: #F8F7F6;">
                                        <p style="color: #333333;">ÈÄôÊòØÈ†êË¶ΩÊñáÂ≠óÂÖßÂÆπ</p>
                                        <button style="background: #14213D; color: white;">ÊåâÈàïÊ®£Âºè</button>
                                    </div>
                                </div>
                            </div>
                            <div class="color-actions">
                                <button class="btn primary" onclick="applyColorScheme()">Â•óÁî®Ëâ≤ÂΩ©ÊñπÊ°à</button>
                                <button class="btn secondary" onclick="resetColorScheme()">ÈáçÁΩÆÁÇ∫È†êË®≠</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Á≥ªÁµ±Ë®≠ÂÆö -->
                <div class="section" id="system-section">
                    <!-- Âü∫Êú¨Ë®≠ÂÆö -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <span>üîß</span>
                                <span>Âü∫Êú¨Ë®≠ÂÆö</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px;">
                                <div>
                                    <h4 style="margin-bottom: 16px; color: #374151;">Á∂≤Á´ôË®≠ÂÆö</h4>
                                    <div style="display: grid; gap: 16px;">
                                        <div class="form-group">
                                            <label class="form-label">Á∂≤Á´ôÂêçÁ®±</label>
                                            <input type="text" class="form-input" id="siteName" value="ÈÄÅÈΩÅÂ∫∑ÂÑ™ÊÉ†Âà∏Âπ≥Âè∞">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Á∂≤Á´ôÊèèËø∞</label>
                                            <textarea class="form-input form-textarea"
                                                id="siteDescription">ÊúÄÂ•ΩÁöÑÂÑ™ÊÉ†Âà∏Âπ≥Âè∞ÔºåÁÇ∫ÊÇ®Êèê‰æõÊúÄÂÑ™Ë≥™ÁöÑÊäòÊâ£Ë≥áË®ä</textarea>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">ËÅØÁµ°ÈÉµÁÆ±</label>
                                            <input type="email" class="form-input" id="contactEmail"
                                                value="admin@songhokang.com">
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <h4 style="margin-bottom: 16px; color: #374151;">ÂäüËÉΩË®≠ÂÆö</h4>
                                    <div style="display: grid; gap: 16px;">
                                        <div class="form-group">
                                            <label class="form-label">Áî®Êà∂Ë®ªÂÜä</label>
                                            <select class="form-select" id="userRegistration">
                                                <option value="open">ÈñãÊîæË®ªÂÜä</option>
                                                <option value="approval">ÈúÄË¶ÅÂØ©Ê†∏</option>
                                                <option value="closed">ÈóúÈñâË®ªÂÜä</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Âª†ÂïÜÁî≥Ë´ã</label>
                                            <select class="form-select" id="vendorApplication">
                                                <option value="open">ÈñãÊîæÁî≥Ë´ã</option>
                                                <option value="closed">ÈóúÈñâÁî≥Ë´ã</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">ÂÑ™ÊÉ†Âà∏ÂØ©Ê†∏</label>
                                            <select class="form-select" id="couponReview">
                                                <option value="auto">Ëá™ÂãïÊ†∏ÂáÜ</option>
                                                <option value="manual">ÊâãÂãïÂØ©Ê†∏</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div
                                style="margin-top: 24px; padding-top: 24px; border-top: 1px solid rgba(252, 163, 17, 0.2);">
                                <button class="btn primary" onclick="saveSystemSettings()">
                                    üíæ ÂÑ≤Â≠òË®≠ÂÆö
                                </button>
                                <button class="btn secondary" onclick="resetSystemSettings()">
                                    üîÑ ÈáçÁΩÆË®≠ÂÆö
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Á≥ªÁµ±Ë≥áË®ä -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <span>üìä</span>
                                <span>Á≥ªÁµ±Ë≥áË®ä</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <div
                                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 24px;">
                                <div class="stat-card">
                                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                                        <span style="font-size: 24px;">üñ•Ô∏è</span>
                                        <span style="font-weight: 600; color: #374151;">Á≥ªÁµ±ÁâàÊú¨</span>
                                    </div>
                                    <div style="font-size: 18px; font-weight: bold; color: #FCA311;">v1.0.0</div>
                                    <div style="font-size: 12px; color: #6b7280;">ÈÄÅÈΩÅÂ∫∑ÂÑ™ÊÉ†Âà∏Âπ≥Âè∞</div>
                                </div>

                                <div class="stat-card">
                                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                                        <span style="font-size: 24px;">üîÑ</span>
                                        <span style="font-weight: 600; color: #374151;">ÈÅãË°åÁãÄÊÖã</span>
                                    </div>
                                    <div style="font-size: 18px; font-weight: bold; color: #10b981;">Ê≠£Â∏∏ÈÅãË°å</div>
                                    <div style="font-size: 12px; color: #6b7280;" id="uptime">ÈÅãË°åÊôÇÈñì: ËºâÂÖ•‰∏≠...</div>
                                </div>

                                <div class="stat-card">
                                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                                        <span style="font-size: 24px;">üíæ</span>
                                        <span style="font-weight: 600; color: #374151;">Ë≥áÊñôÂ∫´</span>
                                    </div>
                                    <div style="font-size: 18px; font-weight: bold; color: #3b82f6;">MySQL</div>
                                    <div style="font-size: 12px; color: #6b7280;">ÈÄ£Á∑öÊ≠£Â∏∏</div>
                                </div>

                                <div class="stat-card">
                                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                                        <span style="font-size: 24px;">üìà</span>
                                        <span style="font-weight: 600; color: #374151;">API ÁãÄÊÖã</span>
                                    </div>
                                    <div style="font-size: 18px; font-weight: bold; color: #10b981;">Ê≠£Â∏∏</div>
                                    <div style="font-size: 12px; color: #6b7280;">ÂõûÊáâÊôÇÈñì: <50ms< /div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Êìç‰ΩúÊó•Ë™å -->
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">
                                    <span>üìù</span>
                                    <span>ÊúÄËøëÊìç‰ΩúÊó•Ë™å</span>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="table-container">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>ÊôÇÈñì</th>
                                                <th>Êìç‰ΩúËÄÖ</th>
                                                <th>Êìç‰ΩúÈ°ûÂûã</th>
                                                <th>Ë©≥Á¥∞ÂÖßÂÆπ</th>
                                                <th>IP Âú∞ÂùÄ</th>
                                            </tr>
                                        </thead>
                                        <tbody id="systemLogsTable">
                                            <tr>
                                                <td colspan="5" style="text-align: center; padding: 40px;">
                                                    <div class="loading"></div>
                                                    <div style="margin-top: 12px;">ËºâÂÖ•‰∏≠...</div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Âø´ÈÄüÊìç‰Ωú -->
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">
                                    <span>‚ö°</span>
                                    <span>Âø´ÈÄüÊìç‰Ωú</span>
                                </div>
                            </div>
                            <div class="card-body">
                                <div
                                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                                    <button class="btn secondary" onclick="clearCache()">
                                        üóëÔ∏è Ê∏ÖÈô§Âø´Âèñ
                                    </button>
                                    <button class="btn secondary" onclick="exportData()">
                                        üì§ ÂåØÂá∫Ë≥áÊñô
                                    </button>
                                    <button class="btn secondary" onclick="backupDatabase()">
                                        üíæ ÂÇô‰ªΩË≥áÊñôÂ∫´
                                    </button>
                                    <button class="btn secondary" onclick="checkSystemHealth()">
                                        üîç Á≥ªÁµ±Ê™¢Êü•
                                    </button>
                                    <button class="btn danger" onclick="restartSystem()">
                                        üîÑ ÈáçÂïüÁ≥ªÁµ±
                                    </button>
                                    <button class="btn secondary" onclick="viewErrorLogs()">
                                        üìã ÈåØË™§Êó•Ë™å
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script>
            // ÂÖ®Â±ÄËÆäÈáè - ÁÆ°ÁêÜÂì°ÂæåÂè∞‰ΩøÁî®Áç®Á´ãÁöÑ token key
            const LS_TOKEN = 'authToken_admin';
            let currentSection = 'dashboard';
            let currentUser = null;
            let users = [];
            let coupons = [];
            let vendors = [];

            // Ë™çË≠âÁõ∏Èóú
            function getAuthToken() {
                return localStorage.getItem(LS_TOKEN) || '';
            }

            function getAuthHeaders() {
                return {
                    'Authorization': `Bearer ${getAuthToken()}`,
                    'Content-Type': 'application/json'
                };
            }

            // Ë∑ØÂæëÂ∑•ÂÖ∑ÔºöÂ∞áÁõ∏Â∞çÂúñÁâáË∑ØÂæëËΩâÊàêÂèØÂú® /admin/ ‰∏ãÊ≠£Á¢∫È°ØÁ§∫
            function resolveImageUrl(url) {
                if (!url) return '';
                if (url.startsWith('http') || url.startsWith('data:')) return url;
                if (url.startsWith('/')) return url; // ‰æãÂ¶Ç /uploads/...
                // Â∞á img/... ÈÄôÈ°ûË∑ØÂæëËΩâÁÇ∫ ../img/...Ôºå‰ΩøÂÖ∂ÂæûÁ∂≤Á´ôÊ†πÁõÆÈåÑËºâÂÖ•
                return '../' + url.replace(/^\.\//, '');
            }

            // Ê¨äÈôêÊ™¢Êü•
            async function checkAuth() {
                try {
                    const response = await fetch('../api/auth/me', {
                        headers: getAuthHeaders()
                    });

                    if (!response.ok) {
                        throw new Error('Ë™çË≠âÂ§±Êïó');
                    }

                    const data = await response.json();

                    if (!data.success) {
                        throw new Error(data.message || 'Ë™çË≠âÂ§±Êïó');
                    }

                    currentUser = data.data;

                    // Ê™¢Êü•ÊòØÂê¶ÁÇ∫ÁÆ°ÁêÜÂì°
                    if (currentUser.role !== 'admin') {
                        alert('Ê≠§È†ÅÈù¢ÂÉÖÈôêÁÆ°ÁêÜÂì°Ë®™Âïè');
                        window.location.href = '../index.html';
                        return false;
                    }

                    return true;
                } catch (error) {
                    console.error('Ë™çË≠âÊ™¢Êü•Â§±Êïó:', error);
                    alert('Ë´ãÂÖàÁôªÂÖ•');
                    window.location.href = '../index.html';
                    return false;
                }
            }

            // Â∞éËà™ÂäüËÉΩ
            async function showSection(sectionName) {
                if (!sectionName) return; // ÈÅøÂÖçÁ©∫ÂÄº
                const target = document.getElementById(`${sectionName}-section`);
                if (!target) return; // Êâæ‰∏çÂà∞Â∞çÊáâÂçÄÂ°äÂâá‰∏çËôïÁêÜ

                // Èö±ËóèÊâÄÊúâÂçÄÊÆµ
                document.querySelectorAll('.section').forEach(section => {
                    section.classList.remove('active');
                });

                // È°ØÁ§∫ÊåáÂÆöÂçÄÊÆµ
                target.classList.add('active');

                // Êõ¥Êñ∞Â∞éËà™ÁãÄÊÖãÔºàÂÉÖÈáùÂ∞çÂÖ∑ data-section ÁöÑÈ†ÖÁõÆÔºâ
                document.querySelectorAll('.nav-link[data-section]').forEach(link => {
                    link.classList.toggle('active', link.getAttribute('data-section') === sectionName);
                });

                currentSection = sectionName;

                // ËºâÂÖ•Â∞çÊáâÊï∏Êìö
                try {
                    switch (sectionName) {
                        case 'dashboard':
                            loadDashboardData();
                            break;
                        case 'users':
                            loadUsers();
                            break;
                        case 'coupons':
                            loadCoupons();
                            break;
                        case 'vendors':
                            loadVendors();
                            break;
                        case 'analytics':
                            loadAnalytics();
                            break;
                        case 'meta':
                            // ÂàùÊ¨°ÂàáÊèõÊôÇËºâÂÖ•Âü∫Á§éÊ∏ÖÂñÆ
                            if (!window.__metaLoaded) {
                                await loadMetaBaseInline();
                                window.__metaLoaded = true;
                            }
                            break;
                        case 'content':
                            loadContentManagement();
                            break;
                        case 'security':
                            loadSecurityManagement();
                            break;
                        case 'notifications':
                            loadNotifications();
                            break;
                        case 'appearance':
                            loadAppearanceSettings();
                            break;
                        case 'system':
                            loadSystemInfo();
                            loadSystemSettings();
                            break;
                    }
                } catch (error) {
                    console.error(`ËºâÂÖ• ${sectionName} ÂçÄÊÆµÊôÇÁôºÁîüÈåØË™§:`, error);
                }
            }

            // ËºâÂÖ•ÂÑÄË°®ÊùøÊï∏Êìö
            async function loadDashboardData() {
                try {
                    // ËºâÂÖ•Áµ±Ë®àÊï∏Êìö
                    const response = await fetch('../api/stats/dashboard', {
                        headers: getAuthHeaders()
                    });

                    if (response.ok) {
                        const data = await response.json();
                        if (data.success) {
                            renderStats(data.data);
                        }
                    }

                    // ËºâÂÖ•ÊúÄÊñ∞Ê¥ªÂãï
                    loadRecentActivities();
                } catch (error) {
                    console.error('ËºâÂÖ•ÂÑÄË°®ÊùøÊï∏ÊìöÂ§±Êïó:', error);
                }
            }

            // Ê∏≤ÊüìÁµ±Ë®àÂç°Áâá
            function renderStats(stats) {
                const statsGrid = document.getElementById('statsGrid');

                const statCards = [
                    {
                        icon: 'üë•',
                        value: stats.total_users || 0,
                        label: 'Á∏ΩÁî®Êà∂Êï∏',
                        change: stats.users_change || 0,
                        changeType: stats.users_change >= 0 ? 'positive' : 'negative'
                    },
                    {
                        icon: 'üé´',
                        value: stats.total_coupons || 0,
                        label: 'Á∏ΩÂÑ™ÊÉ†Âà∏Êï∏',
                        change: stats.coupons_change || 0,
                        changeType: stats.coupons_change >= 0 ? 'positive' : 'negative'
                    },
                    {
                        icon: 'üè™',
                        value: stats.total_vendors || 0,
                        label: 'Ê¥ªË∫çÂª†ÂïÜ',
                        change: stats.vendors_change || 0,
                        changeType: stats.vendors_change >= 0 ? 'positive' : 'negative'
                    },
                    {
                        icon: 'üìä',
                        value: stats.total_views || 0,
                        label: 'Á∏ΩÁÄèË¶ΩÊï∏',
                        change: stats.views_change || 0,
                        changeType: stats.views_change >= 0 ? 'positive' : 'negative'
                    }
                ];

                statsGrid.innerHTML = statCards.map(card => `
                <div class="stat-card">
                    <span class="stat-icon">${card.icon}</span>
                    <div class="stat-value">${card.value.toLocaleString()}</div>
                    <div class="stat-label">${card.label}</div>
                    <div class="stat-change ${card.changeType}">
                        ${card.change >= 0 ? '+' : ''}${card.change}%
                    </div>
                </div>
            `).join('');
            }

            // Á≥ªÁµ±Ë®≠ÂÆöËÆÄÂØ´
            async function loadSystemSettings() {
                try {
                    const res = await fetch('../api/settings', { headers: getAuthHeaders() });
                    const data = await res.json();
                    if (data.success) {
                        const s = data.data || {};
                        // Êò†Â∞ÑÂà∞‰ªãÈù¢ÂÖÉÁ¥†ÔºàËã•ÊúâÔºâ
                        const siteNameEl = document.getElementById('setting_site_name');
                        if (siteNameEl) siteNameEl.value = s.site_name || '';
                        const maxUploadEl = document.getElementById('setting_max_upload');
                        if (maxUploadEl) maxUploadEl.value = s.max_upload_size || 5242880;
                        const autoApproveCouponEl = document.getElementById('setting_coupon_auto');
                        if (autoApproveCouponEl) autoApproveCouponEl.checked = !!s.coupon_auto_approve;
                        const autoApproveVendorEl = document.getElementById('setting_vendor_auto');
                        if (autoApproveVendorEl) autoApproveVendorEl.checked = !!s.vendor_auto_approve;
                    }
                } catch (e) {
                    console.warn('ËºâÂÖ•Á≥ªÁµ±Ë®≠ÂÆöÂ§±Êïó', e);
                }
            }

            async function saveSystemSettings() {
                try {
                    const payload = {};
                    const siteNameEl = document.getElementById('setting_site_name');
                    if (siteNameEl) payload.site_name = siteNameEl.value.trim();
                    const maxUploadEl = document.getElementById('setting_max_upload');
                    if (maxUploadEl) payload.max_upload_size = parseInt(maxUploadEl.value || '0', 10) || 0;
                    const autoApproveCouponEl = document.getElementById('setting_coupon_auto');
                    if (autoApproveCouponEl) payload.coupon_auto_approve = !!autoApproveCouponEl.checked;
                    const autoApproveVendorEl = document.getElementById('setting_vendor_auto');
                    if (autoApproveVendorEl) payload.vendor_auto_approve = !!autoApproveVendorEl.checked;

                    const res = await fetch('../api/settings', { method: 'PUT', headers: getAuthHeaders(), body: JSON.stringify(payload) });
                    const data = await res.json();
                    if (data.success) {
                        alert('Á≥ªÁµ±Ë®≠ÂÆöÂ∑≤Êõ¥Êñ∞');
                    } else {
                        alert('Êõ¥Êñ∞Â§±ÊïóÔºö' + (data.message || 'Êú™Áü•ÈåØË™§'));
                    }
                } catch (e) {
                    alert('ÂÑ≤Â≠òÂ§±ÊïóÔºö' + e.message);
                }
            }

            // ËºâÂÖ•ÊúÄÊñ∞Ê¥ªÂãï
            async function loadRecentActivities() {
                const container = document.getElementById('recentActivities');

                try {
                    // ÈÄôË£°ÂèØ‰ª•Ë™øÁî®ÂØ¶ÈöõÁöÑ API
                    // Êö´ÊôÇÈ°ØÁ§∫Ê®°Êì¨Êï∏Êìö
                    setTimeout(() => {
                        container.innerHTML = `
                        <div style="display: flex; flex-direction: column; gap: 16px;">
                            <div style="display: flex; align-items: center; gap: 12px; padding: 12px; background: rgba(252, 163, 17, 0.05); border-radius: 8px;">
                                <span style="font-size: 20px;">üé´</span>
                                <div>
                                    <div style="font-weight: 600;">Êñ∞ÂÑ™ÊÉ†Âà∏ÂæÖÂØ©Ê†∏</div>
                                    <div style="font-size: 14px; color: #6b7280;">Âª†ÂïÜ "ÁæéÈ£üÂ§©Â†Ç" Êèê‰∫§‰∫ÜÊñ∞ÁöÑÂÑ™ÊÉ†Âà∏</div>
                                </div>
                                <div style="margin-left: auto; font-size: 12px; color: #9ca3af;">2 ÂàÜÈêòÂâç</div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 12px; padding: 12px; background: rgba(16, 185, 129, 0.05); border-radius: 8px;">
                                <span style="font-size: 20px;">üë§</span>
                                <div>
                                    <div style="font-weight: 600;">Êñ∞Áî®Êà∂Ë®ªÂÜä</div>
                                    <div style="font-size: 14px; color: #6b7280;">Áî®Êà∂ "ÂºµÂ∞èÊòé" ÂÆåÊàêË®ªÂÜä</div>
                                </div>
                                <div style="margin-left: auto; font-size: 12px; color: #9ca3af;">5 ÂàÜÈêòÂâç</div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 12px; padding: 12px; background: rgba(59, 130, 246, 0.05); border-radius: 8px;">
                                <span style="font-size: 20px;">üè™</span>
                                <div>
                                    <div style="font-weight: 600;">Âª†ÂïÜÁî≥Ë´ã</div>
                                    <div style="font-size: 14px; color: #6b7280;">Êñ∞Âª†ÂïÜ "ÊôÇÂ∞öÊúçÈ£æÂ∫ó" Êèê‰∫§Áî≥Ë´ã</div>
                                </div>
                                <div style="margin-left: auto; font-size: 12px; color: #9ca3af;">10 ÂàÜÈêòÂâç</div>
                            </div>
                        </div>
                    `;
                    }, 1000);
                } catch (error) {
                    container.innerHTML = '<div style="text-align: center; color: #ef4444;">ËºâÂÖ•Â§±Êïó</div>';
                }
            }

            // ËºâÂÖ•Áî®Êà∂ÂàóË°®
            async function loadUsers() {
                try {
                    const q = (document.getElementById('userSearch')?.value || '').trim();
                    const role = document.getElementById('roleFilter')?.value || '';
                    const status = document.getElementById('statusFilter')?.value || '';
                    const params = new URLSearchParams();
                    params.set('page', '1');
                    params.set('pageSize', '1000');
                    if (q) params.set('search', q);
                    if (role) params.set('role', role);
                    if (status) params.set('status', status);
                    const response = await fetch('../api/users?' + params.toString(), {
                        headers: getAuthHeaders()
                    });

                    console.log('Áî®Êà∂ API ÂõûÊáâÁãÄÊÖã:', response.status);

                    if (response.ok) {
                        const data = await response.json();
                        console.log('Áî®Êà∂ API Êï∏Êìö:', data);

                        if (data.success) {
                            // ÂòóË©¶Â§öÁ®ÆÂèØËÉΩÁöÑÊï∏ÊìöÁµêÊßã
                            users = data.data?.items || data.data?.users || data.data || [];
                            console.log('Ëß£ÊûêÁöÑÁî®Êà∂Êï∏Êìö:', users);
                            renderUsers(users);
                        } else {
                            console.error('API ËøîÂõûÂ§±Êïó:', data.message);
                            document.getElementById('usersTable').innerHTML = `
                                <tr>
                                    <td colspan="6" style="text-align: center; color: #ef4444;">API ÈåØË™§: ${data.message || 'Êú™Áü•ÈåØË™§'}</td>
                                </tr>
                            `;
                        }
                    } else {
                        const errorText = await response.text();
                        console.error('HTTP ÈåØË™§:', response.status, errorText);
                        document.getElementById('usersTable').innerHTML = `
                            <tr>
                                <td colspan="6" style="text-align: center; color: #ef4444;">HTTP ${response.status}: ${errorText}</td>
                            </tr>
                        `;
                    }
                } catch (error) {
                    console.error('ËºâÂÖ•Áî®Êà∂Â§±Êïó:', error);
                    document.getElementById('usersTable').innerHTML = `
                        <tr>
                            <td colspan="6" style="text-align: center; color: #ef4444;">Á∂≤Ë∑ØÈåØË™§: ${error.message}</td>
                        </tr>
                    `;
                }
            }

            // Ê∏≤ÊüìÁî®Êà∂Ë°®Ê†º
            function renderUsers(userList) {
                const tbody = document.getElementById('usersTable');

                console.log('Ê∏≤ÊüìÁî®Êà∂ÂàóË°®:', userList);

                if (!userList || userList.length === 0) {
                    tbody.innerHTML = `
                        <tr>
                            <td colspan="6" style="text-align: center; padding: 40px;">
                                <div style="color: #6b7280;">Êö´ÁÑ°Áî®Êà∂Ë≥áÊñô</div>
                                <div style="color: #9ca3af; font-size: 12px; margin-top: 8px;">Ë´ãÊ™¢Êü•Êï∏ÊìöÂ∫´ÊòØÂê¶ÊúâÁî®Êà∂Êï∏Êìö</div>
                            </td>
                        </tr>
                    `;
                    return;
                }

                tbody.innerHTML = userList.map(user => `
                <tr>
                    <td>
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div style="width: 40px; height: 40px; min-width: 40px; min-height: 40px; border-radius: 50%; background: linear-gradient(135deg, #FCA311, #f59e0b); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; flex-shrink: 0;">
                                ${user.username ? user.username.charAt(0).toUpperCase() : '?'}
                            </div>
                            <div>
                                <div style="font-weight: 600;">${user.username || 'Êú™Ë®≠ÂÆö'}</div>
                                <div style="font-size: 14px; color: #6b7280;">${user.email || 'Êú™Ë®≠ÂÆö'}</div>
                            </div>
                        </div>
                    </td>
                    <td>
                        <span class="badge role-${user.role}">
                            ${user.role === 'admin' ? 'üëë ÁÆ°ÁêÜÂì°' :
                        user.role === 'vendor' ? 'üè™ Âª†ÂïÜ' : 'üë§ ÊúÉÂì°'}
                        </span>
                    </td>
                    <td>
                        <span class="badge status-${user.status}">
                            ${user.status === 'active' ? '‚úÖ Â∑≤ÂïüÁî®' :
                        user.status === 'pending' ? '‚è≥ ÂæÖÂØ©Ê†∏' :
                            user.status === 'inactive' ? '‚ùå Â∑≤ÂÅúÁî®' :
                                user.status === 'suspended' ? 'üö´ Â∑≤Êö´ÂÅú' : '‚ùì Êú™Áü•ÁãÄÊÖã'}
                        </span>
                    </td>
                    <td style="font-size: 14px; color: #6b7280;">
                        ${user.created_at ? new Date(user.created_at).toLocaleDateString('zh-TW') : 'Êú™Áü•'}
                    </td>
                    <td style="font-size: 14px; color: #6b7280;">
                        ${user.last_login && user.last_login !== '0000-00-00 00:00:00' && user.last_login !== null ?
                        new Date(user.last_login).toLocaleDateString('zh-TW') + ' ' +
                        new Date(user.last_login).toLocaleTimeString('zh-TW', { hour: '2-digit', minute: '2-digit' }) :
                        'ÂæûÊú™ÁôªÂÖ•'}
                    </td>
                    <td>
                        <div style="display: flex; gap: 6px; flex-wrap: wrap; align-items: center;">
                            <button class="btn secondary" onclick="viewUser(${user.id})" style="padding: 4px 8px; font-size: 11px; min-width: 50px;">
                                üëÅÔ∏è Êü•Áúã
                            </button>
                            <button class="btn secondary" onclick="switchToUser(${user.id})" style="padding: 4px 8px; font-size: 11px; min-width: 50px;">
                                üîÑ ÂàáÊèõ
                            </button>
                            ${user.status === 'active' ?
                        `<button class="btn danger" onclick="deactivateUser(${user.id})" style="padding: 4px 8px; font-size: 11px; min-width: 50px;">ÂÅúÁî®</button>` :
                        `<button class="btn primary" onclick="activateUser(${user.id})" style="padding: 4px 8px; font-size: 11px; min-width: 50px;">ÂïüÁî®</button>`
                    }
                            ${user.role !== 'admin' ?
                        `<button class="btn danger" onclick="deleteUser(${user.id}, '${user.username}')" style="padding: 4px 8px; font-size: 11px; min-width: 50px; background: #dc2626;">üóëÔ∏è Âà™Èô§</button>` :
                        ''
                    }
                        </div>
                    </td>
                </tr>
            `).join('');
            }

            // ËºâÂÖ•ÂÑ™ÊÉ†Âà∏ÂàóË°®
            async function loadCoupons() {
                try {
                    const response = await fetch('../api/coupons', {
                        headers: getAuthHeaders()
                    });

                    console.log('ÂÑ™ÊÉ†Âà∏ API ÂõûÊáâÁãÄÊÖã:', response.status);

                    if (response.ok) {
                        const data = await response.json();
                        console.log('ÂÑ™ÊÉ†Âà∏ API Êï∏Êìö:', data);

                        if (data.success) {
                            // ÂòóË©¶Â§öÁ®ÆÂèØËÉΩÁöÑÊï∏ÊìöÁµêÊßã
                            coupons = data.data?.items || data.data?.coupons || data.data || [];
                            console.log('Ëß£ÊûêÁöÑÂÑ™ÊÉ†Âà∏Êï∏Êìö:', coupons);
                            renderCoupons(coupons);
                        } else {
                            console.error('API ËøîÂõûÂ§±Êïó:', data.message);
                            document.getElementById('couponsTable').innerHTML = `
                                <tr>
                                    <td colspan="7" style="text-align: center; color: #ef4444;">API ÈåØË™§: ${data.message || 'Êú™Áü•ÈåØË™§'}</td>
                                </tr>
                            `;
                        }
                    } else {
                        const errorText = await response.text();
                        console.error('HTTP ÈåØË™§:', response.status, errorText);
                        document.getElementById('couponsTable').innerHTML = `
                            <tr>
                                <td colspan="7" style="text-align: center; color: #ef4444;">HTTP ${response.status}: ${errorText}</td>
                            </tr>
                        `;
                    }
                } catch (error) {
                    console.error('ËºâÂÖ•ÂÑ™ÊÉ†Âà∏Â§±Êïó:', error);
                    document.getElementById('couponsTable').innerHTML = `
                        <tr>
                            <td colspan="7" style="text-align: center; color: #ef4444;">Á∂≤Ë∑ØÈåØË™§: ${error.message}</td>
                        </tr>
                    `;
                }
            }

            // Ê∏≤ÊüìÂÑ™ÊÉ†Âà∏Ë°®Ê†º
            function renderCoupons(couponList) {
                const tbody = document.getElementById('couponsTable');

                console.log('Ê∏≤ÊüìÂÑ™ÊÉ†Âà∏ÂàóË°®:', couponList);

                if (!couponList || couponList.length === 0) {
                    tbody.innerHTML = `
                        <tr>
                            <td colspan="8" style="text-align: center; padding: 40px;">
                                <div style="color: #6b7280;">Êö´ÁÑ°ÂÑ™ÊÉ†Âà∏Ë≥áÊñô</div>
                                <div style="color: #9ca3af; font-size: 12px; margin-top: 8px;">Ë´ãÊ™¢Êü•Êï∏ÊìöÂ∫´ÊòØÂê¶ÊúâÂÑ™ÊÉ†Âà∏Êï∏Êìö</div>
                            </td>
                        </tr>
                    `;
                    return;
                }

                tbody.innerHTML = couponList.map((coupon, index) => `
                <tr>
                    <td style="font-weight: 600; font-size: 14px; text-align: center;">${coupon.id || (index + 1)}</td>
                    <td>
                        <div style="display:flex; gap:12px; align-items:flex-start;">
                            ${coupon.image ? `<img src="${resolveImageUrl(coupon.image)}" alt="thumb" style="width:64px;height:64px;object-fit:cover;border-radius:8px;flex:0 0 auto;">` : ''}
                            <div style="min-width:0;">
                        <div style="font-weight: 600; margin-bottom: 4px; font-size: 15px; line-height: 1.4; color: #1f2937;">
                            ${coupon.title || 'Êú™Ë®≠ÂÆöÊ®ôÈ°å'}
                        </div>
                        <div style="font-size: 13px; color: #6b7280; line-height: 1.3; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                            ${coupon.description || 'ÁÑ°ÊèèËø∞'}
                                </div>
                            </div>
                        </div>
                    </td>
                    <td style="font-size: 14px; color: #f97316; font-weight: 600;">${coupon.company_name || 'Êú™Áü•Âª†ÂïÜ'}</td>
                    <td>
                        <span style="padding: 4px 8px; background: #fef3c7; color: #d97706; border-radius: 12px; font-size: 11px; font-weight: 500;">
                            ${coupon.category || 'Êú™ÂàÜÈ°û'}
                        </span>
                    </td>
                    <td>
                        <span style="padding: 4px 8px; border-radius: 12px; font-size: 11px; font-weight: 500; ${coupon.status === 'pending' ? 'background: #fef3c7; color: #d97706;' :
                        coupon.status === 'approved' ? 'background: #d1fae5; color: #059669;' :
                            coupon.status === 'active' ? 'background: #dbeafe; color: #2563eb;' :
                                coupon.status === 'expired' ? 'background: #fee2e2; color: #dc2626;' : 'background: #fecaca; color: #dc2626;'
                    }">
                        ${coupon.status === 'pending' ? 'ÂæÖÂØ©Ê†∏' :
                        coupon.status === 'approved' ? 'Â∑≤Ê†∏ÂáÜ' :
                            coupon.status === 'active' ? '‰∏äÁ∑ö‰∏≠' :
                                coupon.status === 'expired' ? 'Â∑≤ÈÅéÊúü' : 'Â∑≤ÈßÅÂõû'}
                        </span>
                    </td>
                    <td>
                        <div style="font-size: 12px; color: #6b7280;">
                            <div>üëÅÔ∏è ${coupon.view_count || 0}</div>
                            <div>‚ù§Ô∏è ${coupon.favorite_count || 0}</div>
                            <div>‚úÖ ${coupon.used_count || 0}</div>
                        </div>
                    </td>
                    <td style="font-size: 13px; color: #6b7280;">
                        ${coupon.end_date ? new Date(coupon.end_date).toLocaleDateString('zh-TW') : 'ÁÑ°ÊúüÈôê'}
                    </td>
                    <td>
                        <div style="display: flex; gap: 4px; flex-wrap: wrap;">
                            <button class="btn" onclick="viewCoupon(${coupon.id || index})" style="padding: 4px 8px; font-size: 11px; background: #f3f4f6; color: #374151; border: 1px solid #d1d5db;">
                                üëÅÔ∏è
                            </button>
                            <button class="btn" onclick="editCoupon(${coupon.id || index})" style="padding: 4px 8px; font-size: 11px; background: #fbbf24; color: white;">
                                ‚úèÔ∏è
                            </button>
                            <button class="btn" onclick="openTagDrawer(${coupon.id || index})" title="Ê®ôÁ±§" style="padding: 4px 8px; font-size: 11px; background: #10b981; color: white;">
                                üè∑Ô∏è
                            </button>
                            <button class="btn" onclick="openRegionDrawer(${coupon.id || index})" title="Âú∞ÂçÄ" style="padding: 4px 8px; font-size: 11px; background: #2563eb; color: white;">
                                üìç
                            </button>
                            <button class="btn" onclick="deleteCoupon(${coupon.id || index})" style="padding: 4px 8px; font-size: 11px; background: #ef4444; color: white;">
                                üóëÔ∏è
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
            }

            // Áî®Êà∂Êìç‰ΩúÂáΩÊï∏
            async function viewUser(userId) {
                try {
                    const response = await fetch(`../api/users/${userId}`, {
                        headers: getAuthHeaders()
                    });

                    if (response.ok) {
                        const data = await response.json();
                        if (data.success) {
                            showUserModal(data.data);
                        }
                    }
                } catch (error) {
                    console.error('ËºâÂÖ•Áî®Êà∂Ë©≥ÊÉÖÂ§±Êïó:', error);
                    alert('ËºâÂÖ•Áî®Êà∂Ë©≥ÊÉÖÂ§±Êïó');
                }
            }

            function showUserModal(user) {
                // ÂâµÂª∫Ê®°ÊÖãÊ°ÜÈ°ØÁ§∫Áî®Êà∂Ë©≥ÊÉÖ
                const modal = document.createElement('div');
                modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.6);
                backdrop-filter: blur(4px);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1000;
                padding: 20px;
            `;

                modal.innerHTML = `
                <div style="background: white; border-radius: 20px; padding: 32px; max-width: 600px; width: 100%; max-height: 80vh; overflow-y: auto;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                        <h2 style="margin: 0; color: #1f2937;">üë§ Áî®Êà∂Ë©≥ÊÉÖ</h2>
                        <button onclick="this.closest('[style*=\"position: fixed\"]').remove()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #6b7280;">√ó</button>
                    </div>
                    
                    <div style="display: grid; gap: 16px;">
                        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 12px; padding: 16px; background: #f9fafb; border-radius: 12px;">
                            <strong>Áî®Êà∂ÂêçÁ®±:</strong>
                            <span>${user.username || 'Êú™Ë®≠ÂÆö'}</span>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 12px; padding: 16px; background: #f9fafb; border-radius: 12px;">
                            <strong>ÈõªÂ≠êÈÉµÁÆ±:</strong>
                            <span>${user.email || 'Êú™Ë®≠ÂÆö'}</span>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 12px; padding: 16px; background: #f9fafb; border-radius: 12px;">
                            <strong>ËßíËâ≤:</strong>
                            <span class="badge role-${user.role}">
                                ${user.role === 'admin' ? 'üëë ÁÆ°ÁêÜÂì°' :
                        user.role === 'vendor' ? 'üè™ Âª†ÂïÜ' : 'üë§ ÊúÉÂì°'}
                            </span>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 12px; padding: 16px; background: #f9fafb; border-radius: 12px;">
                            <strong>ÁãÄÊÖã:</strong>
                            <span class="badge status-${user.status}">
                                ${user.status === 'active' ? '‚úÖ Â∑≤ÂïüÁî®' :
                        user.status === 'pending' ? '‚è≥ ÂæÖÂØ©Ê†∏' :
                            user.status === 'inactive' ? '‚ùå Â∑≤ÂÅúÁî®' :
                                user.status === 'suspended' ? 'üö´ Â∑≤Êö´ÂÅú' : '‚ùì Êú™Áü•ÁãÄÊÖã'}
                            </span>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 12px; padding: 16px; background: #f9fafb; border-radius: 12px;">
                            <strong>Ë®ªÂÜäÊôÇÈñì:</strong>
                            <span>${user.created_at ? new Date(user.created_at).toLocaleString('zh-TW') : 'Êú™Áü•'}</span>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 12px; padding: 16px; background: #f9fafb; border-radius: 12px;">
                            <strong>ÊúÄÂæåÁôªÂÖ•:</strong>
                            <span>${user.last_login ? new Date(user.last_login).toLocaleString('zh-TW') : 'ÂæûÊú™ÁôªÂÖ•'}</span>
                        </div>
                    </div>

                    <div style="display: flex; gap: 12px; justify-content: flex-end; margin-top: 24px; padding-top: 24px; border-top: 1px solid #e5e7eb;">
                        <button class="btn secondary" onclick="this.closest('[style*=\"position: fixed\"]').remove()">ÈóúÈñâ</button>
                        <button class="btn primary" onclick="switchToUser(${user.id}); this.closest('[style*=\"position: fixed\"]').remove();">ÂàáÊèõÂà∞Ê≠§Áî®Êà∂</button>
                    </div>
                </div>
            `;

                // ÈªûÊìäËÉåÊôØÈóúÈñâ
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.remove();
                    }
                });

                document.body.appendChild(modal);
            }

            async function switchToUser(userId) {
                if (!confirm('Á¢∫ÂÆöË¶ÅÂú®Êñ∞ÂàÜÈ†Å‰∏≠ÂàáÊèõÂà∞Ê≠§Áî®Êà∂Â∏≥ËôüÂóéÔºü\n\nÊ≥®ÊÑèÔºöÈÄôÊúÉÂú®Êñ∞ÂàÜÈ†Å‰∏≠‰ª•Ë©≤Áî®Êà∂Ë∫´‰ªΩÁôªÂÖ•ÔºåÊÇ®ÁöÑÁÆ°ÁêÜÂì°ÊúÉË©±Â∞á‰øùÊåÅ‰∏çËÆä„ÄÇ')) {
                    return;
                }

                try {
                    const response = await fetch('../api/auth/switch-account', {
                        method: 'POST',
                        headers: getAuthHeaders(),
                        body: JSON.stringify({ user_id: userId })
                    });

                    if (response.ok) {
                        const data = await response.json();
                        if (data.success) {
                            // ÂâµÂª∫Êñ∞ÂàÜÈ†ÅÁöÑÊúÉË©±Êï∏Êìö
                            const switchData = {
                                token: data.data.token,
                                user: data.data.user,
                                switched_from_admin: {
                                    admin_token: getAuthToken(),
                                    admin_user: currentUser,
                                    switched_at: new Date().toISOString()
                                }
                            };

                            // Ê†πÊìöÁî®Êà∂ËßíËâ≤Ê±∫ÂÆöÁõÆÊ®ôÈ†ÅÈù¢
                            const userRole = data.data.user.role.toLowerCase();
                            let targetUrl;
                            let tokenKey;

                            if (userRole === 'vendor') {
                                targetUrl = '../vendor/index.html';
                                tokenKey = 'authToken_vendor';
                            } else {
                                targetUrl = '../index.html';
                                tokenKey = 'authToken_customer';
                            }

                            // Âú®Êñ∞ÂàÜÈ†Å‰∏≠Ë®≠ÁΩÆÊúÉË©±‰∏¶Ë∑≥ËΩâ
                            openUserSessionInNewTab(targetUrl, tokenKey, switchData);

                            // È°ØÁ§∫ÊàêÂäüÊ∂àÊÅØ
                            showSuccessMessage(`‚úÖ Â∑≤Âú®Êñ∞ÂàÜÈ†Å‰∏≠ÂàáÊèõÂà∞Áî®Êà∂„Äå${data.data.user.username}„Äç`);

                        } else {
                            alert('ÂàáÊèõÂ§±Êïó: ' + (data.message || 'Êú™Áü•ÈåØË™§'));
                        }
                    } else {
                        alert('ÂàáÊèõË´ãÊ±ÇÂ§±Êïó');
                    }
                } catch (error) {
                    console.error('ÂàáÊèõÁî®Êà∂Â§±Êïó:', error);
                    alert('ÂàáÊèõÁî®Êà∂Â§±Êïó');
                }
            }

            // Âú®Êñ∞ÂàÜÈ†Å‰∏≠ÈñãÂïüÁî®Êà∂ÊúÉË©±
            function openUserSessionInNewTab(targetUrl, tokenKey, switchData) {
                // ÂâµÂª∫‰∏ÄÂÄãËá®ÊôÇÁöÑÊúÉË©±ÂÇ≥ÈÅûÊ©üÂà∂
                const sessionId = 'switch_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);

                // Â¢ûÂº∑ÁöÑÂàáÊèõÊï∏ÊìöÔºåÂåÖÂê´ÊúÉË©±ÈöîÈõ¢Ë≥áË®ä
                const enhancedSwitchData = {
                    ...switchData,
                    targetTokenKey: tokenKey,
                    targetUserKey: `user_${switchData.user.role}`,
                    isolatedSession: true, // Ê®ôË®òÁÇ∫ÈöîÈõ¢ÊúÉË©±
                    originalSession: {
                        // ‰øùÂ≠òÂéüÂßãÊúÉË©±ÁöÑÂÆåÊï¥ÁãÄÊÖã
                        customer_token: localStorage.getItem('authToken_customer'),
                        customer_user: localStorage.getItem('authUser'),
                        vendor_token: localStorage.getItem('authToken_vendor'),
                        admin_token: localStorage.getItem('authToken_admin')
                    }
                };

                // Â∞áÊúÉË©±Êï∏ÊìöÊö´Â≠òÂà∞ sessionStorageÔºàË∑®ÂàÜÈ†ÅÂÖ±‰∫´Ôºâ
                sessionStorage.setItem(sessionId, JSON.stringify(enhancedSwitchData));

                // ÊßãÂª∫Â∏∂ÊúâÊúÉË©±IDÁöÑURL
                const urlWithSession = `${targetUrl}?switch_session=${sessionId}`;

                // ÈñãÂïüÊñ∞ÂàÜÈ†Å
                const newTab = window.open(urlWithSession, '_blank');

                // Ë®≠ÁΩÆÊ∏ÖÁêÜÂÆöÊôÇÂô®Ôºà30ÁßíÂæåÊ∏ÖÁêÜÊö´Â≠òÊï∏ÊìöÔºâ
                setTimeout(() => {
                    sessionStorage.removeItem(sessionId);
                }, 30000);

                if (!newTab) {
                    alert('ÁÑ°Ê≥ïÈñãÂïüÊñ∞ÂàÜÈ†ÅÔºåË´ãÊ™¢Êü•ÁÄèË¶ΩÂô®ÂΩàÁ™óË®≠ÂÆö');
                }
            }

            // È°ØÁ§∫ÊàêÂäüÊ∂àÊÅØ
            function showSuccessMessage(message) {
                const messageDiv = document.createElement('div');
                messageDiv.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: linear-gradient(135deg, #10b981, #059669);
                    color: white;
                    padding: 16px 24px;
                    border-radius: 12px;
                    box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
                    backdrop-filter: blur(10px);
                    z-index: 10000;
                    font-weight: 600;
                    animation: slideIn 0.3s ease-out;
                `;
                messageDiv.textContent = message;

                // Ê∑ªÂä†ÂãïÁï´Ê®£Âºè
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes slideIn {
                        from {
                            transform: translateX(100%);
                            opacity: 0;
                        }
                        to {
                            transform: translateX(0);
                            opacity: 1;
                        }
                    }
                `;
                document.head.appendChild(style);

                document.body.appendChild(messageDiv);

                // 3ÁßíÂæåËá™ÂãïÁßªÈô§
                setTimeout(() => {
                    messageDiv.style.animation = 'slideIn 0.3s ease-out reverse';
                    setTimeout(() => {
                        if (messageDiv.parentNode) {
                            messageDiv.parentNode.removeChild(messageDiv);
                        }
                        if (style.parentNode) {
                            style.parentNode.removeChild(style);
                        }
                    }, 300);
                }, 3000);
            }

            async function activateUser(userId) {
                if (!confirm('Á¢∫ÂÆöË¶ÅÂïüÁî®Ê≠§Áî®Êà∂ÂóéÔºü')) return;

                try {
                    const response = await fetch(`../api/users/${userId}/activate`, {
                        method: 'PUT',
                        headers: getAuthHeaders()
                    });

                    if (response.ok) {
                        const data = await response.json();
                        if (data.success) {
                            alert('Áî®Êà∂ÂïüÁî®ÊàêÂäü');
                            loadUsers(); // ÈáçÊñ∞ËºâÂÖ•ÂàóË°®
                        }
                    }
                } catch (error) {
                    console.error('ÂïüÁî®Áî®Êà∂Â§±Êïó:', error);
                    alert('ÂïüÁî®Áî®Êà∂Â§±Êïó');
                }
            }

            async function deactivateUser(userId) {
                if (!confirm('Á¢∫ÂÆöË¶ÅÂÅúÁî®Ê≠§Áî®Êà∂ÂóéÔºü')) return;

                try {
                    const response = await fetch(`../api/users/${userId}/deactivate`, {
                        method: 'PUT',
                        headers: getAuthHeaders()
                    });

                    if (response.ok) {
                        const data = await response.json();
                        if (data.success) {
                            alert('Áî®Êà∂ÂÅúÁî®ÊàêÂäü');
                            loadUsers(); // ÈáçÊñ∞ËºâÂÖ•ÂàóË°®
                        }
                    }
                } catch (error) {
                    console.error('ÂÅúÁî®Áî®Êà∂Â§±Êïó:', error);
                    alert('ÂÅúÁî®Áî®Êà∂Â§±Êïó');
                }
            }

            // Âà™Èô§Áî®Êà∂
            async function deleteUser(userId, username) {
                if (!confirm(`‚ö†Ô∏è Ë≠¶ÂëäÔºöÁ¢∫ÂÆöË¶ÅÊ∞∏‰πÖÂà™Èô§Áî®Êà∂„Äå${username}„ÄçÂóéÔºü\n\nÊ≠§Êìç‰ΩúÁÑ°Ê≥ïÂæ©ÂéüÔºåÂ∞áÊúÉÂà™Èô§Ë©≤Áî®Êà∂ÁöÑÊâÄÊúâÁõ∏ÈóúË≥áÊñô„ÄÇ`)) {
                    return;
                }

                // ‰∫åÊ¨°Á¢∫Ë™ç
                if (!confirm(`Ë´ãÂÜçÊ¨°Á¢∫Ë™çÔºöÊÇ®ÁúüÁöÑË¶ÅÂà™Èô§Áî®Êà∂„Äå${username}„ÄçÂóéÔºü`)) {
                    return;
                }

                try {
                    const response = await fetch(`../api/users/${userId}`, {
                        method: 'DELETE',
                        headers: getAuthHeaders()
                    });

                    if (response.ok) {
                        const data = await response.json();
                        if (data.success) {
                            alert('‚úÖ Áî®Êà∂Â∑≤ÊàêÂäüÂà™Èô§');
                            loadUsers(); // ÈáçÊñ∞ËºâÂÖ•ÂàóË°®
                        } else {
                            alert('‚ùå Âà™Èô§Â§±ÊïóÔºö' + (data.message || 'Êú™Áü•ÈåØË™§'));
                        }
                    } else {
                        const errorText = await response.text();
                        console.error('Âà™Èô§Áî®Êà∂Â§±Êïó:', response.status, errorText);

                        let errorMessage = 'Âà™Èô§Áî®Êà∂Â§±Êïó';
                        try {
                            const errorData = JSON.parse(errorText);
                            errorMessage = errorData.message || errorMessage;
                        } catch (e) {
                            // Â¶ÇÊûú‰∏çÊòØ JSON Ê†ºÂºèÔºå‰ΩøÁî®ÂéüÂßãÈåØË™§ÊñáÊú¨
                            if (errorText) {
                                errorMessage = errorText;
                            }
                        }

                        alert('‚ùå ' + errorMessage);
                    }
                } catch (error) {
                    console.error('Âà™Èô§Áî®Êà∂Â§±Êïó:', error);
                    alert('‚ùå Âà™Èô§Áî®Êà∂Â§±ÊïóÔºöÁ∂≤Ë∑ØÈåØË™§');
                }
            }

            // ÂÑ™ÊÉ†Âà∏Êìç‰ΩúÂáΩÊï∏
            async function viewCoupon(couponId) {
                try {
                    const response = await fetch(`../api/coupons/${couponId}`, {
                        headers: getAuthHeaders()
                    });

                    if (response.ok) {
                        const data = await response.json();
                        if (data.success) {
                            showCouponModal(data.data);
                        }
                    }
                } catch (error) {
                    console.error('ËºâÂÖ•ÂÑ™ÊÉ†Âà∏Ë©≥ÊÉÖÂ§±Êïó:', error);
                    alert('ËºâÂÖ•ÂÑ™ÊÉ†Âà∏Ë©≥ÊÉÖÂ§±Êïó');
                }
            }

            function showCouponModal(coupon) {
                const modal = document.createElement('div');
                modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.6);
                backdrop-filter: blur(4px);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1000;
                padding: 20px;
            `;

                modal.innerHTML = `
                <div style="background: white; border-radius: 20px; padding: 32px; max-width: 700px; width: 100%; max-height: 80vh; overflow-y: auto;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                        <h2 style="margin: 0; color: #1f2937;">üé´ ÂÑ™ÊÉ†Âà∏Ë©≥ÊÉÖ</h2>
                        <button type="button" class="js-close-preview" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #6b7280;">√ó</button>
                    </div>
                    
                    <div style="display: grid; gap: 16px;">
                        ${coupon.image ? `
                            <div style="text-align: center; margin-bottom: 16px;">
                                <img src="${resolveImageUrl(coupon.image)}" style="max-width: 300px; max-height: 200px; object-fit: cover; border-radius: 12px;">
                            </div>
                        ` : ''}
                        
                        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 12px; padding: 16px; background: #f9fafb; border-radius: 12px;">
                            <strong>Ê®ôÈ°å:</strong>
                            <span>${coupon.title || 'Êú™Ë®≠ÂÆö'}</span>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 12px; padding: 16px; background: #f9fafb; border-radius: 12px;">
                            <strong>Âª†ÂïÜ:</strong>
                            <span>${coupon.company_name || 'Êú™Áü•Âª†ÂïÜ'}</span>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 12px; padding: 16px; background: #f9fafb; border-radius: 12px;">
                            <strong>ÂàÜÈ°û:</strong>
                            <span>${coupon.category || 'Êú™ÂàÜÈ°û'}</span>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 12px; padding: 16px; background: #f9fafb; border-radius: 12px;">
                            <strong>ÁãÄÊÖã:</strong>
                            <span class="badge status-${coupon.status}">
                                ${coupon.status === 'pending' ? '‚è≥ ÂæÖÂØ©Ê†∏' :
                        coupon.status === 'approved' ? '‚úÖ Â∑≤Ê†∏ÂáÜ' :
                            coupon.status === 'active' ? 'üî• Â∑≤‰∏äÁ∑ö' :
                                coupon.status === 'expired' ? '‚è∞ Â∑≤ÈÅéÊúü' : '‚ùå Â∑≤ÈßÅÂõû'}
                            </span>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 12px; padding: 16px; background: #f9fafb; border-radius: 12px;">
                            <strong>ÊèèËø∞:</strong>
                            <span>${coupon.description || 'ÁÑ°ÊèèËø∞'}</span>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 12px; padding: 16px; background: #f9fafb; border-radius: 12px;">
                            <strong>‰ΩøÁî®Ë¶èÂâá:</strong>
                            <span>${coupon.usage_rules || 'ÁÑ°ÁâπÊÆäË¶èÂâá'}</span>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 12px; padding: 16px; background: #f9fafb; border-radius: 12px;">
                            <strong>Êï∏ÊìöÁµ±Ë®à:</strong>
                            <div style="display: flex; gap: 16px;">
                                <span>üëÅÔ∏è ${coupon.view_count || 0}</span>
                                <span>‚ù§Ô∏è ${coupon.favorite_count || 0}</span>
                                <span>‚úÖ ${coupon.used_count || 0}</span>
                            </div>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 12px; padding: 16px; background: #f9fafb; border-radius: 12px;">
                            <strong>Âà∞ÊúüÊôÇÈñì:</strong>
                            <span>${coupon.end_date ? new Date(coupon.end_date).toLocaleString('zh-TW') : 'ÁÑ°ÊúüÈôê'}</span>
                        </div>
                    </div>

                    <div style="display: flex; gap: 12px; justify-content: flex-end; margin-top: 24px; padding-top: 24px; border-top: 1px solid #e5e7eb;">
                        <button type="button" class="btn secondary js-close-preview">ÈóúÈñâ</button>
                        ${coupon.status === 'pending' ? `
                            <button class="btn primary" onclick="approveCoupon(${coupon.id}); this.closest('[style*=\"position: fixed\"]').remove();">‚úÖ Ê†∏ÂáÜ</button>
                            <button class="btn danger" onclick="rejectCoupon(${coupon.id}); this.closest('[style*=\"position: fixed\"]').remove();">‚ùå ÈßÅÂõû</button>
                        ` : ''}
                    </div>
                </div>
            `;

                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.remove();
                    }
                });

                document.body.appendChild(modal);

                // Á∂ÅÂÆöÈóúÈñâ‰∫ã‰ª∂ÔºàÈÅøÂÖç inline JS ÈÄ†ÊàêËß£ÊûêÂïèÈ°åÔºâ
                const bindClose = () => { try { modal.remove(); } catch (e) { /* ignore */ } };
                modal.querySelectorAll('.js-close-preview').forEach(btn => {
                    btn.addEventListener('click', bindClose);
                });
                // Esc ÈóúÈñâ
                const onKey = (ev) => { if (ev.key === 'Escape') { bindClose(); document.removeEventListener('keydown', onKey); } };
                document.addEventListener('keydown', onKey);
            }

            // Á∑®ËºØÂÑ™ÊÉ†Âà∏
            async function editCoupon(couponId) {
                try {
                    const response = await fetch(`../api/coupons/${couponId}`, {
                        headers: getAuthHeaders()
                    });

                    if (response.ok) {
                        const data = await response.json();
                        if (data.success) {
                            showEditCouponModal(data.data);
                        }
                    }
                } catch (error) {
                    console.error('ËºâÂÖ•ÂÑ™ÊÉ†Âà∏Ë≥áÊñôÂ§±Êïó:', error);
                    alert('ËºâÂÖ•ÂÑ™ÊÉ†Âà∏Ë≥áÊñôÂ§±Êïó');
                }
            }

            function showEditCouponModal(coupon) {
                const modal = document.createElement('div');
                modal.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: rgba(0, 0, 0, 0.6);
                    backdrop-filter: blur(4px);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 10000;
                `;

                modal.innerHTML = `
                    <div style="background: white; border-radius: 16px; width: 90%; max-width: 600px; max-height: 80vh; overflow-y: auto; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);">
                        <div style="padding: 24px; border-bottom: 1px solid #e5e7eb;">
                            <h3 style="margin: 0; color: #1f2937; font-size: 20px;">‚úèÔ∏è Á∑®ËºØÂÑ™ÊÉ†Âà∏</h3>
                        </div>
                        
                        <form id="editCouponForm" style="padding: 24px;">
                            <div style="display: grid; gap: 16px;">
                                <div>
                                    <label style="display: block; margin-bottom: 6px; font-weight: 600; color: #374151;">ÂÑ™ÊÉ†Âà∏Ê®ôÈ°å</label>
                                    <input type="text" id="editTitle" value="${coupon.title || ''}" style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 8px;" required>
                                </div>
                                
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                    <div>
                                        <label style="display: block; margin-bottom: 6px; font-weight: 600; color: #374151;">ÂàÜÈ°û</label>
                                        <select id="editCategory" style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 8px;">
                                            <option value="ÁæéÈ£üÈ§êÈ£≤" ${coupon.category === 'ÁæéÈ£üÈ§êÈ£≤' ? 'selected' : ''}>ÁæéÈ£üÈ§êÈ£≤</option>
                                            <option value="Ë≥ºÁâ©ÂïÜÂüé" ${coupon.category === 'Ë≥ºÁâ©ÂïÜÂüé' ? 'selected' : ''}>Ë≥ºÁâ©ÂïÜÂüé</option>
                                            <option value="ÁæéÂÆπ‰øùÈ§ä" ${coupon.category === 'ÁæéÂÆπ‰øùÈ§ä' ? 'selected' : ''}>ÁæéÂÆπ‰øùÈ§ä</option>
                                            <option value="‰ºëÈñíÂ®õÊ®Ç" ${coupon.category === '‰ºëÈñíÂ®õÊ®Ç' ? 'selected' : ''}>‰ºëÈñíÂ®õÊ®Ç</option>
                                            <option value="ÁîüÊ¥ªÊúçÂãô" ${coupon.category === 'ÁîüÊ¥ªÊúçÂãô' ? 'selected' : ''}>ÁîüÊ¥ªÊúçÂãô</option>
                                            <option value="3CÈõªÂ≠ê" ${coupon.category === '3CÈõªÂ≠ê' ? 'selected' : ''}>3CÈõªÂ≠ê</option>
                                        </select>
                                    </div>
                                    
                                    <div>
                                        <label style="display: block; margin-bottom: 6px; font-weight: 600; color: #374151;">ÁãÄÊÖã</label>
                                        <select id="editStatus" style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 8px;">
                                            <option value="pending" ${coupon.status === 'pending' ? 'selected' : ''}>ÂæÖÂØ©Ê†∏</option>
                                            <option value="approved" ${coupon.status === 'approved' ? 'selected' : ''}>Â∑≤Ê†∏ÂáÜ</option>
                                            <option value="active" ${coupon.status === 'active' ? 'selected' : ''}>‰∏äÁ∑ö‰∏≠</option>
                                            <option value="expired" ${coupon.status === 'expired' ? 'selected' : ''}>Â∑≤ÈÅéÊúü</option>
                                            <option value="rejected" ${coupon.status === 'rejected' ? 'selected' : ''}>Â∑≤ÈßÅÂõû</option>
                                        </select>
                                    </div>
                                </div>

                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                    <div>
                                        <label style="display: block; margin-bottom: 6px; font-weight: 600; color: #374151;">ÂÑ™ÊÉ†È°ûÂûã</label>
                                        <select id="editDiscountType" style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 8px;">
                                            <option value="percentage" ${coupon.discount_type === 'percentage' ? 'selected' : ''}>ÁôæÂàÜÊØîÊäòÊâ£</option>
                                            <option value="fixed" ${coupon.discount_type === 'fixed' ? 'selected' : ''}>Âõ∫ÂÆöÈáëÈ°ç</option>
                                            <option value="bogo" ${coupon.discount_type === 'bogo' ? 'selected' : ''}>Ë≤∑‰∏ÄÈÄÅ‰∏Ä</option>
                                            <option value="free" ${coupon.discount_type === 'free' ? 'selected' : ''}>ÂÖçË≤ª</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="display: block; margin-bottom: 6px; font-weight: 600; color: #374151;">ÂÑ™ÊÉ†ÂÄº</label>
                                        <input type="number" id="editDiscountValue" step="0.01" value="${(coupon.discount_value ?? '')}" placeholder="‰æùÈ°ûÂûãÂ°´ÁôæÂàÜÊØîÊàñÈáëÈ°çÔºåË≤∑‰∏ÄÈÄÅ‰∏Ä/ÂÖçË≤ªÂèØÁïôÁ©∫Êàñ 0" style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 8px;" />
                                    </div>
                                </div>
                                
                                <div>
                                    <label style="display: block; margin-bottom: 6px; font-weight: 600; color: #374151;">ÊèèËø∞</label>
                                    <textarea id="editDescription" style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 8px; min-height: 80px;" placeholder="ÂÑ™ÊÉ†Âà∏ÊèèËø∞...">${coupon.description || ''}</textarea>
                                </div>
                                
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                    <div>
                                        <label style="display: block; margin-bottom: 6px; font-weight: 600; color: #374151;">ÈñãÂßãÊó•Êúü</label>
                                        <input type="date" id="editStartDate" value="${coupon.start_date || ''}" style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 8px;">
                                    </div>
                                    
                                    <div>
                                        <label style="display: block; margin-bottom: 6px; font-weight: 600; color: #374151;">ÁµêÊùüÊó•Êúü</label>
                                        <input type="date" id="editEndDate" value="${coupon.end_date || ''}" style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 8px;">
                                    </div>
                                </div>
                            </div>
                            
                            <div style="display: flex; gap: 12px; justify-content: flex-end; margin-top: 24px; padding-top: 24px; border-top: 1px solid #e5e7eb;">
                                <button type="button" class="btn secondary" onclick="this.closest('[style*=\"position: fixed\"]').remove()">ÂèñÊ∂à</button>
                                <button type="submit" class="btn primary">üíæ ÂÑ≤Â≠òËÆäÊõ¥</button>
                            </div>
                        </form>
                    </div>
                `;

                // Ë°®ÂñÆÊèê‰∫§ËôïÁêÜ
                modal.querySelector('#editCouponForm').addEventListener('submit', async (e) => {
                    e.preventDefault();

                    const formData = {
                        title: document.getElementById('editTitle').value,
                        category: document.getElementById('editCategory').value,
                        status: document.getElementById('editStatus').value,
                        description: document.getElementById('editDescription').value,
                        start_date: document.getElementById('editStartDate').value,
                        end_date: document.getElementById('editEndDate').value,
                        discount_type: document.getElementById('editDiscountType').value,
                        discount_value: document.getElementById('editDiscountValue').value
                    };

                    try {
                        const response = await fetch(`../api/coupons/${coupon.id}`, {
                            method: 'PUT',
                            headers: {
                                ...getAuthHeaders(),
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(formData)
                        });

                        const data = await response.json().catch(() => ({}));
                        if (response.ok && data && data.success) {
                            alert('‚úÖ ÂÑ™ÊÉ†Âà∏Êõ¥Êñ∞ÊàêÂäüÔºÅ');
                            modal.remove();
                            loadCoupons();
                        } else {
                            const msg = (data && data.message) ? data.message : ('HTTP ' + response.status);
                            const details = (data && data.details) ? ('\n' + JSON.stringify(data.details)) : '';
                            alert('‚ùå Êõ¥Êñ∞Â§±ÊïóÔºö' + msg + details);
                        }
                    } catch (error) {
                        console.error('Êõ¥Êñ∞ÂÑ™ÊÉ†Âà∏Â§±Êïó:', error);
                        alert('‚ùå Êõ¥Êñ∞Â§±ÊïóÔºöÁ∂≤Ë∑ØÈåØË™§');
                    }
                });

                // ÈªûÊìäÂ§ñÈÉ®ÈóúÈñâ
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.remove();
                    }
                });

                document.body.appendChild(modal);
            }

            // Âà™Èô§ÂÑ™ÊÉ†Âà∏
            async function deleteCoupon(couponId) {
                if (!confirm('‚ö†Ô∏è Ë≠¶ÂëäÔºöÁ¢∫ÂÆöË¶ÅÂà™Èô§Ê≠§ÂÑ™ÊÉ†Âà∏ÂóéÔºü\n\nÊ≠§Êìç‰ΩúÁÑ°Ê≥ïÂæ©ÂéüÔºÅ')) {
                    return;
                }

                try {
                    const response = await fetch(`../api/coupons/${couponId}`, {
                        method: 'DELETE',
                        headers: getAuthHeaders()
                    });

                    if (response.ok) {
                        const data = await response.json();
                        if (data.success) {
                            alert('‚úÖ ÂÑ™ÊÉ†Âà∏Â∑≤ÊàêÂäüÂà™Èô§');
                            loadCoupons(); // ÈáçÊñ∞ËºâÂÖ•ÂàóË°®
                        } else {
                            alert('‚ùå Âà™Èô§Â§±ÊïóÔºö' + (data.message || 'Êú™Áü•ÈåØË™§'));
                        }
                    } else {
                        alert('‚ùå Âà™Èô§Â§±ÊïóÔºöHTTP ' + response.status);
                    }
                } catch (error) {
                    console.error('Âà™Èô§ÂÑ™ÊÉ†Âà∏Â§±Êïó:', error);
                    alert('‚ùå Âà™Èô§Â§±ÊïóÔºöÁ∂≤Ë∑ØÈåØË™§');
                }
            }

            async function approveCoupon(couponId) {
                if (!confirm('Á¢∫ÂÆöË¶ÅÊ†∏ÂáÜÊ≠§ÂÑ™ÊÉ†Âà∏ÂóéÔºü')) return;

                try {
                    const response = await fetch(`../api/coupons/${couponId}/status`, {
                        method: 'PUT',
                        headers: getAuthHeaders(),
                        body: JSON.stringify({ status: 'approved' })
                    });

                    if (response.ok) {
                        const data = await response.json();
                        if (data.success) {
                            alert('ÂÑ™ÊÉ†Âà∏Ê†∏ÂáÜÊàêÂäü');
                            loadCoupons(); // ÈáçÊñ∞ËºâÂÖ•ÂàóË°®
                        }
                    }
                } catch (error) {
                    console.error('Ê†∏ÂáÜÂÑ™ÊÉ†Âà∏Â§±Êïó:', error);
                    alert('Ê†∏ÂáÜÂÑ™ÊÉ†Âà∏Â§±Êïó');
                }
            }

            async function rejectCoupon(couponId) {
                const reason = prompt('Ë´ãËº∏ÂÖ•ÈßÅÂõûÂéüÂõ†:');
                if (!reason) return;

                try {
                    const response = await fetch(`../api/coupons/${couponId}/status`, {
                        method: 'PUT',
                        headers: getAuthHeaders(),
                        body: JSON.stringify({ status: 'rejected' })
                    });

                    if (response.ok) {
                        // Ê∑ªÂä†ÂÇôË®ª
                        await fetch(`../api/coupons/${couponId}/note`, {
                            method: 'PUT',
                            headers: getAuthHeaders(),
                            body: JSON.stringify({ note: `ÈßÅÂõûÂéüÂõ†: ${reason}` })
                        });

                        alert('ÂÑ™ÊÉ†Âà∏ÈßÅÂõûÊàêÂäü');
                        loadCoupons(); // ÈáçÊñ∞ËºâÂÖ•ÂàóË°®
                    }
                } catch (error) {
                    console.error('ÈßÅÂõûÂÑ™ÊÉ†Âà∏Â§±Êïó:', error);
                    alert('ÈßÅÂõûÂÑ™ÊÉ†Âà∏Â§±Êïó');
                }
            }

            // ËºâÂÖ•Âª†ÂïÜÂàóË°®
            async function loadVendors() {
                console.log('=== ÈñãÂßãËºâÂÖ•Âª†ÂïÜÊï∏Êìö ===');
                try {
                    const response = await fetch('../api/vendors', {
                        headers: getAuthHeaders()
                    });

                    console.log('Âª†ÂïÜ API ÂõûÊáâÁãÄÊÖã:', response.status);

                    if (response.ok) {
                        const data = await response.json();
                        console.log('Âª†ÂïÜ API Êï∏Êìö:', data);
                        if (data.success) {
                            vendors = data.data.items || [];
                            console.log('Ëß£ÊûêÁöÑÂª†ÂïÜÊï∏Êìö:', vendors);
                            renderVendors(vendors);
                            return;
                        }
                    } else {
                        console.log('API ÂõûÊáâ‰∏çÊàêÂäüÔºåÁãÄÊÖã:', response.status);
                    }
                } catch (error) {
                    console.error('ËºâÂÖ•Âª†ÂïÜÂ§±Êïó:', error);
                }

                // Â¶ÇÊûúAPIÂ§±ÊïóÔºåÈ°ØÁ§∫ÁÑ°Ë≥áÊñô
                console.log('È°ØÁ§∫ÁÑ°Âª†ÂïÜË≥áÊñô');
                vendors = [];
                renderVendors(vendors);
            }

            // Ê∏≤ÊüìÂª†ÂïÜË°®Ê†º
            function renderVendors(vendorList) {
                console.log('=== ÈñãÂßãÊ∏≤ÊüìÂª†ÂïÜË°®Ê†º ===');
                console.log('vendorList:', vendorList);

                const tbody = document.getElementById('vendorsTable');
                console.log('tbody ÂÖÉÁ¥†:', tbody);

                if (!tbody) {
                    console.error('Êâæ‰∏çÂà∞ vendorsTable ÂÖÉÁ¥†ÔºÅ');
                    return;
                }

                if (!vendorList || vendorList.length === 0) {
                    console.log('Âª†ÂïÜÂàóË°®ÁÇ∫Á©∫ÔºåÈ°ØÁ§∫ÁÑ°Ë≥áÊñôË®äÊÅØ');
                    tbody.innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 40px;">
                            <div style="color: #6b7280;">Êö´ÁÑ°Âª†ÂïÜË≥áÊñô</div>
                        </td>
                    </tr>
                `;
                    return;
                }

                console.log('ÈñãÂßãÊ∏≤Êüì', vendorList.length, 'ÂÄãÂª†ÂïÜ');

                tbody.innerHTML = vendorList.map((vendor, index) => `
                <tr>
                    <td style="font-weight: 600; font-size: 14px; text-align: center;">${vendor.id || (index + 1)}</td>
                    <td>
                        <div style="font-weight: 600; margin-bottom: 4px; font-size: 15px; color: #1f2937; line-height: 1.4;">
                            ${vendor.company_name || 'Êú™Ë®≠ÂÆöÂÖ¨Âè∏ÂêçÁ®±'}
                        </div>
                        <div style="font-size: 12px; color: #6b7280;">
                            Áµ±Á∑®: ${vendor.tax_id || 'Êú™Ë®≠ÂÆö'}
                        </div>
                    </td>
                    <td style="font-size: 14px; font-weight: 600; color: #374151;">${vendor.contact_person || 'Êú™Ë®≠ÂÆöËÅØÁµ°‰∫∫'}</td>
                    <td style="font-size: 13px; color: #6b7280; line-height: 1.5;">
                        <div style="margin-bottom: 2px;">üìß ${vendor.email || 'Êú™Ë®≠ÂÆö'}</div>
                        <div>üì± ${vendor.phone || 'Êú™Ë®≠ÂÆö'}</div>
                    </td>
                    <td style="text-align: center;">
                        <span style="padding: 6px 12px; border-radius: 16px; font-size: 12px; font-weight: 600; white-space: nowrap; ${vendor.verification_status === 'pending' ? 'background: #fef3c7; color: #d97706;' :
                        vendor.verification_status === 'approved' ? 'background: #d1fae5; color: #059669;' : 'background: #fecaca; color: #dc2626;'
                    }">
                        ${vendor.verification_status === 'pending' ? 'ÂæÖÂØ©Ê†∏' :
                        vendor.verification_status === 'approved' ? 'Â∑≤Ê†∏ÂáÜ' : 'Â∑≤ÈßÅÂõû'}
                        </span>
                    </td>
                    <td style="text-align: center; font-weight: 700; color: #f97316; font-size: 16px;">${vendor.coupon_count || 0}</td>
                    <td style="font-size: 13px; color: #6b7280; text-align: center;">
                        ${vendor.created_at ? new Date(vendor.created_at).toLocaleDateString('zh-TW') : 'Êú™Áü•'}
                    </td>
                    <td>
                        <div style="display: flex; gap: 6px; justify-content: center; flex-wrap: wrap;">
                            <button class="btn" onclick="viewVendor(${vendor.id || index})" style="padding: 6px 10px; font-size: 12px; background: #f8fafc; color: #374151; border: 1px solid #e5e7eb; border-radius: 6px;">
                                üëÅÔ∏è
                            </button>
                            <button class="btn" onclick="editVendor(${vendor.id || index})" style="padding: 6px 10px; font-size: 12px; background: #fbbf24; color: white; border-radius: 6px;">
                                ‚úèÔ∏è
                            </button>
                            <button class="btn" onclick="switchToUser(${vendor.user_id || vendor.id})" style="padding: 6px 10px; font-size: 12px; background: #10b981; color: white; border-radius: 6px;">
                                üîÑ
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
            }

            // Âª†ÂïÜÊìç‰ΩúÂáΩÊï∏
            async function viewVendor(vendorId) {
                try {
                    const response = await fetch(`../api/vendors/${vendorId}`, {
                        headers: getAuthHeaders()
                    });

                    if (response.ok) {
                        const data = await response.json();
                        if (data.success) {
                            showVendorModal(data.data);
                        }
                    }
                } catch (error) {
                    console.error('ËºâÂÖ•Âª†ÂïÜË©≥ÊÉÖÂ§±Êïó:', error);
                    alert('ËºâÂÖ•Âª†ÂïÜË©≥ÊÉÖÂ§±Êïó');
                }
            }

            function showVendorModal(vendor) {
                const modal = document.createElement('div');
                modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.6);
                backdrop-filter: blur(4px);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1000;
                padding: 20px;
            `;

                modal.innerHTML = `
                <div style="background: white; border-radius: 20px; padding: 32px; max-width: 800px; width: 100%; max-height: 80vh; overflow-y: auto;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                        <h2 style="margin: 0; color: #1f2937;">üè™ Âª†ÂïÜË©≥ÊÉÖ</h2>
                        <button onclick="this.closest('[style*=\"position: fixed\"]').remove()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #6b7280;">√ó</button>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                        <!-- Âü∫Êú¨Ë≥áË®ä -->
                        <div>
                            <h3 style="margin-bottom: 16px; color: #374151; border-bottom: 2px solid #FCA311; padding-bottom: 8px;">Âü∫Êú¨Ë≥áË®ä</h3>
                            <div style="display: grid; gap: 12px;">
                                <div style="padding: 12px; background: #f9fafb; border-radius: 8px;">
                                    <strong>ÂÖ¨Âè∏ÂêçÁ®±:</strong><br>
                                    <span>${vendor.company_name || 'Êú™Ë®≠ÂÆö'}</span>
                                </div>
                                <div style="padding: 12px; background: #f9fafb; border-radius: 8px;">
                                    <strong>ËÅØÁµ°‰∫∫:</strong><br>
                                    <span>${vendor.contact_person || 'Êú™Ë®≠ÂÆö'}</span>
                                </div>
                                <div style="padding: 12px; background: #f9fafb; border-radius: 8px;">
                                    <strong>Áµ±‰∏ÄÁ∑®Ëôü:</strong><br>
                                    <span>${vendor.tax_id || 'Êú™Ë®≠ÂÆö'}</span>
                                </div>
                                <div style="padding: 12px; background: #f9fafb; border-radius: 8px;">
                                    <strong>ÁáüÊ•≠Âü∑ÁÖß:</strong><br>
                                    <span>${vendor.business_license || 'Êú™Êèê‰æõ'}</span>
                                </div>
                            </div>
                        </div>

                        <!-- ËÅØÁµ°Ë≥áË®ä -->
                        <div>
                            <h3 style="margin-bottom: 16px; color: #374151; border-bottom: 2px solid #FCA311; padding-bottom: 8px;">ËÅØÁµ°Ë≥áË®ä</h3>
                            <div style="display: grid; gap: 12px;">
                                <div style="padding: 12px; background: #f9fafb; border-radius: 8px;">
                                    <strong>ÈõªÂ≠êÈÉµÁÆ±:</strong><br>
                                    <span>${vendor.email || 'Êú™Ë®≠ÂÆö'}</span>
                                </div>
                                <div style="padding: 12px; background: #f9fafb; border-radius: 8px;">
                                    <strong>ËÅØÁµ°ÈõªË©±:</strong><br>
                                    <span>${vendor.phone || 'Êú™Ë®≠ÂÆö'}</span>
                                </div>
                                <div style="padding: 12px; background: #f9fafb; border-radius: 8px;">
                                    <strong>ÂÖ¨Âè∏Âú∞ÂùÄ:</strong><br>
                                    <span>${vendor.address || 'Êú™Ë®≠ÂÆö'}</span>
                                </div>
                                <div style="padding: 12px; background: #f9fafb; border-radius: 8px;">
                                    <strong>ÂÖ¨Âè∏ÊèèËø∞:</strong><br>
                                    <span style="font-size: 14px;">${vendor.description || 'Êú™Êèê‰æõ'}</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ÁãÄÊÖãÂíåÁµ±Ë®à -->
                    <div style="margin-top: 24px; padding: 20px; background: linear-gradient(135deg, rgba(252, 163, 17, 0.1), rgba(248, 247, 246, 0.8)); border-radius: 12px;">
                        <h3 style="margin-bottom: 16px; color: #374151;">ÁãÄÊÖãËàáÁµ±Ë®à</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 16px;">
                            <div style="text-align: center; padding: 16px; background: white; border-radius: 8px;">
                                <div style="font-size: 24px; margin-bottom: 4px;">
                                    <span class="badge status-${vendor.verification_status}">
                                        ${vendor.verification_status === 'pending' ? '‚è≥ ÂæÖÂØ©Ê†∏' :
                        vendor.verification_status === 'approved' ? '‚úÖ Â∑≤Ê†∏ÂáÜ' : '‚ùå Â∑≤ÈßÅÂõû'}
                                    </span>
                                </div>
                                <div style="font-size: 12px; color: #6b7280;">ÂØ©Ê†∏ÁãÄÊÖã</div>
                            </div>
                            <div style="text-align: center; padding: 16px; background: white; border-radius: 8px;">
                                <div style="font-size: 24px; font-weight: bold; color: #FCA311; margin-bottom: 4px;">
                                    ${vendor.coupon_count || 0}
                                </div>
                                <div style="font-size: 12px; color: #6b7280;">ÂÑ™ÊÉ†Âà∏Êï∏Èáè</div>
                            </div>
                            <div style="text-align: center; padding: 16px; background: white; border-radius: 8px;">
                                <div style="font-size: 24px; margin-bottom: 4px;">
                                    ${vendor.user_status === 'active' ? 'üü¢' : 'üî¥'}
                                </div>
                                <div style="font-size: 12px; color: #6b7280;">Â∏≥ËôüÁãÄÊÖã</div>
                            </div>
                            <div style="text-align: center; padding: 16px; background: white; border-radius: 8px;">
                                <div style="font-size: 14px; font-weight: bold; color: #6b7280; margin-bottom: 4px;">
                                    ${vendor.created_at ? new Date(vendor.created_at).toLocaleDateString('zh-TW') : 'Êú™Áü•'}
                                </div>
                                <div style="font-size: 12px; color: #6b7280;">Áî≥Ë´ãÊó•Êúü</div>
                            </div>
                        </div>
                    </div>

                    <div style="display: flex; gap: 12px; justify-content: flex-end; margin-top: 24px; padding-top: 24px; border-top: 1px solid #e5e7eb;">
                        <button class="btn secondary" onclick="this.closest('[style*=\"position: fixed\"]').remove()">ÈóúÈñâ</button>
                        ${vendor.verification_status === 'pending' ? `
                            <button class="btn primary" onclick="approveVendor(${vendor.id}); this.closest('[style*=\"position: fixed\"]').remove();">‚úÖ Ê†∏ÂáÜÂª†ÂïÜ</button>
                            <button class="btn danger" onclick="rejectVendor(${vendor.id}); this.closest('[style*=\"position: fixed\"]').remove();">‚ùå ÈßÅÂõûÁî≥Ë´ã</button>
                        ` : ''}
                        ${vendor.user_id ? `
                            <button class="btn primary" onclick="switchToUser(${vendor.user_id}); this.closest('[style*=\"position: fixed\"]').remove();">üîÑ ÂàáÊèõÂà∞Ê≠§Âª†ÂïÜ</button>
                        ` : ''}
                    </div>
                </div>
            `;

                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.remove();
                    }
                });

                document.body.appendChild(modal);
            }

            // Á∑®ËºØÂª†ÂïÜ
            async function editVendor(vendorId) {
                try {
                    const response = await fetch(`../api/vendors/${vendorId}`, {
                        headers: getAuthHeaders()
                    });

                    if (response.ok) {
                        const data = await response.json();
                        if (data.success) {
                            showEditVendorModal(data.data);
                        }
                    }
                } catch (error) {
                    console.error('ËºâÂÖ•Âª†ÂïÜË≥áÊñôÂ§±Êïó:', error);
                    alert('ËºâÂÖ•Âª†ÂïÜË≥áÊñôÂ§±Êïó');
                }
            }

            function showEditVendorModal(vendor) {
                const modal = document.createElement('div');
                modal.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: rgba(0, 0, 0, 0.6);
                    backdrop-filter: blur(4px);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 10000;
                `;

                modal.innerHTML = `
                    <div style="background: white; border-radius: 16px; width: 90%; max-width: 600px; max-height: 80vh; overflow-y: auto; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);">
                        <div style="padding: 24px; border-bottom: 1px solid #e5e7eb;">
                            <h3 style="margin: 0; color: #1f2937; font-size: 20px;">‚úèÔ∏è Á∑®ËºØÂª†ÂïÜË≥áÊñô</h3>
                        </div>
                        
                        <form id="editVendorForm" style="padding: 24px;">
                            <div style="display: grid; gap: 16px;">
                                <div>
                                    <label style="display: block; margin-bottom: 6px; font-weight: 600; color: #374151;">ÂÖ¨Âè∏ÂêçÁ®±</label>
                                    <input type="text" id="editCompanyName" value="${vendor.company_name || ''}" style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 8px;" required>
                                </div>
                                
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                    <div>
                                        <label style="display: block; margin-bottom: 6px; font-weight: 600; color: #374151;">ËÅØÁµ°‰∫∫</label>
                                        <input type="text" id="editContactPerson" value="${vendor.contact_person || ''}" style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 8px;">
                                    </div>
                                    
                                    <div>
                                        <label style="display: block; margin-bottom: 6px; font-weight: 600; color: #374151;">ÂØ©Ê†∏ÁãÄÊÖã</label>
                                        <select id="editVerificationStatus" style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 8px;">
                                            <option value="pending" ${vendor.verification_status === 'pending' ? 'selected' : ''}>ÂæÖÂØ©Ê†∏</option>
                                            <option value="approved" ${vendor.verification_status === 'approved' ? 'selected' : ''}>Â∑≤Ê†∏ÂáÜ</option>
                                            <option value="rejected" ${vendor.verification_status === 'rejected' ? 'selected' : ''}>Â∑≤ÈßÅÂõû</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                    <div>
                                        <label style="display: block; margin-bottom: 6px; font-weight: 600; color: #374151;">ËÅØÁµ°ÈõªË©±</label>
                                        <input type="text" id="editPhone" value="${vendor.phone || ''}" style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 8px;">
                                    </div>
                                    
                                    <div>
                                        <label style="display: block; margin-bottom: 6px; font-weight: 600; color: #374151;">Áµ±‰∏ÄÁ∑®Ëôü</label>
                                        <input type="text" id="editTaxId" value="${vendor.tax_id || ''}" style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 8px;">
                                    </div>
                                </div>
                                
                                <div>
                                    <label style="display: block; margin-bottom: 6px; font-weight: 600; color: #374151;">ÂÖ¨Âè∏Âú∞ÂùÄ</label>
                                    <input type="text" id="editAddress" value="${vendor.address || ''}" style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 8px;">
                                </div>
                                
                                <div>
                                    <label style="display: block; margin-bottom: 6px; font-weight: 600; color: #374151;">ÂÖ¨Âè∏ÊèèËø∞</label>
                                    <textarea id="editDescription" style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 8px; min-height: 80px;" placeholder="ÂÖ¨Âè∏ÊèèËø∞...">${vendor.description || ''}</textarea>
                                </div>
                            </div>
                            
                            <div style="display: flex; gap: 12px; justify-content: flex-end; margin-top: 24px; padding-top: 24px; border-top: 1px solid #e5e7eb;">
                                <button type="button" class="btn secondary" onclick="this.closest('[style*=\"position: fixed\"]').remove()">ÂèñÊ∂à</button>
                                <button type="submit" class="btn primary">üíæ ÂÑ≤Â≠òËÆäÊõ¥</button>
                            </div>
                        </form>
                    </div>
                `;

                // Ë°®ÂñÆÊèê‰∫§ËôïÁêÜ
                modal.querySelector('#editVendorForm').addEventListener('submit', async (e) => {
                    e.preventDefault();

                    const formData = {
                        company_name: document.getElementById('editCompanyName').value,
                        contact_person: document.getElementById('editContactPerson').value,
                        verification_status: document.getElementById('editVerificationStatus').value,
                        phone: document.getElementById('editPhone').value,
                        tax_id: document.getElementById('editTaxId').value,
                        address: document.getElementById('editAddress').value,
                        description: document.getElementById('editDescription').value
                    };

                    try {
                        // Â¶ÇÊûúÊòØÊõ¥ÊîπÂØ©Ê†∏ÁãÄÊÖãÔºå‰ΩøÁî®Â∞àÈñÄÁöÑ API
                        if (formData.verification_status !== vendor.verification_status) {
                            const statusEndpoint = formData.verification_status === 'approved' ? 'approve' : 'reject';
                            const statusResponse = await fetch(`../api/vendors/${vendor.id}/${statusEndpoint}`, {
                                method: 'PUT',
                                headers: getAuthHeaders()
                            });

                            if (!statusResponse.ok) {
                                alert('‚ùå Êõ¥Êñ∞ÂØ©Ê†∏ÁãÄÊÖãÂ§±Êïó');
                                return;
                            }
                        }

                        // Êõ¥Êñ∞ÂÖ∂‰ªñÂª†ÂïÜË≥áÊñô (ÈÄôË£°ÈúÄË¶ÅÂæåÁ´ØÊîØÊè¥)
                        // Êö´ÊôÇÂè™È°ØÁ§∫ÊàêÂäüË®äÊÅØ
                        alert('‚úÖ Âª†ÂïÜË≥áÊñôÊõ¥Êñ∞ÊàêÂäüÔºÅ');
                        modal.remove();
                        loadVendors(); // ÈáçÊñ∞ËºâÂÖ•ÂàóË°®

                    } catch (error) {
                        console.error('Êõ¥Êñ∞Âª†ÂïÜÂ§±Êïó:', error);
                        alert('‚ùå Êõ¥Êñ∞Â§±ÊïóÔºöÁ∂≤Ë∑ØÈåØË™§');
                    }
                });

                // ÈªûÊìäÂ§ñÈÉ®ÈóúÈñâ
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.remove();
                    }
                });

                document.body.appendChild(modal);
            }

            async function approveVendor(vendorId) {
                if (!confirm('Á¢∫ÂÆöË¶ÅÊ†∏ÂáÜÊ≠§Âª†ÂïÜÂóéÔºü')) return;

                try {
                    const response = await fetch(`../api/vendors/${vendorId}/approve`, {
                        method: 'PUT',
                        headers: getAuthHeaders()
                    });

                    if (response.ok) {
                        const data = await response.json();
                        if (data.success) {
                            alert('Âª†ÂïÜÊ†∏ÂáÜÊàêÂäü');
                            loadVendors(); // ÈáçÊñ∞ËºâÂÖ•ÂàóË°®
                        }
                    }
                } catch (error) {
                    console.error('Ê†∏ÂáÜÂª†ÂïÜÂ§±Êïó:', error);
                    alert('Ê†∏ÂáÜÂª†ÂïÜÂ§±Êïó');
                }
            }

            async function rejectVendor(vendorId) {
                const reason = prompt('Ë´ãËº∏ÂÖ•ÈßÅÂõûÂéüÂõ†:');
                if (!reason) return;

                try {
                    const response = await fetch(`../api/vendors/${vendorId}/reject`, {
                        method: 'PUT',
                        headers: getAuthHeaders(),
                        body: JSON.stringify({ reason: reason })
                    });

                    if (response.ok) {
                        const data = await response.json();
                        if (data.success) {
                            alert('Âª†ÂïÜÈßÅÂõûÊàêÂäü');
                            loadVendors(); // ÈáçÊñ∞ËºâÂÖ•ÂàóË°®
                        }
                    }
                } catch (error) {
                    console.error('ÈßÅÂõûÂª†ÂïÜÂ§±Êïó:', error);
                    alert('ÈßÅÂõûÂª†ÂïÜÂ§±Êïó');
                }
            }

            // ÂàáÊèõÁõ∏ÈóúÂäüËÉΩ
            function updateSwitchUI(data) {
                const switchInfo = document.getElementById('switchInfo');
                const switchBackBtn = document.getElementById('switchBackBtn');
                const currentUser = document.getElementById('currentUser');
                const adminUser = document.getElementById('adminUser');

                if (data.is_switched) {
                    switchInfo.style.display = 'block';
                    switchBackBtn.style.display = 'inline-flex';
                    currentUser.textContent = data.user.username;
                    adminUser.textContent = data.admin_info.username;
                } else {
                    switchInfo.style.display = 'none';
                    switchBackBtn.style.display = 'none';
                }
            }

            async function switchBackToAdmin() {
                try {
                    const response = await fetch('../api/auth/switch-back', {
                        method: 'POST',
                        headers: getAuthHeaders()
                    });

                    if (response.ok) {
                        const data = await response.json();
                        if (data.success) {
                            localStorage.setItem(LS_TOKEN, data.data.token);
                            updateSwitchUI(data.data);
                            alert('Â∑≤ÂàáÊèõÂõûÁÆ°ÁêÜÂì°Â∏≥Ëôü');
                        }
                    }
                } catch (error) {
                    console.error('ÂàáÊèõÂõûÁÆ°ÁêÜÂì°Â§±Êïó:', error);
                    alert('ÂàáÊèõÂõûÁÆ°ÁêÜÂì°Â§±Êïó');
                }
            }

            // ÁôªÂá∫ÂäüËÉΩ
            function logout() {
                if (confirm('Á¢∫ÂÆöË¶ÅÁôªÂá∫ÂóéÔºü')) {
                    localStorage.removeItem(LS_TOKEN);
                    window.location.href = '../index.html';
                }
            }

            // ÊêúÁ¥¢ÂíåÁØ©ÈÅ∏ÂäüËÉΩ
            function setupFilters() {
                // Áî®Êà∂ÊêúÁ¥¢ÔºàÊîπÁÇ∫ÂëºÂè´ÂæåÁ´ØÈÅéÊøæÔºâ
                document.getElementById('userSearch').addEventListener('input', () => {
                    loadUsers();
                });

                // Áî®Êà∂ËßíËâ≤ÁØ©ÈÅ∏ÔºàÂëºÂè´ÂæåÁ´ØÔºâ
                document.getElementById('roleFilter').addEventListener('change', () => {
                    loadUsers();
                });

                // Áî®Êà∂ÁãÄÊÖãÁØ©ÈÅ∏ÔºàÂëºÂè´ÂæåÁ´ØÔºâ
                document.getElementById('statusFilter').addEventListener('change', () => {
                    loadUsers();
                });

                // ÂÑ™ÊÉ†Âà∏ÊêúÁ¥¢
                document.getElementById('couponSearch').addEventListener('input', (e) => {
                    const query = e.target.value.toLowerCase();
                    const filteredCoupons = coupons.filter(coupon =>
                        (coupon.title || '').toLowerCase().includes(query) ||
                        (coupon.description || '').toLowerCase().includes(query)
                    );
                    renderCoupons(filteredCoupons);
                });

                // ÂÑ™ÊÉ†Âà∏ÂàÜÈ°ûÁØ©ÈÅ∏
                document.getElementById('categoryFilter').addEventListener('change', (e) => {
                    const category = e.target.value;
                    const filteredCoupons = category ? coupons.filter(coupon => coupon.category === category) : coupons;
                    renderCoupons(filteredCoupons);
                });

                // ÂÑ™ÊÉ†Âà∏ÁãÄÊÖãÁØ©ÈÅ∏
                document.getElementById('couponStatusFilter').addEventListener('change', (e) => {
                    const status = e.target.value;
                    const filteredCoupons = status ? coupons.filter(coupon => coupon.status === status) : coupons;
                    renderCoupons(filteredCoupons);
                });

                // Âª†ÂïÜÊêúÁ¥¢
                document.getElementById('vendorSearch').addEventListener('input', (e) => {
                    const query = e.target.value.toLowerCase();
                    const filteredVendors = vendors.filter(vendor =>
                        (vendor.company_name || '').toLowerCase().includes(query) ||
                        (vendor.contact_person || '').toLowerCase().includes(query) ||
                        (vendor.email || '').toLowerCase().includes(query)
                    );
                    renderVendors(filteredVendors);
                });

                // Âª†ÂïÜÁãÄÊÖãÁØ©ÈÅ∏
                document.getElementById('vendorStatusFilter').addEventListener('change', (e) => {
                    const status = e.target.value;
                    const filteredVendors = status ? vendors.filter(vendor => vendor.verification_status === status) : vendors;
                    renderVendors(filteredVendors);
                });

                // Âª†ÂïÜÂàÜÈ°ûÁØ©ÈÅ∏
                document.getElementById('vendorCategoryFilter').addEventListener('change', (e) => {
                    const category = e.target.value;
                    const filteredVendors = category ? vendors.filter(vendor => vendor.category === category) : vendors;
                    renderVendors(filteredVendors);
                });
            }

            // ËºâÂÖ•Êï∏ÊìöÂàÜÊûê
            async function loadAnalytics() {
                try {
                    // ËºâÂÖ•Áµ±Ë®àÊï∏Êìö
                    const statsResponse = await fetch('../api/stats/coupons', {
                        headers: getAuthHeaders()
                    });

                    if (statsResponse.ok) {
                        const statsData = await statsResponse.json();
                        if (statsData.success) {
                            renderAnalyticsStats(statsData.data);
                            renderCharts(statsData.data);
                        }
                    }

                    // ËºâÂÖ•ÁÜ±ÈñÄÂÑ™ÊÉ†Âà∏
                    loadPopularCoupons();
                } catch (error) {
                    console.error('ËºâÂÖ•Êï∏ÊìöÂàÜÊûêÂ§±Êïó:', error);
                }
            }

            // Ê∏≤ÊüìÂàÜÊûêÁµ±Ë®à
            function renderAnalyticsStats(data) {
                const container = document.getElementById('analyticsStats');

                const totalCoupons = Object.values(data.by_status || {}).reduce((sum, count) => sum + count, 0);
                const activeCoupons = data.by_status?.active || 0;
                const pendingCoupons = data.by_status?.pending || 0;
                const popularCategories = Object.keys(data.by_category || {}).length;

                container.innerHTML = `
                <div class="stat-card">
                    <span class="stat-icon">üé´</span>
                    <div class="stat-value">${totalCoupons}</div>
                    <div class="stat-label">Á∏ΩÂÑ™ÊÉ†Âà∏Êï∏</div>
                </div>
                <div class="stat-card">
                    <span class="stat-icon">üî•</span>
                    <div class="stat-value">${activeCoupons}</div>
                    <div class="stat-label">‰∏äÁ∑ö‰∏≠</div>
                </div>
                <div class="stat-card">
                    <span class="stat-icon">‚è≥</span>
                    <div class="stat-value">${pendingCoupons}</div>
                    <div class="stat-label">ÂæÖÂØ©Ê†∏</div>
                </div>
                <div class="stat-card">
                    <span class="stat-icon">üìÇ</span>
                    <div class="stat-value">${popularCategories}</div>
                    <div class="stat-label">Ê¥ªË∫çÂàÜÈ°û</div>
                </div>
            `;
            }

            // Ê∏≤ÊüìÂúñË°®ÔºàÁ∞°ÂåñÁâàÊú¨Ôºå‰ΩøÁî® CSS ÂØ¶ÁèæÔºâ
            function renderCharts(data) {
                renderStatusChart(data.by_status || {});
                renderCategoryChart(data.by_category || {});
                renderUserTrendChart();
            }

            function renderStatusChart(statusData) {
                const ctx = document.getElementById('couponStatusChart').getContext('2d');

                const colors = {
                    'pending': '#f59e0b',
                    'approved': '#10b981',
                    'active': '#3b82f6',
                    'expired': '#6b7280',
                    'rejected': '#ef4444'
                };

                const labels = {
                    'pending': 'ÂæÖÂØ©Ê†∏',
                    'approved': 'Â∑≤Ê†∏ÂáÜ',
                    'active': '‰∏äÁ∑ö‰∏≠',
                    'expired': 'Â∑≤ÈÅéÊúü',
                    'rejected': 'Â∑≤ÈßÅÂõû'
                };

                const chartLabels = [];
                const chartData = [];
                const chartColors = [];

                for (const [status, count] of Object.entries(statusData)) {
                    if (count > 0) {
                        chartLabels.push(labels[status] || status);
                        chartData.push(count);
                        chartColors.push(colors[status] || '#6b7280');
                    }
                }

                new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: chartLabels,
                        datasets: [{
                            data: chartData,
                            backgroundColor: chartColors,
                            borderWidth: 2,
                            borderColor: '#ffffff'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 20,
                                    usePointStyle: true,
                                    font: {
                                        size: 12
                                    }
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function (context) {
                                        const total = context.dataset.data.reduce((sum, val) => sum + val, 0);
                                        const percentage = ((context.raw / total) * 100).toFixed(1);
                                        return `${context.label}: ${context.raw} (${percentage}%)`;
                                    }
                                }
                            }
                        }
                    }
                });
            }

            function renderCategoryChart(categoryData) {
                const ctx = document.getElementById('categoryChart').getContext('2d');

                const sortedCategories = Object.entries(categoryData)
                    .sort(([, a], [, b]) => b - a)
                    .slice(0, 8); // Âè™È°ØÁ§∫Ââç8ÂÄãÂàÜÈ°û

                const labels = sortedCategories.map(([category]) => category);
                const data = sortedCategories.map(([, count]) => count);

                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'ÂÑ™ÊÉ†Âà∏Êï∏Èáè',
                            data: data,
                            backgroundColor: 'rgba(252, 163, 17, 0.8)',
                            borderColor: 'rgba(252, 163, 17, 1)',
                            borderWidth: 1,
                            borderRadius: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    stepSize: 1
                                }
                            },
                            x: {
                                ticks: {
                                    maxRotation: 45
                                }
                            }
                        }
                    }
                });
            }

            async function renderUserTrendChart() {
                try {
                    // ÂèØ‰ª•ÂæûAPIÁç≤ÂèñÁúüÂØ¶Êï∏ÊìöÔºåÈÄôË£°ÂÖàÁî®Ê®°Êì¨Êï∏Êìö
                    const ctx = document.getElementById('userTrendChart').getContext('2d');

                    // ÁîüÊàêÊúÄËøë30Â§©ÁöÑÊó•ÊúüÊ®ôÁ±§
                    const labels = [];
                    const registrationData = [];

                    for (let i = 29; i >= 0; i--) {
                        const date = new Date();
                        date.setDate(date.getDate() - i);
                        labels.push((date.getMonth() + 1) + '/' + date.getDate());

                        // Ê®°Êì¨Êï∏ÊìöÔºàÂØ¶ÈöõÊáâÂæûAPIÁç≤ÂèñÔºâ
                        registrationData.push(Math.floor(Math.random() * 10) + 1);
                    }

                    new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Êñ∞Áî®Êà∂Ë®ªÂÜä',
                                data: registrationData,
                                borderColor: 'rgba(252, 163, 17, 1)',
                                backgroundColor: 'rgba(252, 163, 17, 0.1)',
                                borderWidth: 2,
                                fill: true,
                                tension: 0.4,
                                pointBackgroundColor: 'rgba(252, 163, 17, 1)',
                                pointBorderColor: '#ffffff',
                                pointBorderWidth: 2,
                                pointRadius: 4
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    display: false
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        stepSize: 1
                                    }
                                },
                                x: {
                                    ticks: {
                                        maxTicksLimit: 10
                                    }
                                }
                            }
                        }
                    });
                } catch (error) {
                    console.error('ËºâÂÖ•Áî®Êà∂Ë∂®Âã¢ÂúñË°®Â§±Êïó:', error);
                }
            }

            // ËºâÂÖ•ÁÜ±ÈñÄÂÑ™ÊÉ†Âà∏
            async function loadPopularCoupons() {
                try {
                    const response = await fetch('../api/stats/coupons', {
                        headers: getAuthHeaders()
                    });

                    if (response.ok) {
                        const data = await response.json();
                        if (data.success && data.data.popular_coupons) {
                            renderPopularCouponsTable(data.data.popular_coupons);
                        }
                    }
                } catch (error) {
                    console.error('ËºâÂÖ•ÁÜ±ÈñÄÂÑ™ÊÉ†Âà∏Â§±Êïó:', error);
                    document.getElementById('popularCouponsTable').innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; color: #ef4444;">ËºâÂÖ•Â§±Êïó</td>
                    </tr>
                `;
                }
            }

            function renderPopularCouponsTable(coupons) {
                const tbody = document.getElementById('popularCouponsTable');

                if (!coupons || coupons.length === 0) {
                    tbody.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 40px;">
                            <div style="color: #6b7280;">Êö´ÁÑ°Êï∏Êìö</div>
                        </td>
                    </tr>
                `;
                    return;
                }

                tbody.innerHTML = coupons.map((coupon, index) => {
                    const conversionRate = coupon.view_count > 0 ?
                        ((coupon.used_count / coupon.view_count) * 100).toFixed(1) : '0.0';

                    return `
                    <tr>
                        <td style="text-align: center;">
                            <div style="width: 30px; height: 30px; border-radius: 50%; background: linear-gradient(135deg, #FCA311, #f59e0b); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; margin: 0 auto;">
                                ${index + 1}
                            </div>
                        </td>
                        <td>
                            <div style="font-weight: 600; margin-bottom: 4px;">${coupon.title}</div>
                            <div style="font-size: 12px; color: #6b7280;">ID: ${coupon.id}</div>
                        </td>
                        <td style="font-size: 14px;">${coupon.company_name || 'Êú™Áü•Âª†ÂïÜ'}</td>
                        <td style="text-align: center; font-weight: 600; color: #3b82f6;">${coupon.view_count || 0}</td>
                        <td style="text-align: center; font-weight: 600; color: #ef4444;">${coupon.favorite_count || 0}</td>
                        <td style="text-align: center; font-weight: 600; color: #10b981;">${coupon.used_count || 0}</td>
                        <td style="text-align: center; font-weight: 600; color: #f59e0b;">${conversionRate}%</td>
                    </tr>
                `;
                }).join('');
            }

            // ËºâÂÖ•Á≥ªÁµ±Ë≥áË®ä
            async function loadSystemInfo() {
                // Êõ¥Êñ∞ÈÅãË°åÊôÇÈñì
                updateUptime();

                // ËºâÂÖ•Êìç‰ΩúÊó•Ë™å
                loadSystemLogs();
            }

            function updateUptime() {
                const uptimeElement = document.getElementById('uptime');
                const startTime = new Date().getTime() - (Math.random() * 86400000 * 7); // Ê®°Êì¨ÈÅãË°åÊôÇÈñì
                const uptime = new Date().getTime() - startTime;
                const days = Math.floor(uptime / (1000 * 60 * 60 * 24));
                const hours = Math.floor((uptime % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));

                uptimeElement.textContent = `ÈÅãË°åÊôÇÈñì: ${days}Â§© ${hours}Â∞èÊôÇ`;
            }

            function loadSystemLogs() {
                const tbody = document.getElementById('systemLogsTable');

                // Ê®°Êì¨Êìç‰ΩúÊó•Ë™åÊï∏Êìö
                const logs = [
                    {
                        time: '2024-01-15 14:30:25',
                        operator: 'ÁÆ°ÁêÜÂì°',
                        type: 'Áî®Êà∂ÁÆ°ÁêÜ',
                        content: 'ÂïüÁî®Áî®Êà∂ "ÂºµÂ∞èÊòé"',
                        ip: '192.168.1.100'
                    },
                    {
                        time: '2024-01-15 14:25:18',
                        operator: 'ÁÆ°ÁêÜÂì°',
                        type: 'ÂÑ™ÊÉ†Âà∏ÂØ©Ê†∏',
                        content: 'Ê†∏ÂáÜÂÑ™ÊÉ†Âà∏ "ÈôêÊôÇÁâπÂÉπÂÑ™ÊÉ†"',
                        ip: '192.168.1.100'
                    },
                    {
                        time: '2024-01-15 14:20:45',
                        operator: 'ÁÆ°ÁêÜÂì°',
                        type: 'Âª†ÂïÜÁÆ°ÁêÜ',
                        content: 'Ê†∏ÂáÜÂª†ÂïÜÁî≥Ë´ã "ÁæéÈ£üÂ§©Â†Ç"',
                        ip: '192.168.1.100'
                    },
                    {
                        time: '2024-01-15 14:15:32',
                        operator: 'Á≥ªÁµ±',
                        type: 'Á≥ªÁµ±Á∂≠Ë≠∑',
                        content: 'Ëá™ÂãïÊ∏ÖÁêÜÈÅéÊúüÂÑ™ÊÉ†Âà∏',
                        ip: 'localhost'
                    },
                    {
                        time: '2024-01-15 14:10:15',
                        operator: 'ÁÆ°ÁêÜÂì°',
                        type: 'Á≥ªÁµ±Ë®≠ÂÆö',
                        content: 'Êõ¥Êñ∞Á∂≤Á´ôË®≠ÂÆö',
                        ip: '192.168.1.100'
                    }
                ];

                tbody.innerHTML = logs.map(log => `
                <tr>
                    <td style="font-size: 12px; color: #6b7280;">${log.time}</td>
                    <td>
                        <span style="padding: 4px 8px; background: rgba(252, 163, 17, 0.1); color: #92400e; border-radius: 6px; font-size: 12px;">
                            ${log.operator}
                        </span>
                    </td>
                    <td style="font-size: 14px;">${log.type}</td>
                    <td style="font-size: 14px;">${log.content}</td>
                    <td style="font-size: 12px; color: #6b7280;">${log.ip}</td>
                </tr>
            `).join('');
            }

            // Á≥ªÁµ±Ë®≠ÂÆöÂäüËÉΩ
            function saveSystemSettings() {
                const settings = {
                    siteName: document.getElementById('siteName').value,
                    siteDescription: document.getElementById('siteDescription').value,
                    contactEmail: document.getElementById('contactEmail').value,
                    userRegistration: document.getElementById('userRegistration').value,
                    vendorApplication: document.getElementById('vendorApplication').value,
                    couponReview: document.getElementById('couponReview').value
                };

                // ÈÄôË£°ÊáâË©≤ÁôºÈÄÅÂà∞ÂæåÁ´Ø API
                console.log('ÂÑ≤Â≠òË®≠ÂÆö:', settings);
                alert('Ë®≠ÂÆöÂÑ≤Â≠òÊàêÂäüÔºÅ');
            }

            function resetSystemSettings() {
                if (confirm('Á¢∫ÂÆöË¶ÅÈáçÁΩÆÊâÄÊúâË®≠ÂÆöÂà∞È†êË®≠ÂÄºÂóéÔºü')) {
                    document.getElementById('siteName').value = 'ÈÄÅÈΩÅÂ∫∑ÂÑ™ÊÉ†Âà∏Âπ≥Âè∞';
                    document.getElementById('siteDescription').value = 'ÊúÄÂ•ΩÁöÑÂÑ™ÊÉ†Âà∏Âπ≥Âè∞ÔºåÁÇ∫ÊÇ®Êèê‰æõÊúÄÂÑ™Ë≥™ÁöÑÊäòÊâ£Ë≥áË®ä';
                    document.getElementById('contactEmail').value = 'admin@songhokang.com';
                    document.getElementById('userRegistration').value = 'open';
                    document.getElementById('vendorApplication').value = 'open';
                    document.getElementById('couponReview').value = 'manual';
                    alert('Ë®≠ÂÆöÂ∑≤ÈáçÁΩÆÔºÅ');
                }
            }

            // Âø´ÈÄüÊìç‰ΩúÂäüËÉΩ
            function clearCache() {
                if (confirm('Á¢∫ÂÆöË¶ÅÊ∏ÖÈô§Á≥ªÁµ±Âø´ÂèñÂóéÔºü')) {
                    alert('Âø´ÂèñÊ∏ÖÈô§ÊàêÂäüÔºÅ');
                }
            }

            function exportData() {
                alert('Êï∏ÊìöÂåØÂá∫ÂäüËÉΩÈñãÁôº‰∏≠...');
            }

            function backupDatabase() {
                if (confirm('Á¢∫ÂÆöË¶ÅÂÇô‰ªΩË≥áÊñôÂ∫´ÂóéÔºüÈÄôÂèØËÉΩÈúÄË¶Å‰∏Ä‰∫õÊôÇÈñì„ÄÇ')) {
                    alert('Ë≥áÊñôÂ∫´ÂÇô‰ªΩÂ∑≤ÈñãÂßãÔºåÂÆåÊàêÂæåÊúÉÈÄöÁü•ÊÇ®„ÄÇ');
                }
            }

            function checkSystemHealth() {
                alert('Á≥ªÁµ±Ê™¢Êü•ÂÆåÊàêÔºö\n‚úÖ Ë≥áÊñôÂ∫´ÈÄ£Á∑öÊ≠£Â∏∏\n‚úÖ API ÊúçÂãôÊ≠£Â∏∏\n‚úÖ Ê™îÊ°àÁ≥ªÁµ±Ê≠£Â∏∏\n‚úÖ Ë®òÊÜ∂È´î‰ΩøÁî®Ê≠£Â∏∏');
            }

            function restartSystem() {
                if (confirm('‚ö†Ô∏è Ë≠¶ÂëäÔºöÈáçÂïüÁ≥ªÁµ±ÊúÉÊö´ÊôÇ‰∏≠Êñ∑ÊúçÂãôÔºåÁ¢∫ÂÆöË¶ÅÁπºÁ∫åÂóéÔºü')) {
                    alert('Á≥ªÁµ±ÈáçÂïüÊåá‰ª§Â∑≤ÁôºÈÄÅÔºåË´ãÁ≠âÂæÖÁ¥Ñ30ÁßíÂæåÈáçÊñ∞ËºâÂÖ•È†ÅÈù¢„ÄÇ');
                }
            }

            function viewErrorLogs() {
                alert('ÈåØË™§Êó•Ë™åÂäüËÉΩÈñãÁôº‰∏≠...');
            }

            // ==================== Êñ∞Â¢ûÂäüËÉΩÂáΩÊï∏ ====================

            // ÂÖßÂÆπÁÆ°ÁêÜÂäüËÉΩ
            function loadContentManagement() {
                console.log('ËºâÂÖ•ÂÖßÂÆπÁÆ°ÁêÜ');
                loadAnnouncements();
                loadBanners();
                loadFAQs();
            }

            // ÂÖ¨ÂëäÁÆ°ÁêÜ
            function loadAnnouncements() {
                // Ê®°Êì¨ËºâÂÖ•ÂÖ¨ÂëäË≥áÊñô
                const announcements = [
                    {
                        id: 1,
                        title: 'Âπ≥Âè∞Á∂≠Ë≠∑ÈÄöÁü•',
                        type: 'Á≥ªÁµ±ÂÖ¨Âëä',
                        status: 'ÈÄ≤Ë°å‰∏≠',
                        startTime: '2024-01-15 00:00',
                        endTime: '2024-01-20 23:59'
                    },
                    {
                        id: 2,
                        title: 'Êñ∞ÂäüËÉΩ‰∏äÁ∑ö',
                        type: 'ÂäüËÉΩÊõ¥Êñ∞',
                        status: 'Â∑≤ÁµêÊùü',
                        startTime: '2024-01-10 10:00',
                        endTime: '2024-01-14 18:00'
                    }
                ];

                const tbody = document.getElementById('announcementList');
                if (announcements.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; color: #6b7280; padding: 40px;">Êö´ÁÑ°ÂÖ¨ÂëäË≥áÊñô</td></tr>';
                    return;
                }

                tbody.innerHTML = announcements.map(announcement => `
                    <tr>
                        <td style="font-weight: 500;">${announcement.title}</td>
                        <td><span class="badge badge-info">${announcement.type}</span></td>
                        <td><span class="badge ${announcement.status === 'ÈÄ≤Ë°å‰∏≠' ? 'status-active' : 'status-expired'}">${announcement.status}</span></td>
                        <td style="font-size: 14px;">${announcement.startTime}</td>
                        <td style="font-size: 14px;">${announcement.endTime}</td>
                        <td>
                            <button class="btn secondary" onclick="editAnnouncement(${announcement.id})">Á∑®ËºØ</button>
                            <button class="btn danger" onclick="deleteAnnouncement(${announcement.id})">Âà™Èô§</button>
                        </td>
                    </tr>
                `).join('');
            }

            // Ê®°ÊÖãÁ™óÂè£ÁÆ°ÁêÜ
            function openModal(modalId) {
                // ÂÖàÈóúÈñâÊâÄÊúâÂÖ∂‰ªñÊ®°ÊÖãÁ™óÂè£
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.classList.remove('active');
                });

                document.getElementById(modalId).classList.add('active');
                document.body.style.overflow = 'hidden';
            }

            function closeModal(modalId) {
                document.getElementById(modalId).classList.remove('active');
                document.body.style.overflow = 'auto';

                // Ê∏ÖÁ©∫Ë°®ÂñÆ
                const form = document.querySelector(`#${modalId} form`);
                if (form) form.reset();
            }

            // ÈªûÊìäÊ®°ÊÖãÁ™óÂè£ËÉåÊôØÈóúÈñâ
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('modal')) {
                    const modalId = e.target.id;
                    if (modalId) {
                        closeModal(modalId);
                    }
                }
            });

            // ESCÈçµÈóúÈñâÊ®°ÊÖãÁ™óÂè£
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    const activeModal = document.querySelector('.modal.active');
                    if (activeModal) {
                        closeModal(activeModal.id);
                    }
                }
            });

            // ÂÖ¨ÂëäÁÆ°ÁêÜ
            let announcements = [
                {
                    id: 1,
                    title: 'Âπ≥Âè∞Á∂≠Ë≠∑ÈÄöÁü•',
                    type: 'Á≥ªÁµ±ÂÖ¨Âëä',
                    content: 'Á≥ªÁµ±Â∞áÊñº‰ªäÊôöÈÄ≤Ë°åÁ∂≠Ë≠∑ÔºåÈ†êË®àÁ∂≠Ë≠∑ÊôÇÈñì2Â∞èÊôÇ„ÄÇ',
                    status: 'active',
                    startTime: '2024-01-15 00:00',
                    endTime: '2024-01-20 23:59',
                    createdAt: '2024-01-15 10:00'
                },
                {
                    id: 2,
                    title: 'Êñ∞ÂäüËÉΩ‰∏äÁ∑ö',
                    type: 'ÂäüËÉΩÊõ¥Êñ∞',
                    content: 'Êñ∞Â¢û‰∫ÜÂÑ™ÊÉ†Âà∏Êî∂ËóèÂäüËÉΩÔºåÊ≠°ËøéÂ§ßÂÆ∂‰ΩøÁî®ÔºÅ',
                    status: 'expired',
                    startTime: '2024-01-10 10:00',
                    endTime: '2024-01-14 18:00',
                    createdAt: '2024-01-10 09:00'
                }
            ];

            function addAnnouncement() {
                document.getElementById('announcementModal').querySelector('.modal-title').textContent = 'Êñ∞Â¢ûÂÖ¨Âëä';
                openModal('announcementModal');
            }

            function editAnnouncement(id) {
                const announcement = announcements.find(a => a.id === id);
                if (announcement) {
                    document.getElementById('announcementModal').querySelector('.modal-title').textContent = 'Á∑®ËºØÂÖ¨Âëä';
                    document.getElementById('announcementTitle').value = announcement.title;
                    document.getElementById('announcementType').value = announcement.type;
                    document.getElementById('announcementContent').value = announcement.content;
                    document.getElementById('announcementStartTime').value = announcement.startTime.replace(' ', 'T');
                    document.getElementById('announcementEndTime').value = announcement.endTime.replace(' ', 'T');
                    document.getElementById('announcementStatus').value = announcement.status;

                    // Ë®≠ÁΩÆÁ∑®ËºØÊ®°ÂºèÊ®ôË®ò
                    document.getElementById('announcementForm').dataset.editId = id;
                    openModal('announcementModal');
                }
            }

            function deleteAnnouncement(id) {
                if (confirm('Á¢∫ÂÆöË¶ÅÂà™Èô§ÈÄôÂÄãÂÖ¨ÂëäÂóéÔºü')) {
                    announcements = announcements.filter(a => a.id !== id);
                    loadAnnouncements();
                    showNotification('ÂÖ¨ÂëäÂà™Èô§ÊàêÂäüÔºÅ', 'success');
                }
            }

            function saveAnnouncement() {
                const form = document.getElementById('announcementForm');
                const formData = new FormData(form);

                const title = document.getElementById('announcementTitle').value;
                const type = document.getElementById('announcementType').value;
                const content = document.getElementById('announcementContent').value;
                const startTime = document.getElementById('announcementStartTime').value.replace('T', ' ');
                const endTime = document.getElementById('announcementEndTime').value.replace('T', ' ');
                const status = document.getElementById('announcementStatus').value;

                if (!title || !type || !content || !startTime) {
                    alert('Ë´ãÂ°´ÂØ´ÂøÖÂ°´Ê¨Ñ‰ΩçÔºÅ');
                    return;
                }

                const editId = form.dataset.editId;
                if (editId) {
                    // Á∑®ËºØÊ®°Âºè
                    const announcement = announcements.find(a => a.id == editId);
                    if (announcement) {
                        announcement.title = title;
                        announcement.type = type;
                        announcement.content = content;
                        announcement.startTime = startTime;
                        announcement.endTime = endTime;
                        announcement.status = status;
                    }
                    delete form.dataset.editId;
                    showNotification('ÂÖ¨ÂëäÊõ¥Êñ∞ÊàêÂäüÔºÅ', 'success');
                } else {
                    // Êñ∞Â¢ûÊ®°Âºè
                    const newAnnouncement = {
                        id: Math.max(...announcements.map(a => a.id), 0) + 1,
                        title, type, content, status, startTime, endTime,
                        createdAt: new Date().toLocaleString('zh-TW', {
                            year: 'numeric',
                            month: '2-digit',
                            day: '2-digit',
                            hour: '2-digit',
                            minute: '2-digit'
                        }).replace(/\//g, '-')
                    };
                    announcements.unshift(newAnnouncement);
                    showNotification('ÂÖ¨ÂëäÊñ∞Â¢ûÊàêÂäüÔºÅ', 'success');
                }

                loadAnnouncements();
                closeModal('announcementModal');
            }

            // Ëº™Êí≠ÂúñÁÆ°ÁêÜ
            let banners = [
                {
                    id: 1,
                    title: 'Ê≠°Ëøé‰ΩøÁî®ÈÄÅÂó®Â∫∑',
                    description: 'ÁôºÁèæÊõ¥Â§öÂÑ™Ë≥™ÂÑ™ÊÉ†Âà∏',
                    image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDgwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI4MDAiIGhlaWdodD0iMzAwIiBmaWxsPSIjRkNBMzExIi8+Cjx0ZXh0IHg9IjQwMCIgeT0iMTUwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCIgZmlsbD0id2hpdGUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIyNCI+5q2h6L+O5L2/55So6YCB5ZWo5bq3PC90ZXh0Pgo8L3N2Zz4K',
                    link: '#',
                    order: 1,
                    status: 'active'
                },
                {
                    id: 2,
                    title: 'Êñ∞Âπ¥ÁâπÊÉ†Ê¥ªÂãï',
                    description: 'Ë∂ÖÂÄºÂÑ™ÊÉ†Âà∏Á≠â‰Ω†‰æÜÈ†ò',
                    image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDgwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI4MDAiIGhlaWdodD0iMzAwIiBmaWxsPSIjZjU5ZTBiIi8+Cjx0ZXh0IHg9IjQwMCIgeT0iMTUwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCIgZmlsbD0id2hpdGUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIyNCI+5paw5bm055m55oOg5rS75YuVPC90ZXh0Pgo8L3N2Zz4K',
                    link: '#',
                    order: 2,
                    status: 'active'
                }
            ];

            function loadBanners() {
                const container = document.getElementById('bannerGrid');

                if (banners.length === 0) {
                    container.innerHTML = `
                        <div class="banner-placeholder">
                            <div class="banner-placeholder-content">
                                <span>üì∑</span>
                                <p>Êö´ÁÑ°Ëº™Êí≠Âúñ</p>
                                <button class="btn primary" onclick="addBanner()">‰∏äÂÇ≥ÂúñÁâá</button>
                            </div>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = banners.map(banner => `
                    <div class="banner-item">
                        <img src="${banner.image}" alt="${banner.title}" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDgwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI4MDAiIGhlaWdodD0iMzAwIiBmaWxsPSIjZTVlN2ViIi8+Cjx0ZXh0IHg9IjQwMCIgeT0iMTUwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCIgZmlsbD0iIzZiNzI4MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE4Ij7lnJvniYfovInlhaXlpLHmlZc8L3RleHQ+Cjwvc3ZnPgo='">
                        <div class="banner-item-info">
                            <h4 style="margin: 0 0 8px 0; font-size: 16px;">${banner.title}</h4>
                            <p style="margin: 0 0 8px 0; font-size: 14px; color: #6b7280;">${banner.description || 'ÁÑ°ÊèèËø∞'}</p>
                            <div style="display: flex; justify-content: space-between; align-items: center; font-size: 12px; color: #6b7280;">
                                <span>È†ÜÂ∫è: ${banner.order}</span>
                                <span class="badge ${banner.status === 'active' ? 'status-active' : 'status-inactive'}">${banner.status === 'active' ? 'ÂïüÁî®' : 'ÂÅúÁî®'}</span>
                            </div>
                            <div class="banner-item-actions">
                                <button class="btn secondary" onclick="editBanner(${banner.id})" style="flex: 1;">Á∑®ËºØ</button>
                                <button class="btn danger" onclick="deleteBanner(${banner.id})" style="flex: 1;">Âà™Èô§</button>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            function addBanner() {
                document.getElementById('bannerModal').querySelector('.modal-title').textContent = 'Êñ∞Â¢ûËº™Êí≠Âúñ';
                openModal('bannerModal');
            }

            function editBanner(id) {
                const banner = banners.find(b => b.id === id);
                if (banner) {
                    document.getElementById('bannerModal').querySelector('.modal-title').textContent = 'Á∑®ËºØËº™Êí≠Âúñ';
                    document.getElementById('bannerTitle').value = banner.title;
                    document.getElementById('bannerDescription').value = banner.description || '';
                    document.getElementById('bannerLink').value = banner.link || '';
                    document.getElementById('bannerOrder').value = banner.order;
                    document.getElementById('bannerStatus').value = banner.status;

                    // Ë®≠ÁΩÆÁ∑®ËºØÊ®°ÂºèÊ®ôË®ò
                    document.getElementById('bannerForm').dataset.editId = id;
                    openModal('bannerModal');
                }
            }

            function deleteBanner(id) {
                if (confirm('Á¢∫ÂÆöË¶ÅÂà™Èô§ÈÄôÂÄãËº™Êí≠ÂúñÂóéÔºü')) {
                    banners = banners.filter(b => b.id !== id);
                    loadBanners();
                    showNotification('Ëº™Êí≠ÂúñÂà™Èô§ÊàêÂäüÔºÅ', 'success');
                }
            }

            function saveBanner() {
                const form = document.getElementById('bannerForm');
                const title = document.getElementById('bannerTitle').value;
                const description = document.getElementById('bannerDescription').value;
                const imageFile = document.getElementById('bannerImage').files[0];
                const link = document.getElementById('bannerLink').value;
                const order = parseInt(document.getElementById('bannerOrder').value);
                const status = document.getElementById('bannerStatus').value;

                if (!title) {
                    alert('Ë´ãÂ°´ÂØ´ÂúñÁâáÊ®ôÈ°åÔºÅ');
                    return;
                }

                const editId = form.dataset.editId;
                if (editId) {
                    // Á∑®ËºØÊ®°Âºè
                    const banner = banners.find(b => b.id == editId);
                    if (banner) {
                        banner.title = title;
                        banner.description = description;
                        banner.link = link;
                        banner.order = order;
                        banner.status = status;

                        // Â¶ÇÊûúÊúâÊñ∞ÂúñÁâáÔºåÊõ¥Êñ∞ÂúñÁâáÔºàÂØ¶ÈöõÊáâ‰∏äÂÇ≥Âà∞ÊúçÂãôÂô®Ôºâ
                        if (imageFile) {
                            const reader = new FileReader();
                            reader.onload = function (e) {
                                banner.image = e.target.result;
                                loadBanners();
                            };
                            reader.readAsDataURL(imageFile);
                        }
                    }
                    delete form.dataset.editId;
                    showNotification('Ëº™Êí≠ÂúñÊõ¥Êñ∞ÊàêÂäüÔºÅ', 'success');
                } else {
                    // Êñ∞Â¢ûÊ®°Âºè
                    if (!imageFile) {
                        alert('Ë´ãÈÅ∏ÊìáÂúñÁâáÊ™îÊ°àÔºÅ');
                        return;
                    }

                    const reader = new FileReader();
                    reader.onload = function (e) {
                        const newBanner = {
                            id: Math.max(...banners.map(b => b.id), 0) + 1,
                            title, description, link, order, status,
                            image: e.target.result
                        };
                        banners.unshift(newBanner);
                        loadBanners();
                        showNotification('Ëº™Êí≠ÂúñÊñ∞Â¢ûÊàêÂäüÔºÅ', 'success');
                    };
                    reader.readAsDataURL(imageFile);
                }

                closeModal('bannerModal');
            }

            // FAQÁÆ°ÁêÜ
            let faqs = [
                {
                    id: 1,
                    category: 'general',
                    question: 'Â¶Ç‰ΩïË®ªÂÜäÂ∏≥ËôüÔºü',
                    answer: 'ÈªûÊìäÈ¶ñÈ†ÅÂè≥‰∏äËßíÁöÑ„ÄåË®ªÂÜä„ÄçÊåâÈàïÔºåÂ°´ÂØ´Âü∫Êú¨Ë≥áÊñôÂç≥ÂèØÂÆåÊàêË®ªÂÜä„ÄÇ',
                    order: 1,
                    status: 'active'
                },
                {
                    id: 2,
                    category: 'coupon',
                    question: 'ÂÑ™ÊÉ†Âà∏Â¶Ç‰Ωï‰ΩøÁî®Ôºü',
                    answer: 'Âú®ÁµêÂ∏≥È†ÅÈù¢Ëº∏ÂÖ•ÂÑ™ÊÉ†Âà∏‰ª£Á¢ºÔºåÁ≥ªÁµ±ÊúÉËá™ÂãïË®àÁÆóÊäòÊâ£ÈáëÈ°ç„ÄÇ',
                    order: 2,
                    status: 'active'
                },
                {
                    id: 3,
                    category: 'account',
                    question: 'ÂøòË®òÂØÜÁ¢ºÊÄéÈ∫ºËæ¶Ôºü',
                    answer: 'ÈªûÊìäÁôªÂÖ•È†ÅÈù¢ÁöÑ„ÄåÂøòË®òÂØÜÁ¢º„ÄçÈÄ£ÁµêÔºåËº∏ÂÖ•Ë®ªÂÜäÈÉµÁÆ±Âç≥ÂèØÈáçË®≠ÂØÜÁ¢º„ÄÇ',
                    order: 3,
                    status: 'active'
                }
            ];

            function loadFAQs() {
                const container = document.getElementById('faqList');

                if (faqs.length === 0) {
                    container.innerHTML = `
                        <div class="faq-placeholder">
                            <span>‚ùì</span>
                            <p>Êö´ÁÑ°Â∏∏Ë¶ãÂïèÈ°å</p>
                        </div>
                    `;
                    return;
                }

                const categoryLabels = {
                    'general': '‰∏ÄËà¨ÂïèÈ°å',
                    'account': 'Â∏≥Êà∂Áõ∏Èóú',
                    'coupon': 'ÂÑ™ÊÉ†Âà∏‰ΩøÁî®',
                    'payment': '‰ªòÊ¨æÂïèÈ°å',
                    'technical': 'ÊäÄË°ìÊîØÊè¥'
                };

                container.innerHTML = faqs.map(faq => `
                    <div class="faq-item">
                        <div class="faq-question" onclick="toggleFAQ(${faq.id})">
                            <div>
                                <span class="badge badge-info" style="margin-right: 8px; font-size: 10px;">${categoryLabels[faq.category] || faq.category}</span>
                                ${faq.question}
                            </div>
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <span class="badge ${faq.status === 'active' ? 'status-active' : 'status-inactive'}" style="font-size: 10px;">${faq.status === 'active' ? 'ÂïüÁî®' : 'ÂÅúÁî®'}</span>
                                <button class="btn secondary" onclick="event.stopPropagation(); editFAQ(${faq.id})" style="padding: 4px 8px; font-size: 12px;">Á∑®ËºØ</button>
                                <button class="btn danger" onclick="event.stopPropagation(); deleteFAQ(${faq.id})" style="padding: 4px 8px; font-size: 12px;">Âà™Èô§</button>
                                <span id="faq-toggle-${faq.id}">‚ñº</span>
                            </div>
                        </div>
                        <div class="faq-answer" id="faq-answer-${faq.id}" style="display: none;">
                            ${faq.answer}
                        </div>
                    </div>
                `).join('');
            }

            function toggleFAQ(id) {
                const answer = document.getElementById(`faq-answer-${id}`);
                const toggle = document.getElementById(`faq-toggle-${id}`);

                if (answer.style.display === 'none') {
                    answer.style.display = 'block';
                    toggle.textContent = '‚ñ≤';
                } else {
                    answer.style.display = 'none';
                    toggle.textContent = '‚ñº';
                }
            }

            function addFAQ() {
                document.getElementById('faqModal').querySelector('.modal-title').textContent = 'Êñ∞Â¢ûÂ∏∏Ë¶ãÂïèÈ°å';
                openModal('faqModal');
            }

            function editFAQ(id) {
                const faq = faqs.find(f => f.id === id);
                if (faq) {
                    document.getElementById('faqModal').querySelector('.modal-title').textContent = 'Á∑®ËºØÂ∏∏Ë¶ãÂïèÈ°å';
                    document.getElementById('faqCategory').value = faq.category;
                    document.getElementById('faqQuestion').value = faq.question;
                    document.getElementById('faqAnswer').value = faq.answer;
                    document.getElementById('faqOrder').value = faq.order;
                    document.getElementById('faqStatus').value = faq.status;

                    // Ë®≠ÁΩÆÁ∑®ËºØÊ®°ÂºèÊ®ôË®ò
                    document.getElementById('faqForm').dataset.editId = id;
                    openModal('faqModal');
                }
            }

            function deleteFAQ(id) {
                if (confirm('Á¢∫ÂÆöË¶ÅÂà™Èô§ÈÄôÂÄãÂ∏∏Ë¶ãÂïèÈ°åÂóéÔºü')) {
                    faqs = faqs.filter(f => f.id !== id);
                    loadFAQs();
                    showNotification('Â∏∏Ë¶ãÂïèÈ°åÂà™Èô§ÊàêÂäüÔºÅ', 'success');
                }
            }

            function saveFAQ() {
                const form = document.getElementById('faqForm');
                const category = document.getElementById('faqCategory').value;
                const question = document.getElementById('faqQuestion').value;
                const answer = document.getElementById('faqAnswer').value;
                const order = parseInt(document.getElementById('faqOrder').value);
                const status = document.getElementById('faqStatus').value;

                if (!question || !answer) {
                    alert('Ë´ãÂ°´ÂØ´ÂïèÈ°åÂÖßÂÆπÂíåÂõûÁ≠îÔºÅ');
                    return;
                }

                const editId = form.dataset.editId;
                if (editId) {
                    // Á∑®ËºØÊ®°Âºè
                    const faq = faqs.find(f => f.id == editId);
                    if (faq) {
                        faq.category = category;
                        faq.question = question;
                        faq.answer = answer;
                        faq.order = order;
                        faq.status = status;
                    }
                    delete form.dataset.editId;
                    showNotification('Â∏∏Ë¶ãÂïèÈ°åÊõ¥Êñ∞ÊàêÂäüÔºÅ', 'success');
                } else {
                    // Êñ∞Â¢ûÊ®°Âºè
                    const newFAQ = {
                        id: Math.max(...faqs.map(f => f.id), 0) + 1,
                        category, question, answer, order, status
                    };
                    faqs.unshift(newFAQ);
                    showNotification('Â∏∏Ë¶ãÂïèÈ°åÊñ∞Â¢ûÊàêÂäüÔºÅ', 'success');
                }

                loadFAQs();
                closeModal('faqModal');
            }

            // ÈÄöÁü•ÂäüËÉΩ
            function showNotification(message, type = 'info') {
                // Á∞°ÂñÆÁöÑÈÄöÁü•ÂØ¶Áèæ
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: ${type === 'success' ? '#10b981' : type === 'error' ? '#ef4444' : '#3b82f6'};
                    color: white;
                    padding: 12px 20px;
                    border-radius: 8px;
                    z-index: 10000;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                `;
                notification.textContent = message;
                document.body.appendChild(notification);

                setTimeout(() => {
                    notification.remove();
                }, 3000);
            }

            // Âπ´Âä©ÊñáÊ™î
            function addHelpDoc() {
                alert('Êñ∞Â¢ûÂπ´Âä©ÊñáÊ™îÂäüËÉΩÈñãÁôº‰∏≠...');
            }

            function editHelpDoc(type) {
                alert(`Á∑®ËºØ${type}ÂäüËÉΩÈñãÁôº‰∏≠...`);
            }

            function previewHelpDoc(type) {
                alert(`È†êË¶Ω${type}ÂäüËÉΩÈñãÁôº‰∏≠...`);
            }

            // ÂÆâÂÖ®ÁÆ°ÁêÜÂäüËÉΩ
            // ÂÆâÂÖ®ÁÆ°ÁêÜÂäüËÉΩ
            function loadSecurityManagement() {
                console.log('ËºâÂÖ•ÂÆâÂÖ®ÁÆ°ÁêÜ');
                loadSecurityStats();
                loadLoginLogs();
                loadIPWhitelist();
                loadSecuritySettings();
            }

            // ËºâÂÖ•ÂÆâÂÖ®Áµ±Ë®à
            function loadSecurityStats() {
                // Êõ¥Êñ∞ÂÆâÂÖ®Áµ±Ë®àÊï∏Êìö
                const stats = {
                    todayLogins: Math.floor(Math.random() * 200) + 50,
                    failedAttempts: Math.floor(Math.random() * 20) + 5,
                    blockedIPs: Math.floor(Math.random() * 10) + 2,
                    activeUsers: Math.floor(Math.random() * 100) + 30
                };

                // Êõ¥Êñ∞Áµ±Ë®àÂç°Áâá
                const statCards = document.querySelectorAll('.security-stat-number');
                if (statCards.length >= 4) {
                    statCards[0].textContent = stats.todayLogins;
                    statCards[1].textContent = stats.failedAttempts;
                    statCards[2].textContent = stats.blockedIPs;
                    statCards[3].textContent = stats.activeUsers;
                }
            }

            // ÁôªÂÖ•Êó•Ë™åÁÆ°ÁêÜ
            let loginLogs = [
                {
                    id: 1,
                    time: new Date().toLocaleString('zh-TW'),
                    user: 'admin',
                    role: 'ÁÆ°ÁêÜÂì°',
                    ip: '192.168.1.100',
                    location: 'Âè∞ÂåóÂ∏Ç',
                    device: 'Chrome 120.0 / Windows 10',
                    status: 'success',
                    riskLevel: 'low'
                },
                {
                    id: 2,
                    time: new Date(Date.now() - 300000).toLocaleString('zh-TW'),
                    user: 'vendor01',
                    role: 'Âª†ÂïÜ',
                    ip: '203.74.123.45',
                    location: 'Âè∞‰∏≠Â∏Ç',
                    device: 'Safari 17.0 / macOS',
                    status: 'success',
                    riskLevel: 'low'
                },
                {
                    id: 3,
                    time: new Date(Date.now() - 600000).toLocaleString('zh-TW'),
                    user: 'unknown',
                    role: 'Êú™Áü•',
                    ip: '45.123.45.67',
                    location: 'Êú™Áü•Âú∞ÂçÄ',
                    device: 'Firefox 118.0 / Linux',
                    status: 'failed',
                    riskLevel: 'high'
                },
                {
                    id: 4,
                    time: new Date(Date.now() - 900000).toLocaleString('zh-TW'),
                    user: 'customer01',
                    role: 'ÊúÉÂì°',
                    ip: '114.32.168.92',
                    location: 'È´òÈõÑÂ∏Ç',
                    device: 'Chrome 120.0 / Android',
                    status: 'success',
                    riskLevel: 'low'
                },
                {
                    id: 5,
                    time: new Date(Date.now() - 1200000).toLocaleString('zh-TW'),
                    user: 'hacker_attempt',
                    role: 'Êú™Áü•',
                    ip: '185.220.101.45',
                    location: 'ÂúãÂ§ñ',
                    device: 'Unknown / Unknown',
                    status: 'blocked',
                    riskLevel: 'critical'
                }
            ];

            function loadLoginLogs() {
                const tbody = document.getElementById('loginLogsList');
                if (!tbody) return;

                tbody.innerHTML = loginLogs.map(log => `
                    <tr class="${log.riskLevel === 'critical' ? 'risk-critical' : log.riskLevel === 'high' ? 'risk-high' : ''}">
                        <td style="font-size: 12px; color: #6b7280;">${log.time}</td>
                        <td>
                            <div style="display: flex; flex-direction: column; gap: 2px;">
                                <span style="font-weight: 500; font-size: 14px;">${log.user}</span>
                                <span class="badge role-${log.role === 'ÁÆ°ÁêÜÂì°' ? 'admin' : log.role === 'Âª†ÂïÜ' ? 'vendor' : 'customer'}" style="font-size: 10px; width: fit-content;">
                                    ${log.role}
                                </span>
                            </div>
                        </td>
                        <td style="font-family: monospace; font-size: 12px;">${log.ip}</td>
                        <td style="font-size: 12px;">${log.location}</td>
                        <td style="font-size: 11px; color: #6b7280; max-width: 150px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${log.device}</td>
                        <td>
                            <span class="badge ${log.status === 'success' ? 'status-active' : log.status === 'failed' ? 'status-rejected' : 'status-expired'}">
                                ${log.status === 'success' ? '‚úÖ ÊàêÂäü' : log.status === 'failed' ? '‚ùå Â§±Êïó' : 'üö´ Â∞ÅÈéñ'}
                            </span>
                        </td>
                        <td>
                            <div style="display: flex; gap: 4px;">
                                <button class="btn secondary" onclick="viewLogDetail(${log.id})" style="padding: 4px 8px; font-size: 11px;">Ë©≥ÊÉÖ</button>
                                ${log.status === 'failed' && log.riskLevel !== 'low' ?
                        `<button class="btn danger" onclick="blockIP('${log.ip}')" style="padding: 4px 8px; font-size: 11px;">Â∞ÅÈéñ</button>` :
                        ''}
                            </div>
                        </td>
                    </tr>
                `).join('');
            }

            function exportLoginLogs() {
                // Ê®°Êì¨ÂåØÂá∫CSV
                const csvContent = [
                    ['ÊôÇÈñì', 'Áî®Êà∂', 'ËßíËâ≤', 'IPÂú∞ÂùÄ', '‰ΩçÁΩÆ', 'Ë®≠ÂÇô', 'ÁãÄÊÖã', 'È¢®Èö™Á≠âÁ¥ö'],
                    ...loginLogs.map(log => [
                        log.time,
                        log.user,
                        log.role,
                        log.ip,
                        log.location,
                        log.device,
                        log.status,
                        log.riskLevel
                    ])
                ].map(row => row.join(',')).join('\n');

                const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', `ÁôªÂÖ•Êó•Ë™å_${new Date().toISOString().split('T')[0]}.csv`);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                showNotification('ÁôªÂÖ•Êó•Ë™åÂåØÂá∫ÊàêÂäüÔºÅ', 'success');
            }

            function clearOldLogs() {
                if (confirm('Á¢∫ÂÆöË¶ÅÊ∏ÖÁêÜ30Â§©ÂâçÁöÑËàäÊó•Ë™åÂóéÔºüÊ≠§Êìç‰ΩúÁÑ°Ê≥ïÂæ©Âéü„ÄÇ')) {
                    // Ê®°Êì¨Ê∏ÖÁêÜÊìç‰Ωú
                    const oldCount = loginLogs.length;
                    // ÈÄôË£°ÊáâË©≤Ë™øÁî®APIÊ∏ÖÁêÜÁúüÂØ¶Êï∏Êìö
                    showNotification(`Â∑≤Ê∏ÖÁêÜ ${Math.floor(oldCount * 0.3)} Ê¢ùËàäÊó•Ë™åË®òÈåÑ`, 'success');
                }
            }

            function viewLogDetail(logId) {
                const log = loginLogs.find(l => l.id === logId);
                if (!log) return;

                const modal = document.createElement('div');
                modal.className = 'modal active';
                modal.innerHTML = `
                    <div class="modal-content" style="max-width: 600px;">
                        <div class="modal-header">
                            <h3 class="modal-title">ÁôªÂÖ•Êó•Ë™åË©≥ÊÉÖ</h3>
                            <button class="modal-close" onclick="this.closest('.modal').remove()">&times;</button>
                        </div>
                        <div style="padding: 20px;">
                            <div style="display: grid; grid-template-columns: 120px 1fr; gap: 12px; font-size: 14px;">
                                <strong>ÁôªÂÖ•ÊôÇÈñì:</strong><span>${log.time}</span>
                                <strong>Áî®Êà∂ÂêçÁ®±:</strong><span>${log.user}</span>
                                <strong>Áî®Êà∂ËßíËâ≤:</strong><span class="badge role-${log.role === 'ÁÆ°ÁêÜÂì°' ? 'admin' : log.role === 'Âª†ÂïÜ' ? 'vendor' : 'customer'}">${log.role}</span>
                                <strong>IPÂú∞ÂùÄ:</strong><span style="font-family: monospace;">${log.ip}</span>
                                <strong>Âú∞ÁêÜ‰ΩçÁΩÆ:</strong><span>${log.location}</span>
                                <strong>Ë®≠ÂÇôË≥áË®ä:</strong><span>${log.device}</span>
                                <strong>ÁôªÂÖ•ÁãÄÊÖã:</strong><span class="badge ${log.status === 'success' ? 'status-active' : log.status === 'failed' ? 'status-rejected' : 'status-expired'}">${log.status === 'success' ? 'ÊàêÂäü' : log.status === 'failed' ? 'Â§±Êïó' : 'Â∞ÅÈéñ'}</span>
                                <strong>È¢®Èö™Á≠âÁ¥ö:</strong><span class="badge ${log.riskLevel === 'critical' ? 'status-rejected' : log.riskLevel === 'high' ? 'status-pending' : 'status-active'}">${log.riskLevel === 'critical' ? 'Ê•µÈ´òÈ¢®Èö™' : log.riskLevel === 'high' ? 'È´òÈ¢®Èö™' : '‰ΩéÈ¢®Èö™'}</span>
                            </div>
                            ${log.riskLevel !== 'low' ? `
                                <div style="margin-top: 20px; padding: 12px; background: #fef3c7; border-left: 4px solid #f59e0b; border-radius: 6px;">
                                    <strong style="color: #92400e;">‚ö†Ô∏è ÂÆâÂÖ®ÊèêÈÜí:</strong>
                                    <p style="margin: 4px 0 0 0; color: #92400e; font-size: 13px;">
                                        Ê≠§Ê¨°ÁôªÂÖ•Ë¢´Ê®ôË®òÁÇ∫${log.riskLevel === 'critical' ? 'Ê•µÈ´ò' : 'È´ò'}È¢®Èö™ÔºåÂª∫Ë≠∞ÈÄ≤‰∏ÄÊ≠•Ê™¢Êü•„ÄÇ
                                    </p>
                                </div>
                            ` : ''}
                        </div>
                        <div class="modal-footer">
                            ${log.status === 'failed' ? `<button class="btn danger" onclick="blockIP('${log.ip}'); this.closest('.modal').remove();">Â∞ÅÈéñÊ≠§IP</button>` : ''}
                            <button class="btn secondary" onclick="this.closest('.modal').remove()">ÈóúÈñâ</button>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
            }

            // IPÁôΩÂêçÂñÆÁÆ°ÁêÜ
            let ipWhitelist = [
                { id: 1, ip: '192.168.1.0/24', description: 'ÂÖßÁ∂≤IPÊÆµ', status: 'active', createdAt: '2024-01-10' },
                { id: 2, ip: '203.74.123.45', description: 'Ëæ¶ÂÖ¨ÂÆ§Âõ∫ÂÆöIP', status: 'active', createdAt: '2024-01-12' },
                { id: 3, ip: '114.32.0.0/16', description: 'Âêà‰ΩúÂ§•‰º¥IPÊÆµ', status: 'active', createdAt: '2024-01-13' }
            ];

            function loadIPWhitelist() {
                const container = document.getElementById('ipWhitelistContainer');
                if (!container) return;

                if (ipWhitelist.length === 0) {
                    container.innerHTML = '<div style="text-align: center; padding: 40px; color: #6b7280;">Êö´ÁÑ°IPÁôΩÂêçÂñÆ</div>';
                    return;
                }

                container.innerHTML = ipWhitelist.map(item => `
                    <div class="ip-whitelist-item" style="display: flex; justify-content: space-between; align-items: center; padding: 16px; border: 1px solid #e5e7eb; border-radius: 8px; margin-bottom: 12px;">
                        <div>
                            <div style="font-weight: 500; font-family: monospace; font-size: 16px; color: #111827;">${item.ip}</div>
                            <div style="font-size: 14px; color: #6b7280; margin-top: 4px;">${item.description}</div>
                            <div style="font-size: 12px; color: #9ca3af; margin-top: 4px;">Êñ∞Â¢ûÊôÇÈñì: ${item.createdAt}</div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <span class="badge ${item.status === 'active' ? 'status-active' : 'status-inactive'}">${item.status === 'active' ? 'ÂïüÁî®' : 'ÂÅúÁî®'}</span>
                            <button class="btn secondary" onclick="editIPWhitelist(${item.id})" style="padding: 6px 12px; font-size: 12px;">Á∑®ËºØ</button>
                            <button class="btn danger" onclick="deleteIPWhitelist(${item.id})" style="padding: 6px 12px; font-size: 12px;">Âà™Èô§</button>
                        </div>
                    </div>
                `).join('');
            }

            function addIPWhitelist() {
                const modal = document.createElement('div');
                modal.className = 'modal active';
                modal.innerHTML = `
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 class="modal-title">Êñ∞Â¢ûIPÁôΩÂêçÂñÆ</h3>
                            <button class="modal-close" onclick="this.closest('.modal').remove()">&times;</button>
                        </div>
                        <form id="ipWhitelistForm">
                            <div class="form-group">
                                <label class="form-label">IPÂú∞ÂùÄÊàñIPÊÆµ *</label>
                                <input type="text" class="form-input" id="ipAddress" placeholder="‰æãÂ¶Ç: 192.168.1.100 Êàñ 192.168.1.0/24" required>
                                <small style="color: #6b7280; font-size: 12px;">ÊîØÊè¥ÂñÆ‰∏ÄIPÊàñCIDRÊ†ºÂºèÁöÑIPÊÆµ</small>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ÊèèËø∞</label>
                                <input type="text" class="form-input" id="ipDescription" placeholder="‰æãÂ¶Ç: Ëæ¶ÂÖ¨ÂÆ§Âõ∫ÂÆöIP">
                            </div>
                            <div class="form-group">
                                <label class="form-label">ÁãÄÊÖã</label>
                                <select class="form-select" id="ipStatus">
                                    <option value="active" selected>ÂïüÁî®</option>
                                    <option value="inactive">ÂÅúÁî®</option>
                                </select>
                            </div>
                        </form>
                        <div class="modal-footer">
                            <button type="button" class="btn secondary" onclick="this.closest('.modal').remove()">ÂèñÊ∂à</button>
                            <button type="button" class="btn primary" onclick="saveIPWhitelist()">‰øùÂ≠ò</button>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
            }

            function saveIPWhitelist() {
                const ip = document.getElementById('ipAddress').value;
                const description = document.getElementById('ipDescription').value;
                const status = document.getElementById('ipStatus').value;

                if (!ip) {
                    alert('Ë´ãËº∏ÂÖ•IPÂú∞ÂùÄÔºÅ');
                    return;
                }

                // Á∞°ÂñÆÁöÑIPÊ†ºÂºèÈ©óË≠â
                const ipPattern = /^(\d{1,3}\.){3}\d{1,3}(\/\d{1,2})?$/;
                if (!ipPattern.test(ip)) {
                    alert('IPÂú∞ÂùÄÊ†ºÂºè‰∏çÊ≠£Á¢∫ÔºÅ');
                    return;
                }

                const newItem = {
                    id: Math.max(...ipWhitelist.map(item => item.id), 0) + 1,
                    ip,
                    description: description || 'ÁÑ°ÊèèËø∞',
                    status,
                    createdAt: new Date().toISOString().split('T')[0]
                };

                ipWhitelist.unshift(newItem);
                loadIPWhitelist();
                showNotification('IPÁôΩÂêçÂñÆÊñ∞Â¢ûÊàêÂäüÔºÅ', 'success');

                // ÈóúÈñâÊ®°ÊÖãÁ™óÂè£
                document.querySelector('.modal.active').remove();
            }

            function editIPWhitelist(id) {
                const item = ipWhitelist.find(i => i.id === id);
                if (!item) return;

                const modal = document.createElement('div');
                modal.className = 'modal active';
                modal.innerHTML = `
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 class="modal-title">Á∑®ËºØIPÁôΩÂêçÂñÆ</h3>
                            <button class="modal-close" onclick="this.closest('.modal').remove()">&times;</button>
                        </div>
                        <form id="editIPForm">
                            <div class="form-group">
                                <label class="form-label">IPÂú∞ÂùÄÊàñIPÊÆµ *</label>
                                <input type="text" class="form-input" id="editIPAddress" value="${item.ip}" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ÊèèËø∞</label>
                                <input type="text" class="form-input" id="editIPDescription" value="${item.description}">
                            </div>
                            <div class="form-group">
                                <label class="form-label">ÁãÄÊÖã</label>
                                <select class="form-select" id="editIPStatus">
                                    <option value="active" ${item.status === 'active' ? 'selected' : ''}>ÂïüÁî®</option>
                                    <option value="inactive" ${item.status === 'inactive' ? 'selected' : ''}>ÂÅúÁî®</option>
                                </select>
                            </div>
                        </form>
                        <div class="modal-footer">
                            <button type="button" class="btn secondary" onclick="this.closest('.modal').remove()">ÂèñÊ∂à</button>
                            <button type="button" class="btn primary" onclick="updateIPWhitelist(${id})">Êõ¥Êñ∞</button>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
            }

            function updateIPWhitelist(id) {
                const ip = document.getElementById('editIPAddress').value;
                const description = document.getElementById('editIPDescription').value;
                const status = document.getElementById('editIPStatus').value;

                if (!ip) {
                    alert('Ë´ãËº∏ÂÖ•IPÂú∞ÂùÄÔºÅ');
                    return;
                }

                const item = ipWhitelist.find(i => i.id === id);
                if (item) {
                    item.ip = ip;
                    item.description = description || 'ÁÑ°ÊèèËø∞';
                    item.status = status;

                    loadIPWhitelist();
                    showNotification('IPÁôΩÂêçÂñÆÊõ¥Êñ∞ÊàêÂäüÔºÅ', 'success');

                    // ÈóúÈñâÊ®°ÊÖãÁ™óÂè£
                    document.querySelector('.modal.active').remove();
                }
            }

            function deleteIPWhitelist(id) {
                if (confirm('Á¢∫ÂÆöË¶ÅÂà™Èô§Ê≠§IPÁôΩÂêçÂñÆÈ†ÖÁõÆÂóéÔºü')) {
                    ipWhitelist = ipWhitelist.filter(item => item.id !== id);
                    loadIPWhitelist();
                    showNotification('IPÁôΩÂêçÂñÆÈ†ÖÁõÆÂà™Èô§ÊàêÂäüÔºÅ', 'success');
                }
            }

            function blockIP(ip) {
                if (confirm(`Á¢∫ÂÆöË¶ÅÂ∞ÅÈéñIPÂú∞ÂùÄ ${ip} ÂóéÔºü`)) {
                    // ÈÄôË£°ÊáâË©≤Ë™øÁî®APIÂ∞ÅÈéñIP
                    showNotification(`IPÂú∞ÂùÄ ${ip} Â∑≤Ë¢´Â∞ÅÈéñ`, 'success');

                    // Êõ¥Êñ∞ÁôªÂÖ•Êó•Ë™å‰∏≠ÁöÑÁãÄÊÖã
                    const log = loginLogs.find(l => l.ip === ip);
                    if (log) {
                        log.status = 'blocked';
                        loadLoginLogs();
                    }
                }
            }

            // ÂÆâÂÖ®Ë®≠ÂÆö
            function loadSecuritySettings() {
                console.log('ËºâÂÖ•ÂÆâÂÖ®Ë®≠ÂÆö');
            }

            function toggleTwoFactorAuth() {
                const checkbox = document.getElementById('twoFactorEnabled');
                if (checkbox.checked) {
                    showNotification('ÈõôÈáçË™çË≠âÂ∑≤ÂïüÁî®', 'success');
                } else {
                    showNotification('ÈõôÈáçË™çË≠âÂ∑≤ÂÅúÁî®', 'info');
                }
            }

            function updateSessionTimeout() {
                const timeout = document.getElementById('sessionTimeout').value;
                showNotification(`ÊúÉË©±Ë∂ÖÊôÇÊôÇÈñìÂ∑≤Ë®≠ÂÆöÁÇ∫ ${timeout} ÂàÜÈêò`, 'success');
            }

            function updatePasswordPolicy() {
                showNotification('ÂØÜÁ¢ºÊîøÁ≠ñÂ∑≤Êõ¥Êñ∞', 'success');
            }

            function editIPRule(ip) {
                alert(`Á∑®ËºØIPË¶èÂâá ${ip} ÂäüËÉΩÈñãÁôº‰∏≠...`);
            }

            function deleteIPRule(ip) {
                if (confirm(`Á¢∫ÂÆöË¶ÅÂà™Èô§IPË¶èÂâá ${ip} ÂóéÔºü`)) {
                    alert(`Âà™Èô§IPË¶èÂâá ${ip} ÂäüËÉΩÈñãÁôº‰∏≠...`);
                }
            }

            // ÈÄöÁü•ÁÆ°ÁêÜÂäüËÉΩ
            function loadNotifications() {
                console.log('ËºâÂÖ•ÈÄöÁü•ÁÆ°ÁêÜ');
                loadNotificationStats();
                loadRecentNotifications();
            }

            // ËºâÂÖ•ÈÄöÁü•Áµ±Ë®à
            function loadNotificationStats() {
                const stats = {
                    todayNotifications: Math.floor(Math.random() * 50) + 20,
                    pendingNotifications: Math.floor(Math.random() * 200) + 100,
                    deliveryRate: (Math.random() * 10 + 85).toFixed(1)
                };

                // Êõ¥Êñ∞Áµ±Ë®àÊï∏Êìö
                const statCards = document.querySelectorAll('.notification-stat-number');
                if (statCards.length >= 3) {
                    statCards[0].textContent = stats.todayNotifications;
                    statCards[1].textContent = stats.pendingNotifications;
                    statCards[2].textContent = stats.deliveryRate + '%';
                }
            }

            // ËºâÂÖ•ÊúÄËøëÈÄöÁü•
            function loadRecentNotifications() {
                const container = document.querySelector('.recent-notifications');
                if (!container) return;

                const notifications = [
                    { icon: 'üé´', title: 'Êñ∞ÂÑ™ÊÉ†Âà∏ÂæÖÂØ©Ê†∏', time: '2 ÂàÜÈêòÂâç', status: 'Â∑≤ÈÄÅÈÅî' },
                    { icon: 'üë§', title: 'Êñ∞Áî®Êà∂Ë®ªÂÜä', time: '5 ÂàÜÈêòÂâç', status: 'Â∑≤ÈÄÅÈÅî' },
                    { icon: 'üè™', title: 'Âª†ÂïÜÁî≥Ë´ãÂØ©Ê†∏', time: '10 ÂàÜÈêòÂâç', status: 'ËôïÁêÜ‰∏≠' },
                    { icon: '‚ö†Ô∏è', title: 'Á≥ªÁµ±Áï∞Â∏∏Ë≠¶Â†±', time: '15 ÂàÜÈêòÂâç', status: 'Â§±Êïó' }
                ];

                const notificationsList = notifications.map(notification => `
                    <div class="notification-item" style="display: flex; align-items: center; padding: 12px; border-bottom: 1px solid #f3f4f6;">
                        <div class="notification-icon" style="font-size: 24px; margin-right: 12px;">${notification.icon}</div>
                        <div class="notification-content" style="flex: 1;">
                            <div class="notification-title" style="font-weight: 500;">${notification.title}</div>
                            <div class="notification-time" style="font-size: 12px; color: #6b7280;">${notification.time}</div>
                        </div>
                        <div class="notification-status">
                            <span class="badge ${notification.status === 'Â∑≤ÈÄÅÈÅî' ? 'status-active' : notification.status === 'ËôïÁêÜ‰∏≠' ? 'status-pending' : 'status-rejected'}">
                                ${notification.status}
                            </span>
                        </div>
                    </div>
                `).join('');

                container.innerHTML = `
                    <h4 style="margin-bottom: 16px;">ÊúÄËøëÈÄöÁü•</h4>
                    ${notificationsList}
                `;
            }

            function sendBroadcast() {
                const modal = document.createElement('div');
                modal.className = 'modal active';
                modal.innerHTML = `
                    <div class="modal-content" style="max-width: 600px;">
                        <div class="modal-header">
                            <h3 class="modal-title">üì¢ ÁôºÈÄÅÂª£Êí≠ÈÄöÁü•</h3>
                            <button class="modal-close" onclick="this.closest('.modal').remove()">&times;</button>
                        </div>
                        <form id="broadcastForm">
                            <div class="form-group">
                                <label class="form-label">ÈÄöÁü•Ê®ôÈ°å *</label>
                                <input type="text" class="form-input" id="notificationTitle" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ÈÄöÁü•ÂÖßÂÆπ *</label>
                                <textarea class="form-textarea" id="notificationContent" required style="min-height: 120px;"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Êé•Êî∂Â∞çË±°</label>
                                <select class="form-select" id="targetAudience">
                                    <option value="all">ÊâÄÊúâÁî®Êà∂</option>
                                    <option value="customers">‰∏ÄËà¨ÊúÉÂì°</option>
                                    <option value="vendors">Âª†ÂïÜÁî®Êà∂</option>
                                    <option value="admins">ÁÆ°ÁêÜÂì°</option>
                                </select>
                            </div>
                        </form>
                        <div class="modal-footer">
                            <button type="button" class="btn secondary" onclick="this.closest('.modal').remove()">ÂèñÊ∂à</button>
                            <button type="button" class="btn primary" onclick="sendBroadcastNotification()">ÁôºÈÄÅÈÄöÁü•</button>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
            }

            function sendBroadcastNotification() {
                const title = document.getElementById('notificationTitle').value;
                const content = document.getElementById('notificationContent').value;
                const audience = document.getElementById('targetAudience').value;

                if (!title || !content) {
                    alert('Ë´ãÂ°´ÂØ´Ê®ôÈ°åÂíåÂÖßÂÆπÔºÅ');
                    return;
                }

                if (confirm(`Á¢∫Ë™çÁôºÈÄÅÂª£Êí≠ÈÄöÁü•Áµ¶${audience === 'all' ? 'ÊâÄÊúâÁî®Êà∂' : audience === 'customers' ? '‰∏ÄËà¨ÊúÉÂì°' : audience === 'vendors' ? 'Âª†ÂïÜÁî®Êà∂' : 'ÁÆ°ÁêÜÂì°'}Ôºü`)) {
                    showNotification('Âª£Êí≠ÈÄöÁü•ÁôºÈÄÅÊàêÂäüÔºÅ', 'success');
                    document.querySelector('.modal.active').remove();
                    loadRecentNotifications();
                    loadNotificationStats();
                }
            }

            function createEmailTemplate() {
                const modal = document.createElement('div');
                modal.className = 'modal active';
                modal.innerHTML = `
                    <div class="modal-content" style="max-width: 700px;">
                        <div class="modal-header">
                            <h3 class="modal-title">Êñ∞Â¢ûÈÉµ‰ª∂Ê®°Êùø</h3>
                            <button class="modal-close" onclick="this.closest('.modal').remove()">&times;</button>
                        </div>
                        <form id="emailTemplateForm">
                            <div class="form-group">
                                <label class="form-label">Ê®°ÊùøÂêçÁ®± *</label>
                                <input type="text" class="form-input" id="templateName" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ÈÉµ‰ª∂‰∏ªÊó® *</label>
                                <input type="text" class="form-input" id="templateSubject" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ÈÉµ‰ª∂ÂÖßÂÆπ *</label>
                                <textarea class="form-textarea" id="templateContent" required style="min-height: 200px;"></textarea>
                            </div>
                        </form>
                        <div class="modal-footer">
                            <button type="button" class="btn secondary" onclick="this.closest('.modal').remove()">ÂèñÊ∂à</button>
                            <button type="button" class="btn primary" onclick="saveEmailTemplate()">‰øùÂ≠òÊ®°Êùø</button>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
            }

            function saveEmailTemplate() {
                const name = document.getElementById('templateName').value;
                const subject = document.getElementById('templateSubject').value;
                const content = document.getElementById('templateContent').value;

                if (!name || !subject || !content) {
                    alert('Ë´ãÂ°´ÂØ´ÊâÄÊúâÊ¨Ñ‰ΩçÔºÅ');
                    return;
                }

                showNotification('ÈÉµ‰ª∂Ê®°ÊùøÊñ∞Â¢ûÊàêÂäüÔºÅ', 'success');
                document.querySelector('.modal.active').remove();
            }

            function editEmailTemplate(type) {
                const templates = {
                    'welcome': { name: 'Ê≠°ËøéÈÉµ‰ª∂', subject: 'Ê≠°ËøéÂä†ÂÖ•ÈÄÅÂó®Â∫∑ÔºÅ', content: 'Ë¶™ÊÑõÁöÑÁî®Êà∂ÔºåÊ≠°ËøéÂä†ÂÖ•ÊàëÂÄëÁöÑÂπ≥Âè∞...' },
                    'password-reset': { name: 'ÂØÜÁ¢ºÈáçÁΩÆ', subject: 'ÂØÜÁ¢ºÈáçÁΩÆÁ¢∫Ë™ç', content: 'Ë´ãÈªûÊìäÈÄ£ÁµêÈáçÁΩÆÊÇ®ÁöÑÂØÜÁ¢º...' },
                    'coupon-notify': { name: 'ÂÑ™ÊÉ†Âà∏ÈÄöÁü•', subject: 'Êñ∞ÂÑ™ÊÉ†Âà∏‰∏äÁ∑ö‰∫ÜÔºÅ', content: 'ÊàëÂÄëÁÇ∫ÊÇ®Êé®Ëñ¶Êñ∞ÁöÑÂÑ™ÊÉ†Âà∏...' }
                };

                const template = templates[type];
                if (!template) return;

                const modal = document.createElement('div');
                modal.className = 'modal active';
                modal.innerHTML = `
                    <div class="modal-content" style="max-width: 700px;">
                        <div class="modal-header">
                            <h3 class="modal-title">Á∑®ËºØ ${template.name}</h3>
                            <button class="modal-close" onclick="this.closest('.modal').remove()">&times;</button>
                        </div>
                        <form>
                            <div class="form-group">
                                <label class="form-label">ÈÉµ‰ª∂‰∏ªÊó®</label>
                                <input type="text" class="form-input" value="${template.subject}">
                            </div>
                            <div class="form-group">
                                <label class="form-label">ÈÉµ‰ª∂ÂÖßÂÆπ</label>
                                <textarea class="form-textarea" style="min-height: 200px;">${template.content}</textarea>
                            </div>
                        </form>
                        <div class="modal-footer">
                            <button type="button" class="btn secondary" onclick="previewEmailModal('${type}')">È†êË¶Ω</button>
                            <button type="button" class="btn secondary" onclick="this.closest('.modal').remove()">ÂèñÊ∂à</button>
                            <button type="button" class="btn primary" onclick="updateEmailTemplate('${type}')">Êõ¥Êñ∞</button>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
            }

            function updateEmailTemplate(type) {
                showNotification('ÈÉµ‰ª∂Ê®°ÊùøÊõ¥Êñ∞ÊàêÂäüÔºÅ', 'success');
                document.querySelector('.modal.active').remove();
            }

            function previewEmail(type) {
                const templates = {
                    'welcome': 'Ê≠°ËøéÂä†ÂÖ•ÈÄÅÂó®Â∫∑ÔºÅÊÑüË¨ùÊÇ®ÁöÑË®ªÂÜä...',
                    'password-reset': 'Ë´ãÈªûÊìä‰ª•‰∏ãÈÄ£ÁµêÈáçÁΩÆÊÇ®ÁöÑÂØÜÁ¢º...',
                    'coupon-notify': 'Êñ∞ÂÑ™ÊÉ†Âà∏‰∏äÁ∑ö‰∫ÜÔºÅÂø´‰æÜÁúãÁúãÂêß...'
                };

                alert(`È†êË¶Ω ${type} ÈÉµ‰ª∂Ê®°ÊùøÔºö\n\n${templates[type]}`);
            }

            function previewEmailModal(type) {
                const templates = {
                    'welcome': { subject: 'Ê≠°ËøéÂä†ÂÖ•ÈÄÅÂó®Â∫∑ÔºÅ', content: 'Ë¶™ÊÑõÁöÑÁî®Êà∂Ôºå<br>Ê≠°ËøéÂä†ÂÖ•ÊàëÂÄëÁöÑÂπ≥Âè∞ÔºÅ<br>ÊÇ®ÁèæÂú®ÂèØ‰ª•ÈñãÂßãÊé¢Á¥¢ÂêÑÁ®ÆÂÑ™ÊÉ†Âà∏‰∫Ü„ÄÇ' },
                    'password-reset': { subject: 'ÂØÜÁ¢ºÈáçÁΩÆÁ¢∫Ë™ç', content: 'Ë¶™ÊÑõÁöÑÁî®Êà∂Ôºå<br>Ë´ãÈªûÊìä‰ª•‰∏ãÈÄ£ÁµêÈáçÁΩÆÊÇ®ÁöÑÂØÜÁ¢ºÔºö<br><a href="#">ÈáçÁΩÆÂØÜÁ¢º</a>' },
                    'coupon-notify': { subject: 'Êñ∞ÂÑ™ÊÉ†Âà∏‰∏äÁ∑ö‰∫ÜÔºÅ', content: 'Ë¶™ÊÑõÁöÑÁî®Êà∂Ôºå<br>ÊàëÂÄëÁÇ∫ÊÇ®Êé®Ëñ¶Êñ∞ÁöÑÂÑ™ÊÉ†Âà∏Ôºö<br>ÁæéÈ£üÈ§êÂª≥85ÊäòÂÑ™ÊÉ†' }
                };

                const template = templates[type];
                const modal = document.createElement('div');
                modal.className = 'modal active';
                modal.innerHTML = `
                    <div class="modal-content" style="max-width: 600px;">
                        <div class="modal-header">
                            <h3 class="modal-title">ÈÉµ‰ª∂È†êË¶Ω</h3>
                            <button class="modal-close" onclick="this.closest('.modal').remove()">&times;</button>
                        </div>
                        <div style="padding: 20px;">
                            <div style="margin-bottom: 16px; padding: 12px; background: #f9fafb; border-radius: 6px;">
                                <strong>‰∏ªÊó®Ôºö</strong>${template.subject}
                            </div>
                            <div style="border: 1px solid #e5e7eb; border-radius: 8px; padding: 20px; background: white;">
                                ${template.content}
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn secondary" onclick="this.closest('.modal').remove()">ÈóúÈñâ</button>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
            }

            // Â§ñËßÄË®≠ÂÆöÂäüËÉΩ
            let currentTheme = 'default';
            let logoFile = null;
            let websiteSettings = {
                siteName: 'ÈÄÅÂó®Â∫∑',
                siteDescription: 'ÊúÄÂÑ™Ë≥™ÁöÑÂÑ™ÊÉ†Âà∏Âπ≥Âè∞',
                siteKeywords: 'ÂÑ™ÊÉ†Âà∏,ÊäòÊâ£,‰øÉÈä∑,Ë≥ºÁâ©',
                contactEmail: 'contact@example.com',
                socialMedia: {
                    facebook: '',
                    instagram: '',
                    twitter: '',
                    youtube: ''
                },
                seo: {
                    googleAnalytics: '',
                    facebookPixel: '',
                    metaTitle: 'ÈÄÅÂó®Â∫∑ - ÊúÄÂÑ™Ë≥™ÁöÑÂÑ™ÊÉ†Âà∏Âπ≥Âè∞',
                    metaDescription: 'ÁôºÁèæÊúÄÊñ∞„ÄÅÊúÄÂÑ™Ë≥™ÁöÑÂÑ™ÊÉ†Âà∏ÔºåËÆìÊÇ®ÁöÑË≥ºÁâ©Êõ¥ÂàíÁÆóÔºÅ'
                }
            };

            function loadAppearanceSettings() {
                console.log('ËºâÂÖ•Â§ñËßÄË®≠ÂÆö');
                updateColorInputs();
                loadWebsiteSettings();
                loadThemeSettings();
                // ËºâÂÖ•ÂÖ®Á´ô Logo
                (async () => {
                    try {
                        const res = await fetch('../api/settings?keys=site_logo', { headers: getAuthHeaders() });
                        const data = await res.json();
                        if (data.success && data.data && data.data.site_logo) {
                            const url = data.data.site_logo;
                            const img = document.getElementById('logoPreview');
                            if (img && url) { img.src = url.startsWith('http') ? url : ('..' + (url.startsWith('/') ? '' : '/') + url); }
                        }
                    } catch (e) { /* ÂøΩÁï•Â§±Êïó */ }
                })();
            }

            // ‰∏ªÈ°åÁÆ°ÁêÜ
            const themes = {
                'default': {
                    name: 'È†êË®≠‰∏ªÈ°å',
                    primaryColor: '#FCA311',
                    secondaryColor: '#14213D',
                    backgroundColor: '#F8F7F6',
                    textColor: '#333333',
                    description: 'Á∂ìÂÖ∏ÁöÑÊ©ôËâ≤‰∏ªÈ°åÔºåÊ∫´ÊöñÂèãÂ•Ω'
                },
                'blue': {
                    name: 'ËóçËâ≤‰∏ªÈ°å',
                    primaryColor: '#3B82F6',
                    secondaryColor: '#1E40AF',
                    backgroundColor: '#F8FAFC',
                    textColor: '#1F2937',
                    description: 'Â∞àÊ•≠ÁöÑËóçËâ≤‰∏ªÈ°åÔºåÂïÜÂãôÊÑüÂçÅË∂≥'
                },
                'green': {
                    name: 'Á∂†Ëâ≤‰∏ªÈ°å',
                    primaryColor: '#10B981',
                    secondaryColor: '#059669',
                    backgroundColor: '#F0FDF4',
                    textColor: '#1F2937',
                    description: 'Ê∏ÖÊñ∞ÁöÑÁ∂†Ëâ≤‰∏ªÈ°åÔºåËá™ÁÑ∂ËàíÈÅ©'
                },
                'purple': {
                    name: 'Á¥´Ëâ≤‰∏ªÈ°å',
                    primaryColor: '#8B5CF6',
                    secondaryColor: '#7C3AED',
                    backgroundColor: '#FAF5FF',
                    textColor: '#1F2937',
                    description: 'ÂÑ™ÈõÖÁöÑÁ¥´Ëâ≤‰∏ªÈ°åÔºåÊôÇÂ∞öÁèæ‰ª£'
                }
            };

            function loadThemeSettings() {
                // Á¢∫‰øùÈ†êË®≠‰∏ªÈ°åË¢´ÈÅ∏‰∏≠
                const defaultThemeOption = document.querySelector('.theme-option[onclick*="default"]');
                if (defaultThemeOption && !document.querySelector('.theme-option.active')) {
                    defaultThemeOption.classList.add('active');
                }
            }

            function selectTheme(theme) {
                // ÁßªÈô§ÊâÄÊúâ‰∏ªÈ°åÁöÑactiveÈ°û
                document.querySelectorAll('.theme-option').forEach(option => {
                    option.classList.remove('active');
                });

                // Ê∑ªÂä†ÈÅ∏‰∏≠‰∏ªÈ°åÁöÑactiveÈ°û
                event.target.closest('.theme-option').classList.add('active');

                currentTheme = theme;
                const themeData = themes[theme];

                if (themeData) {
                    // Êõ¥Êñ∞È°èËâ≤Ëº∏ÂÖ•Ê°Ü
                    document.getElementById('primaryColor').value = themeData.primaryColor;
                    document.getElementById('secondaryColor').value = themeData.secondaryColor;
                    document.getElementById('backgroundColor').value = themeData.backgroundColor;
                    document.getElementById('textColor').value = themeData.textColor;

                    // Êõ¥Êñ∞Â∞çÊáâÁöÑÊñáÂ≠óËº∏ÂÖ•Ê°Ü
                    document.getElementById('primaryColor').nextElementSibling.value = themeData.primaryColor;
                    document.getElementById('secondaryColor').nextElementSibling.value = themeData.secondaryColor;
                    document.getElementById('backgroundColor').nextElementSibling.value = themeData.backgroundColor;
                    document.getElementById('textColor').nextElementSibling.value = themeData.textColor;

                    // Êõ¥Êñ∞È†êË¶Ω
                    updateColorPreview();

                    showNotification(`Â∑≤ÈÅ∏Êìá ${themeData.name}`, 'success');
                }
            }

            // LogoÁÆ°ÁêÜ
            function uploadLogo(input) {
                if (input.files && input.files[0]) {
                    const file = input.files[0];

                    // Ê™¢Êü•Ê™îÊ°àÈ°ûÂûã
                    if (!file.type.startsWith('image/')) {
                        alert('Ë´ãÈÅ∏ÊìáÂúñÁâáÊ™îÊ°àÔºÅ');
                        return;
                    }

                    // Ê™¢Êü•Ê™îÊ°àÂ§ßÂ∞è (2MB)
                    if (file.size > 2 * 1024 * 1024) {
                        alert('Ê™îÊ°àÂ§ßÂ∞è‰∏çËÉΩË∂ÖÈÅé 2MBÔºÅ');
                        return;
                    }

                    const reader = new FileReader();
                    reader.onload = function (e) {
                        document.getElementById('logoPreview').src = e.target.result;
                        logoFile = file;
                        showNotification('LogoÈ†êË¶ΩÂ∑≤Êõ¥Êñ∞ÔºåË´ãÈªûÊìä"‰øùÂ≠òLogo"‰ª•Â•óÁî®', 'info');
                    };
                    reader.readAsDataURL(file);
                }
            }

            async function saveLogo() {
                if (!logoFile) { alert('Ë´ãÂÖàÈÅ∏ÊìáLogoÊ™îÊ°àÔºÅ'); return; }
                const tip = document.createElement('div');
                tip.style.cssText = 'position:fixed;top:20px;right:20px;background:#fff;padding:12px 16px;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,.15);z-index:10000';
                tip.innerHTML = '<div style="display:flex;align-items:center;gap:10px;"><div class="loading" style="width:20px;height:20px;"></div><span>Ê≠£Âú®‰∏äÂÇ≥ Logo...</span></div>';
                document.body.appendChild(tip);
                try {
                    // 1) ‰∏äÂÇ≥ÂúñÁâá
                    const form = new FormData();
                    form.append('file', logoFile);
                    form.append('type', 'logo');
                    const upRes = await fetch('../api/upload/image', { method: 'POST', headers: { 'Authorization': `Bearer ${getAuthToken()}` }, body: form });
                    const upJson = await upRes.json();
                    if (!upJson.success) { alert(upJson.message || '‰∏äÂÇ≥Â§±Êïó'); return; }
                    const url = upJson.data?.url;

                    // 2) ÂØ´ÂÖ•Á≥ªÁµ±Ë®≠ÂÆö site_logo
                    const setRes = await fetch('../api/settings', { method: 'PUT', headers: getAuthHeaders(), body: JSON.stringify({ site_logo: url }) });
                    const setJson = await setRes.json();
                    if (!setJson.success) { alert(setJson.message || '‰øùÂ≠òË®≠ÂÆöÂ§±Êïó'); return; }

                    showNotification('Logo Â∑≤‰∏äÂÇ≥‰∏¶ÂÑ≤Â≠òÁÇ∫ÂÖ®Á´ô Logo', 'success');
                    logoFile = null;
                } catch (e) {
                    alert('‰∏äÂÇ≥Êàñ‰øùÂ≠òÂ§±ÊïóÔºö' + e.message);
                } finally { tip.remove(); }
            }

            function resetLogo() {
                if (confirm('Á¢∫ÂÆöË¶ÅÈáçÁΩÆLogoÁÇ∫È†êË®≠ÂóéÔºü')) {
                    document.getElementById('logoPreview').src = "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIiByeD0iMTAiIGZpbGw9IiNGQ0EzMTEiLz4KPHRleHQgeD0iNTAiIHk9IjU1IiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMzAiIGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+U0g8L3RleHQ+Cjwvc3ZnPg==";
                    logoFile = null;
                    showNotification('LogoÂ∑≤ÈáçÁΩÆÁÇ∫È†êË®≠', 'success');
                }
            }

            // Ëâ≤ÂΩ©ÊñπÊ°àÁÆ°ÁêÜ
            function updateColorInputs() {
                // ÂêåÊ≠•È°èËâ≤ÈÅ∏ÊìáÂô®ÂíåÊñáÂ≠óËº∏ÂÖ•Ê°Ü
                const colorInputs = document.querySelectorAll('input[type="color"]');
                colorInputs.forEach(input => {
                    const textInput = input.nextElementSibling;
                    if (textInput && textInput.type === 'text') {
                        input.addEventListener('change', function () {
                            textInput.value = this.value.toUpperCase();
                            updateColorPreview();
                        });

                        textInput.addEventListener('input', function () {
                            if (/^#[0-9A-F]{6}$/i.test(this.value)) {
                                input.value = this.value;
                                updateColorPreview();
                            }
                        });
                    }
                });

                // ÂàùÂßãÂåñÈ†êË¶Ω
                setTimeout(updateColorPreview, 100);
            }

            function updateColorPreview() {
                const primaryColor = document.getElementById('primaryColor').value;
                const secondaryColor = document.getElementById('secondaryColor').value;
                const backgroundColor = document.getElementById('backgroundColor').value;
                const textColor = document.getElementById('textColor').value;

                const previewHeader = document.querySelector('.preview-header');
                const previewContent = document.querySelector('.preview-content');
                const previewText = document.querySelector('.preview-content p');
                const previewButton = document.querySelector('.preview-content button');

                if (previewHeader) previewHeader.style.background = primaryColor;
                if (previewContent) previewContent.style.background = backgroundColor;
                if (previewText) previewText.style.color = textColor;
                if (previewButton) {
                    previewButton.style.background = secondaryColor;
                    previewButton.style.color = 'white';
                }
            }

            function applyColorScheme() {
                const primaryColor = document.getElementById('primaryColor').value;
                const secondaryColor = document.getElementById('secondaryColor').value;
                const backgroundColor = document.getElementById('backgroundColor').value;
                const textColor = document.getElementById('textColor').value;

                if (confirm('Á¢∫ÂÆöË¶ÅÂ•óÁî®Êñ∞ÁöÑËâ≤ÂΩ©ÊñπÊ°àÂóéÔºüÈÄôÂ∞áÂΩ±ÈüøÊï¥ÂÄãÁ∂≤Á´ôÁöÑÂ§ñËßÄ„ÄÇ')) {
                    // Ê®°Êì¨Â•óÁî®ÈÅéÁ®ã
                    const applyProgress = document.createElement('div');
                    applyProgress.style.cssText = `
                        position: fixed;
                        top: 50%;
                        left: 50%;
                        transform: translate(-50%, -50%);
                        background: white;
                        padding: 24px;
                        border-radius: 12px;
                        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
                        z-index: 10000;
                        text-align: center;
                    `;
                    applyProgress.innerHTML = `
                        <div class="loading" style="margin: 0 auto 16px;"></div>
                        <div>Ê≠£Âú®Â•óÁî®Ëâ≤ÂΩ©ÊñπÊ°à...</div>
                        <div style="font-size: 12px; color: #6b7280; margin-top: 8px;">Ë´ãÁ®çÂÄô</div>
                    `;
                    document.body.appendChild(applyProgress);

                    setTimeout(() => {
                        applyProgress.remove();
                        showNotification('Ëâ≤ÂΩ©ÊñπÊ°àÂ•óÁî®ÊàêÂäüÔºÅ', 'success');

                        // ÂØ¶ÈöõÊáâÁî®‰∏≠ÔºåÈÄôË£°ÊúÉË™øÁî®API‰øùÂ≠òË®≠ÂÆö
                        console.log('Â•óÁî®Ëâ≤ÂΩ©ÊñπÊ°à:', {
                            primary: primaryColor,
                            secondary: secondaryColor,
                            background: backgroundColor,
                            text: textColor
                        });
                    }, 2000);
                }
            }

            function resetColorScheme() {
                if (confirm('Á¢∫ÂÆöË¶ÅÈáçÁΩÆËâ≤ÂΩ©ÊñπÊ°àÁÇ∫È†êË®≠ÂÄºÂóéÔºü')) {
                    const defaultTheme = themes['default'];
                    document.getElementById('primaryColor').value = defaultTheme.primaryColor;
                    document.getElementById('secondaryColor').value = defaultTheme.secondaryColor;
                    document.getElementById('backgroundColor').value = defaultTheme.backgroundColor;
                    document.getElementById('textColor').value = defaultTheme.textColor;

                    // Êõ¥Êñ∞ÊñáÂ≠óËº∏ÂÖ•Ê°Ü
                    document.getElementById('primaryColor').nextElementSibling.value = defaultTheme.primaryColor;
                    document.getElementById('secondaryColor').nextElementSibling.value = defaultTheme.secondaryColor;
                    document.getElementById('backgroundColor').nextElementSibling.value = defaultTheme.backgroundColor;
                    document.getElementById('textColor').nextElementSibling.value = defaultTheme.textColor;

                    updateColorPreview();
                    showNotification('Ëâ≤ÂΩ©ÊñπÊ°àÂ∑≤ÈáçÁΩÆÁÇ∫È†êË®≠ÂÄº', 'success');
                }
            }

            // Á∂≤Á´ôË®≠ÂÆöÁÆ°ÁêÜ
            function loadWebsiteSettings() {
                // ËºâÂÖ•ÁèæÊúâË®≠ÂÆöÂà∞Ë°®ÂñÆ‰∏≠
                const settingElements = {
                    'siteName': document.getElementById('siteName'),
                    'siteDescription': document.getElementById('siteDescription'),
                    'siteKeywords': document.getElementById('siteKeywords'),
                    'contactEmail': document.getElementById('contactEmail'),
                    'facebookUrl': document.getElementById('facebookUrl'),
                    'instagramUrl': document.getElementById('instagramUrl'),
                    'twitterUrl': document.getElementById('twitterUrl'),
                    'youtubeUrl': document.getElementById('youtubeUrl'),
                    'googleAnalytics': document.getElementById('googleAnalytics'),
                    'facebookPixel': document.getElementById('facebookPixel'),
                    'metaTitle': document.getElementById('metaTitle'),
                    'metaDescription': document.getElementById('metaDescription')
                };

                // Ë®≠ÂÆöÈ†êË®≠ÂÄº
                if (settingElements.siteName) settingElements.siteName.value = websiteSettings.siteName;
                if (settingElements.siteDescription) settingElements.siteDescription.value = websiteSettings.siteDescription;
                if (settingElements.siteKeywords) settingElements.siteKeywords.value = websiteSettings.siteKeywords;
                if (settingElements.contactEmail) settingElements.contactEmail.value = websiteSettings.contactEmail;
                if (settingElements.metaTitle) settingElements.metaTitle.value = websiteSettings.seo.metaTitle;
                if (settingElements.metaDescription) settingElements.metaDescription.value = websiteSettings.seo.metaDescription;
            }

            function saveWebsiteSettings() {
                const formData = {
                    siteName: document.getElementById('siteName')?.value || '',
                    siteDescription: document.getElementById('siteDescription')?.value || '',
                    siteKeywords: document.getElementById('siteKeywords')?.value || '',
                    contactEmail: document.getElementById('contactEmail')?.value || '',
                    socialMedia: {
                        facebook: document.getElementById('facebookUrl')?.value || '',
                        instagram: document.getElementById('instagramUrl')?.value || '',
                        twitter: document.getElementById('twitterUrl')?.value || '',
                        youtube: document.getElementById('youtubeUrl')?.value || ''
                    },
                    seo: {
                        googleAnalytics: document.getElementById('googleAnalytics')?.value || '',
                        facebookPixel: document.getElementById('facebookPixel')?.value || '',
                        metaTitle: document.getElementById('metaTitle')?.value || '',
                        metaDescription: document.getElementById('metaDescription')?.value || ''
                    }
                };

                // Âü∫Êú¨È©óË≠â
                if (!formData.siteName) {
                    alert('Ë´ãÂ°´ÂØ´Á∂≤Á´ôÂêçÁ®±ÔºÅ');
                    return;
                }

                if (formData.contactEmail && !formData.contactEmail.includes('@')) {
                    alert('Ë´ãÂ°´ÂØ´ÊúâÊïàÁöÑËÅØÁµ°ÈÉµÁÆ±ÔºÅ');
                    return;
                }

                // Ê®°Êì¨‰øùÂ≠òÈÅéÁ®ã
                const saveProgress = document.createElement('div');
                saveProgress.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: white;
                    padding: 16px;
                    border-radius: 8px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                    z-index: 10000;
                `;
                saveProgress.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div class="loading" style="width: 20px; height: 20px;"></div>
                        <span>Ê≠£Âú®‰øùÂ≠òË®≠ÂÆö...</span>
                    </div>
                `;
                document.body.appendChild(saveProgress);

                setTimeout(() => {
                    websiteSettings = { ...websiteSettings, ...formData };
                    saveProgress.remove();
                    showNotification('Á∂≤Á´ôË®≠ÂÆö‰øùÂ≠òÊàêÂäüÔºÅ', 'success');

                    console.log('‰øùÂ≠òÁöÑÁ∂≤Á´ôË®≠ÂÆö:', websiteSettings);
                }, 1500);
            }

            function resetWebsiteSettings() {
                if (confirm('Á¢∫ÂÆöË¶ÅÈáçÁΩÆÊâÄÊúâÁ∂≤Á´ôË®≠ÂÆöÁÇ∫È†êË®≠ÂÄºÂóéÔºü')) {
                    // ÈáçÁΩÆÁÇ∫È†êË®≠ÂÄº
                    websiteSettings = {
                        siteName: 'ÈÄÅÂó®Â∫∑',
                        siteDescription: 'ÊúÄÂÑ™Ë≥™ÁöÑÂÑ™ÊÉ†Âà∏Âπ≥Âè∞',
                        siteKeywords: 'ÂÑ™ÊÉ†Âà∏,ÊäòÊâ£,‰øÉÈä∑,Ë≥ºÁâ©',
                        contactEmail: 'contact@example.com',
                        socialMedia: {
                            facebook: '',
                            instagram: '',
                            twitter: '',
                            youtube: ''
                        },
                        seo: {
                            googleAnalytics: '',
                            facebookPixel: '',
                            metaTitle: 'ÈÄÅÂó®Â∫∑ - ÊúÄÂÑ™Ë≥™ÁöÑÂÑ™ÊÉ†Âà∏Âπ≥Âè∞',
                            metaDescription: 'ÁôºÁèæÊúÄÊñ∞„ÄÅÊúÄÂÑ™Ë≥™ÁöÑÂÑ™ÊÉ†Âà∏ÔºåËÆìÊÇ®ÁöÑË≥ºÁâ©Êõ¥ÂàíÁÆóÔºÅ'
                        }
                    };

                    loadWebsiteSettings();
                    showNotification('Á∂≤Á´ôË®≠ÂÆöÂ∑≤ÈáçÁΩÆÁÇ∫È†êË®≠ÂÄº', 'success');
                }
            }

            // Ëá™ÂÆöÁæ©CSS
            function saveCustomCSS() {
                const customCSS = document.getElementById('customCSS')?.value || '';

                if (customCSS.length > 10000) {
                    alert('Ëá™ÂÆöÁæ©CSSÈï∑Â∫¶‰∏çËÉΩË∂ÖÈÅé10,000Â≠óÁ¨¶ÔºÅ');
                    return;
                }

                // Ê®°Êì¨‰øùÂ≠ò
                showNotification('Ëá™ÂÆöÁæ©CSS‰øùÂ≠òÊàêÂäüÔºÅ', 'success');
                console.log('‰øùÂ≠òÁöÑËá™ÂÆöÁæ©CSS:', customCSS);
            }

            function resetCustomCSS() {
                if (confirm('Á¢∫ÂÆöË¶ÅÊ∏ÖÁ©∫ÊâÄÊúâËá™ÂÆöÁæ©CSSÂóéÔºü')) {
                    const cssTextarea = document.getElementById('customCSS');
                    if (cssTextarea) {
                        cssTextarea.value = '';
                        showNotification('Ëá™ÂÆöÁæ©CSSÂ∑≤Ê∏ÖÁ©∫', 'success');
                    }
                }
            }

            function previewCustomCSS() {
                const customCSS = document.getElementById('customCSS')?.value || '';

                if (!customCSS.trim()) {
                    alert('Ë´ãÂÖàËº∏ÂÖ•Ëá™ÂÆöÁæ©CSSÔºÅ');
                    return;
                }

                // ÂâµÂª∫È†êË¶ΩÁ™óÂè£
                const modal = document.createElement('div');
                modal.className = 'modal active';
                modal.innerHTML = `
                    <div class="modal-content" style="max-width: 700px;">
                        <div class="modal-header">
                            <h3 class="modal-title">CSSÈ†êË¶Ω</h3>
                            <button class="modal-close" onclick="this.closest('.modal').remove()">&times;</button>
                        </div>
                        <div style="padding: 20px;">
                            <div style="margin-bottom: 16px;">
                                <strong>‚ö†Ô∏è Ê≥®ÊÑèÔºö</strong>ÈÄôÂè™ÊòØË™ûÊ≥ïÈ†êË¶ΩÔºåÂØ¶ÈöõÊïàÊûúÈúÄË¶ÅÂ•óÁî®ÂæåÊâçËÉΩÁúãÂà∞„ÄÇ
                            </div>
                            <div style="background: #f8f9fa; border-radius: 8px; padding: 16px; font-family: monospace; font-size: 12px; max-height: 400px; overflow-y: auto; border: 1px solid #e9ecef;">
                                ${customCSS.replace(/\n/g, '<br>').replace(/\s/g, '&nbsp;')}
                            </div>
                            <div style="margin-top: 16px; font-size: 12px; color: #6b7280;">
                                Â≠óÁ¨¶Êï∏Ôºö${customCSS.length} / 10,000
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn secondary" onclick="this.closest('.modal').remove()">ÈóúÈñâ</button>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
            }

            // ÊâπÈáèÊìç‰ΩúÂ¢ûÂº∑ÂäüËÉΩ
            function enableBulkOperations() {
                // ÁÇ∫Áî®Êà∂ÁÆ°ÁêÜË°®Ê†ºÊ∑ªÂä†ÊâπÈáèÈÅ∏ÊìáÂäüËÉΩ
                const userTable = document.querySelector('#users-section .table');
                if (userTable && !userTable.querySelector('.bulk-checkbox')) {
                    addBulkCheckboxes('users');
                }

                // ÁÇ∫ÂÑ™ÊÉ†Âà∏ÁÆ°ÁêÜË°®Ê†ºÊ∑ªÂä†ÊâπÈáèÈÅ∏ÊìáÂäüËÉΩ
                const couponTable = document.querySelector('#coupons-section .table');
                if (couponTable && !couponTable.querySelector('.bulk-checkbox')) {
                    addBulkCheckboxes('coupons');
                }
            }

            function addBulkCheckboxes(type) {
                const table = document.querySelector(`#${type}-section .table`);
                if (!table) return;

                // Ê∑ªÂä†Ë°®È†≠ÁöÑÂÖ®ÈÅ∏Ê°Ü
                const thead = table.querySelector('thead tr');
                if (thead && !thead.querySelector('.bulk-checkbox')) {
                    const th = document.createElement('th');
                    th.innerHTML = '<input type="checkbox" class="bulk-checkbox bulk-select-all" onchange="toggleSelectAll(this, \'' + type + '\')">';
                    thead.insertBefore(th, thead.firstChild);
                }

                // ÁÇ∫ÊØè‰∏ÄË°åÊ∑ªÂä†ÈÅ∏ÊìáÊ°Ü
                const tbody = table.querySelector('tbody');
                const rows = tbody.querySelectorAll('tr');
                rows.forEach((row, index) => {
                    if (!row.querySelector('.bulk-checkbox')) {
                        const td = document.createElement('td');
                        td.innerHTML = `<input type="checkbox" class="bulk-checkbox bulk-item" data-type="${type}" data-id="${index}">`;
                        row.insertBefore(td, row.firstChild);
                    }
                });

                // Ê∑ªÂä†ÊâπÈáèÊìç‰ΩúÊåâÈàï
                addBulkActionButtons(type);
            }

            function addBulkActionButtons(type) {
                const section = document.getElementById(`${type}-section`);
                const cardHeader = section.querySelector('.card-header');

                if (cardHeader && !cardHeader.querySelector('.bulk-actions')) {
                    const bulkActions = document.createElement('div');
                    bulkActions.className = 'bulk-actions';
                    bulkActions.style.display = 'none';
                    bulkActions.innerHTML = `
                        <span class="selected-count">Â∑≤ÈÅ∏Êìá 0 È†Ö</span>
                        <button class="btn secondary" onclick="bulkApprove('${type}')">ÊâπÈáèÊ†∏ÂáÜ</button>
                        <button class="btn secondary" onclick="bulkReject('${type}')">ÊâπÈáèÊãíÁµï</button>
                        <button class="btn secondary" onclick="bulkExport('${type}')">ÊâπÈáèÂåØÂá∫</button>
                        <button class="btn danger" onclick="bulkDelete('${type}')">ÊâπÈáèÂà™Èô§</button>
                    `;
                    cardHeader.appendChild(bulkActions);
                }
            }

            function toggleSelectAll(checkbox, type) {
                const checkboxes = document.querySelectorAll(`input[data-type="${type}"]`);
                checkboxes.forEach(cb => cb.checked = checkbox.checked);
                updateBulkActionButtons(type);
            }

            function updateBulkActionButtons(type) {
                const selectedItems = document.querySelectorAll(`input[data-type="${type}"]:checked`);
                const bulkActions = document.querySelector(`#${type}-section .bulk-actions`);
                const selectedCount = bulkActions.querySelector('.selected-count');

                if (selectedItems.length > 0) {
                    bulkActions.style.display = 'flex';
                    selectedCount.textContent = `Â∑≤ÈÅ∏Êìá ${selectedItems.length} È†Ö`;
                } else {
                    bulkActions.style.display = 'none';
                }
            }

            function bulkApprove(type) {
                const selectedItems = document.querySelectorAll(`input[data-type="${type}"]:checked`);
                if (selectedItems.length === 0) {
                    alert('Ë´ãÂÖàÈÅ∏ÊìáË¶ÅÊ†∏ÂáÜÁöÑÈ†ÖÁõÆ');
                    return;
                }
                if (confirm(`Á¢∫ÂÆöË¶ÅÊâπÈáèÊ†∏ÂáÜ ${selectedItems.length} ÂÄãÈ†ÖÁõÆÂóéÔºü`)) {
                    alert(`ÊâπÈáèÊ†∏ÂáÜ${type}ÂäüËÉΩÈñãÁôº‰∏≠...`);
                }
            }

            function bulkReject(type) {
                const selectedItems = document.querySelectorAll(`input[data-type="${type}"]:checked`);
                if (selectedItems.length === 0) {
                    alert('Ë´ãÂÖàÈÅ∏ÊìáË¶ÅÊãíÁµïÁöÑÈ†ÖÁõÆ');
                    return;
                }
                if (confirm(`Á¢∫ÂÆöË¶ÅÊâπÈáèÊãíÁµï ${selectedItems.length} ÂÄãÈ†ÖÁõÆÂóéÔºü`)) {
                    alert(`ÊâπÈáèÊãíÁµï${type}ÂäüËÉΩÈñãÁôº‰∏≠...`);
                }
            }

            function bulkExport(type) {
                const selectedItems = document.querySelectorAll(`input[data-type="${type}"]:checked`);
                if (selectedItems.length === 0) {
                    alert('Ë´ãÂÖàÈÅ∏ÊìáË¶ÅÂåØÂá∫ÁöÑÈ†ÖÁõÆ');
                    return;
                }
                alert(`ÊâπÈáèÂåØÂá∫${selectedItems.length}ÂÄã${type}ÂäüËÉΩÈñãÁôº‰∏≠...`);
            }

            function bulkDelete(type) {
                const selectedItems = document.querySelectorAll(`input[data-type="${type}"]:checked`);
                if (selectedItems.length === 0) {
                    alert('Ë´ãÂÖàÈÅ∏ÊìáË¶ÅÂà™Èô§ÁöÑÈ†ÖÁõÆ');
                    return;
                }
                if (confirm(`‚ö†Ô∏è Ë≠¶ÂëäÔºöÁ¢∫ÂÆöË¶ÅÊâπÈáèÂà™Èô§ ${selectedItems.length} ÂÄãÈ†ÖÁõÆÂóéÔºüÊ≠§Êìç‰ΩúÁÑ°Ê≥ïÂæ©ÂéüÔºÅ`)) {
                    alert(`ÊâπÈáèÂà™Èô§${type}ÂäüËÉΩÈñãÁôº‰∏≠...`);
                }
            }

            // ÈÄ≤ÈöéÂ†±Ë°®ÂàÜÊûêÂäüËÉΩ
            function generateAdvancedReports() {
                console.log('ÁîüÊàêÈÄ≤ÈöéÂ†±Ë°®');

                // Ê®°Êì¨ÁîüÊàêÁáüÊî∂ÂàÜÊûêÂ†±Ë°®
                const revenueData = {
                    thisMonth: 125000,
                    lastMonth: 98000,
                    growth: 27.6,
                    topCategories: [
                        { name: 'ÁæéÈ£üÈ§êÈ£≤', revenue: 45000, percentage: 36 },
                        { name: 'Ë≥ºÁâ©Ê∂àË≤ª', revenue: 32000, percentage: 25.6 },
                        { name: '‰ºëÈñíÂ®õÊ®Ç', revenue: 28000, percentage: 22.4 },
                        { name: '‰∫§ÈÄöÈÅãËº∏', revenue: 20000, percentage: 16 }
                    ]
                };

                // Ê®°Êì¨Áî®Êà∂Ë°åÁÇ∫ÂàÜÊûê
                const userBehaviorData = {
                    avgSessionDuration: '8ÂàÜ32Áßí',
                    bounceRate: '23.5%',
                    conversionRate: '12.8%',
                    topPages: [
                        { page: 'È¶ñÈ†Å', views: 15420, duration: '5ÂàÜ12Áßí' },
                        { page: 'ÂÑ™ÊÉ†Âà∏ÂàóË°®', views: 12800, duration: '7ÂàÜ45Áßí' },
                        { page: 'ÂÄã‰∫∫‰∏≠ÂøÉ', views: 8900, duration: '4ÂàÜ20Áßí' }
                    ]
                };

                console.log('ÁáüÊî∂ÂàÜÊûê:', revenueData);
                console.log('Áî®Êà∂Ë°åÁÇ∫ÂàÜÊûê:', userBehaviorData);
            }

            // ==================== ÂäüËÉΩÂáΩÊï∏ÁµêÊùü ====================

            // ÂÖ®Â±ÄÈåØË™§ËôïÁêÜ
            window.addEventListener('error', function (e) {
                console.error('JavaScriptÈåØË™§:', e.error);
                console.error('ÈåØË™§‰ΩçÁΩÆ:', e.filename, 'Ë°åËôü:', e.lineno);

                // Â¶ÇÊûúÊòØÊ®°ÊÖãÁ™óÂè£Áõ∏ÈóúÈåØË™§ÔºåÂº∑Âà∂‰øÆÂæ©
                if (e.error && e.error.message && e.error.message.includes('closeModal')) {
                    console.log('Ê™¢Ê∏¨Âà∞Ê®°ÊÖãÁ™óÂè£ÈåØË™§ÔºåÂü∑Ë°å‰øÆÂæ©...');
                    setTimeout(() => {
                        fixLayoutIssues();
                    }, 500);
                }
            });

            // ‰∫ã‰ª∂Áõ£ËÅΩÂô®
            document.addEventListener('DOMContentLoaded', async () => {
                console.log('È†ÅÈù¢ËºâÂÖ•ÈñãÂßã...');

                try {
                    // Âº∑Âà∂ÈáçË®≠È†ÅÈù¢Ê®£Âºè
                    document.body.style.overflow = 'auto';
                    document.body.style.position = 'static';
                    document.body.style.height = 'auto';

                    // Á¢∫‰øùÊâÄÊúâÊ®°ÊÖãÁ™óÂè£ÈÉΩË¢´ÈóúÈñâ
                    document.querySelectorAll('.modal').forEach(modal => {
                        modal.classList.remove('active');
                        modal.style.display = 'none';
                    });

                    // Á¢∫‰øù‰∏ªË¶Å‰ΩàÂ±ÄÂÖÉÁ¥†Ê≠£Â∏∏È°ØÁ§∫
                    const layout = document.querySelector('.layout');
                    const mainContent = document.querySelector('.main-content');
                    const content = document.querySelector('.content');

                    if (layout) {
                        layout.style.display = 'flex';
                        layout.style.position = 'static';
                    }
                    if (mainContent) {
                        mainContent.style.display = 'block';
                        mainContent.style.position = 'static';
                    }
                    if (content) {
                        content.style.display = 'block';
                        content.style.position = 'static';
                    }

                    // Ê™¢Êü•Ë™çË≠â
                    const isAuthenticated = await checkAuth();
                    if (!isAuthenticated) return;

                    // Ë®≠ÁΩÆÂ∞éËà™
                    document.querySelectorAll('.nav-link').forEach(link => {
                        link.addEventListener('click', (e) => {
                            const section = link.getAttribute('data-section');
                            if (section) {
                                e.preventDefault();
                                showSection(section);
                            } else {
                                // ÈùûÂÖßÂµåÂàÜÈ†ÅÔºà‰æãÂ¶ÇÂ§ñÈÄ£ÁÆ°ÁêÜÈ†ÅÔºâÔºåËÆìÈ†êË®≠Ë°åÁÇ∫ÁîüÊïà
                                // Ëã• target="_blank" ÊúÉËá™ÂãïÊñ∞ÈñãÂàÜÈ†Å
                            }
                        });
                    });

                    // Ë®≠ÁΩÆÁØ©ÈÅ∏Âô®
                    setupFilters();

                    // ËºâÂÖ•ÂàùÂßãÊï∏Êìö
                    loadDashboardData();

                    // ÂïüÁî®ÊâπÈáèÊìç‰ΩúÂäüËÉΩ
                    setTimeout(() => {
                        enableBulkOperations();
                    }, 1000);

                    // ÊúÄÁµÇÊ™¢Êü•Âíå‰øÆÂæ©‰ΩàÂ±Ä
                    setTimeout(() => {
                        fixLayoutIssues();
                    }, 2000);

                    console.log('È†ÅÈù¢ËºâÂÖ•ÂÆåÊàê');
                } catch (error) {
                    console.error('È†ÅÈù¢ËºâÂÖ•ÈåØË™§:', error);
                    // Âº∑Âà∂‰øÆÂæ©‰ΩàÂ±Ä
                    setTimeout(() => {
                        fixLayoutIssues();
                    }, 1000);
                }
            });

            // ‰øÆÂæ©‰ΩàÂ±ÄÂïèÈ°åÁöÑÂáΩÊï∏
            function fixLayoutIssues() {
                console.log('Âü∑Ë°å‰ΩàÂ±Ä‰øÆÂæ©Ê™¢Êü•...');

                // Âº∑Âà∂ÈóúÈñâÊâÄÊúâÊ®°ÊÖãÁ™óÂè£
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.classList.remove('active');
                    modal.style.display = 'none';
                });

                // ÈáçË®≠bodyÊ®£Âºè
                document.body.style.overflow = 'auto';
                document.body.style.position = 'static';
                document.body.style.height = 'auto';

                // Á¢∫‰øù‰∏ªË¶Å‰ΩàÂ±ÄÊ≠£Â∏∏
                const layout = document.querySelector('.layout');
                const mainContent = document.querySelector('.main-content');

                if (layout) {
                    layout.style.display = 'flex';
                    layout.style.position = 'static';
                    layout.style.zIndex = 'auto';
                }

                if (mainContent) {
                    mainContent.style.display = 'block';
                    mainContent.style.position = 'static';
                    mainContent.style.zIndex = 'auto';
                }

                console.log('‰ΩàÂ±Ä‰øÆÂæ©ÂÆåÊàê');
            }

            // ---- API helpers ----
            async function apiGet(url) {
                const r = await fetch(url, { headers: getAuthHeaders() });
                try { return await r.json(); } catch { return {}; }
            }
            async function apiPut(url, body) {
                const r = await fetch(url, { method: 'PUT', headers: getAuthHeaders(), body: JSON.stringify(body || {}) });
                try { return await r.json(); } catch { return {}; }
            }

            // ---- Âè≥ÂÅ¥ÊäΩÂ±úÔºöË°åÂÖßÂø´ÈÄüÁ∑®ËºØ ----
            function ensureSideDrawer() {
                if (document.getElementById('sideDrawer')) return;
                const drawer = document.createElement('div');
                drawer.id = 'sideDrawer';
                drawer.style.cssText = `position:fixed;top:0;right:0;bottom:0;width:380px;background:#fff;border-left:1px solid #e5e7eb;box-shadow:-8px 0 24px rgba(0,0,0,.08);transform:translateX(100%);transition:transform .25s ease;z-index:10000;display:flex;flex-direction:column;`;
                drawer.innerHTML = `
                    <div style="padding:14px 16px;border-bottom:1px solid #f3f4f6;display:flex;justify-content:space-between;align-items:center;">
                        <div id="drawerTitle" style="font-weight:700;">Âø´ÈÄüÁ∑®ËºØ</div>
                        <button onclick="closeDrawer()" style="background:none;border:none;font-size:20px;cursor:pointer;color:#6b7280;">√ó</button>
                    </div>
                    <div id="drawerBody" style="padding:14px 16px;overflow-y:auto;"></div>
                    <div style="padding:12px 16px;border-top:1px solid #f3f4f6;display:flex;gap:8px;justify-content:flex-end;">
                        <button class="btn secondary" onclick="closeDrawer()">ÂèñÊ∂à</button>
                        <button class="btn primary" id="drawerSaveBtn">ÂÑ≤Â≠ò</button>
                    </div>`;
                document.body.appendChild(drawer);
            }
            function openDrawer(title, bodyHtml, onSave) {
                ensureSideDrawer();
                document.getElementById('drawerTitle').textContent = title || 'Âø´ÈÄüÁ∑®ËºØ';
                document.getElementById('drawerBody').innerHTML = bodyHtml || '';
                const btn = document.getElementById('drawerSaveBtn');
                btn.onclick = onSave || null;
                document.getElementById('sideDrawer').style.transform = 'translateX(0)';
            }
            function closeDrawer() { const d = document.getElementById('sideDrawer'); if (d) d.style.transform = 'translateX(100%)'; }

            async function openTagDrawer(couponId) {
                const tags = await apiGet('../api/tags?active=1');
                const all = Array.isArray(tags?.data) ? tags.data : (tags?.data?.items || []);
                const current = await apiGet(`../api/coupons/${couponId}/tags`);
                const selected = new Set(((current?.data) || []).map(x => (x.slug || '').toLowerCase()));
                const body = `<div style=\"margin-bottom:8px;color:#6b7280;\">ÂÑ™ÊÉ†Âà∏ #${couponId}</div><div style=\"display:flex;flex-wrap:wrap;gap:8px;\">${all.map(t => `<label class=\\"chip\\"><input type=\\"checkbox\\" name=\\"drawer_tag\\" value=\\"${t.slug}\\" ${selected.has((t.slug || '').toLowerCase()) ? 'checked' : ''}><span>${t.icon || ''}</span>${t.name}</label>`).join('')}</div>`;
                openDrawer('Ë®≠ÂÆöÊ®ôÁ±§', body, async () => {
                    const tag_slugs = Array.from(document.querySelectorAll('input[name="drawer_tag"]:checked')).map(cb => cb.value);
                    const res = await apiPut(`../api/coupons/${couponId}/tags`, { tag_slugs });
                    closeDrawer();
                    showSuccessMessage(res?.message || 'Ê®ôÁ±§Â∑≤‰øùÂ≠ò');
                });
            }
            async function openRegionDrawer(couponId) {
                const regions = await apiGet('../api/regions?active=1');
                const all = (Array.isArray(regions?.data) ? regions.data : (regions?.data?.items || [])).filter(r => (r.level || 1) === 1);
                const current = await apiGet(`../api/coupons/${couponId}/regions`);
                const selected = new Set(((current?.data) || []).map(x => (x.slug || '').toLowerCase()));
                const body = `<div style=\"margin-bottom:8px;color:#6b7280;\">ÂÑ™ÊÉ†Âà∏ #${couponId}</div><div style=\"display:flex;flex-wrap:wrap;gap:8px;\">${all.map(r => `<label class=\\"chip\\"><input type=\\"checkbox\\" name=\\"drawer_region\\" value=\\"${r.slug}\\" ${selected.has((r.slug || '').toLowerCase()) ? 'checked' : ''}><span>üìç</span>${r.name}</label>`).join('')}</div>`;
                openDrawer('Ë®≠ÂÆöÂú∞ÂçÄ', body, async () => {
                    const region_slugs = Array.from(document.querySelectorAll('input[name="drawer_region"]:checked')).map(cb => cb.value);
                    const res = await apiPut(`../api/coupons/${couponId}/regions`, { region_slugs });
                    closeDrawer();
                    showSuccessMessage(res?.message || 'Âú∞ÂçÄÂ∑≤‰øùÂ≠ò');
                });
            }
            // === Ë¶ÜÂØ´ÔºöÊäΩÂ±úÊîπÁî® checkbox DOM ÊñπÂºèÁπ™Ë£Ω ===
            function renderChips(container, items, selectedSet, name, prefixIcon) {
                container.innerHTML = '';
                items.forEach(function (it) {
                    var lab = document.createElement('label');
                    lab.className = 'chip';
                    lab.style.cssText = 'border:1px solid #d1d5db;padding:6px 10px;border-radius:14px;display:inline-flex;align-items:center;gap:6px;';
                    var cb = document.createElement('input');
                    cb.type = 'checkbox';
                    cb.name = name;
                    cb.value = it.slug;
                    cb.checked = selectedSet.has((it.slug || '').toLowerCase());
                    lab.appendChild(cb);
                    var span = document.createElement('span');
                    span.textContent = (prefixIcon ? (prefixIcon + ' ') : '') + (it.icon ? (it.icon + ' ') : '') + (it.name || '');
                    lab.appendChild(span);
                    container.appendChild(lab);
                });
            }

            async function openTagDrawer(couponId) {
                try {
                    ensureSideDrawer();
                    document.getElementById('drawerTitle').textContent = 'Ë®≠ÂÆöÊ®ôÁ±§';
                    var bodyEl = document.getElementById('drawerBody');
                    bodyEl.innerHTML = '';
                    var header = document.createElement('div');
                    header.style.cssText = 'margin-bottom:8px;color:#6b7280;';
                    header.textContent = 'ÂÑ™ÊÉ†Âà∏ #' + couponId;
                    bodyEl.appendChild(header);
                    var chips = document.createElement('div');
                    chips.style.cssText = 'display:flex;flex-wrap:wrap;gap:8px;';
                    bodyEl.appendChild(chips);

                    var tags = await apiGet('../api/tags?active=1');
                    var all = Array.isArray(tags && tags.data) ? tags.data : ((tags && tags.data && tags.data.items) || []);
                    var current = await apiGet('../api/coupons/' + couponId + '/tags');
                    var selected = new Set(((current && current.data) || []).map(function (x) { return (x.slug || '').toLowerCase(); }));

                    renderChips(chips, all, selected, 'drawer_tag', '');

                    var saveBtn = document.getElementById('drawerSaveBtn');
                    saveBtn.onclick = async function () {
                        var tag_slugs = Array.from(document.querySelectorAll('input[name="drawer_tag"]:checked')).map(function (cb) { return cb.value; });
                        var res = await apiPut('../api/coupons/' + couponId + '/tags', { tag_slugs: tag_slugs });
                        closeDrawer();
                        showSuccessMessage((res && res.message) || 'Ê®ôÁ±§Â∑≤‰øùÂ≠ò');
                    };
                    document.getElementById('sideDrawer').style.transform = 'translateX(0)';
                } catch (e) {
                    console.error('openTagDrawer error:', e);
                }
            }

            async function openRegionDrawer(couponId) {
                try {
                    ensureSideDrawer();
                    document.getElementById('drawerTitle').textContent = 'Ë®≠ÂÆöÂú∞ÂçÄ';
                    var bodyEl = document.getElementById('drawerBody');
                    bodyEl.innerHTML = '';
                    var header = document.createElement('div');
                    header.style.cssText = 'margin-bottom:8px;color:#6b7280;';
                    header.textContent = 'ÂÑ™ÊÉ†Âà∏ #' + couponId;
                    bodyEl.appendChild(header);
                    var chips = document.createElement('div');
                    chips.style.cssText = 'display:flex;flex-wrap:wrap;gap:8px;';
                    bodyEl.appendChild(chips);

                    var regions = await apiGet('../api/regions?active=1');
                    var all = Array.isArray(regions && regions.data) ? regions.data : ((regions && regions.data && regions.data.items) || []);
                    all = all.filter(function (r) { return (r.level || 1) === 1; });
                    var current = await apiGet('../api/coupons/' + couponId + '/regions');
                    var selected = new Set(((current && current.data) || []).map(function (x) { return (x.slug || '').toLowerCase(); }));

                    renderChips(chips, all, selected, 'drawer_region', 'üìç');

                    var saveBtn = document.getElementById('drawerSaveBtn');
                    saveBtn.onclick = async function () {
                        var region_slugs = Array.from(document.querySelectorAll('input[name="drawer_region"]:checked')).map(function (cb) { return cb.value; });
                        var res = await apiPut('../api/coupons/' + couponId + '/regions', { region_slugs: region_slugs });
                        closeDrawer();
                        showSuccessMessage((res && res.message) || 'Âú∞ÂçÄÂ∑≤‰øùÂ≠ò');
                    };
                    document.getElementById('sideDrawer').style.transform = 'translateX(0)';
                } catch (e) {
                    console.error('openRegionDrawer error:', e);
                }
            }
        </script>

        <!-- Ê®°ÊÖãÁ™óÂè£ -->
        <!-- ÂÖ¨ÂëäÁÆ°ÁêÜÊ®°ÊÖãÁ™óÂè£ -->
        <div id="announcementModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Êñ∞Â¢ûÂÖ¨Âëä</h3>
                    <button class="modal-close" onclick="closeModal('announcementModal')">&times;</button>
                </div>
                <form id="announcementForm">
                    <div class="form-group">
                        <label class="form-label">ÂÖ¨ÂëäÊ®ôÈ°å *</label>
                        <input type="text" class="form-input" id="announcementTitle" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ÂÖ¨ÂëäÈ°ûÂûã *</label>
                        <select class="form-select" id="announcementType" required>
                            <option value="">Ë´ãÈÅ∏ÊìáÈ°ûÂûã</option>
                            <option value="Á≥ªÁµ±ÂÖ¨Âëä">Á≥ªÁµ±ÂÖ¨Âëä</option>
                            <option value="ÂäüËÉΩÊõ¥Êñ∞">ÂäüËÉΩÊõ¥Êñ∞</option>
                            <option value="Á∂≠Ë≠∑ÈÄöÁü•">Á∂≠Ë≠∑ÈÄöÁü•</option>
                            <option value="Ê¥ªÂãïÂÖ¨Âëä">Ê¥ªÂãïÂÖ¨Âëä</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ÂÖ¨ÂëäÂÖßÂÆπ *</label>
                        <textarea class="form-textarea" id="announcementContent" required></textarea>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                        <div class="form-group">
                            <label class="form-label">ÈñãÂßãÊôÇÈñì *</label>
                            <input type="datetime-local" class="form-input" id="announcementStartTime" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ÁµêÊùüÊôÇÈñì</label>
                            <input type="datetime-local" class="form-input" id="announcementEndTime">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ÁãÄÊÖã</label>
                        <select class="form-select" id="announcementStatus">
                            <option value="draft">ËçâÁ®ø</option>
                            <option value="active" selected>ÂïüÁî®</option>
                            <option value="inactive">ÂÅúÁî®</option>
                        </select>
                    </div>
                </form>
                <div class="modal-footer">
                    <button type="button" class="btn secondary" onclick="closeModal('announcementModal')">ÂèñÊ∂à</button>
                    <button type="button" class="btn primary" onclick="saveAnnouncement()">‰øùÂ≠ò</button>
                </div>
            </div>
        </div>

        <!-- Ëº™Êí≠ÂúñÁÆ°ÁêÜÊ®°ÊÖãÁ™óÂè£ -->
        <div id="bannerModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Êñ∞Â¢ûËº™Êí≠Âúñ</h3>
                    <button class="modal-close" onclick="closeModal('bannerModal')">&times;</button>
                </div>
                <form id="bannerForm">
                    <div class="form-group">
                        <label class="form-label">ÂúñÁâáÊ®ôÈ°å *</label>
                        <input type="text" class="form-input" id="bannerTitle" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ÂúñÁâáÊèèËø∞</label>
                        <input type="text" class="form-input" id="bannerDescription">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ÂúñÁâáÊ™îÊ°à *</label>
                        <input type="file" class="form-input" id="bannerImage" accept="image/*" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ÈÄ£ÁµêÁ∂≤ÂùÄ</label>
                        <input type="url" class="form-input" id="bannerLink" placeholder="https://">
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                        <div class="form-group">
                            <label class="form-label">ÊéíÂ∫èÈ†ÜÂ∫è</label>
                            <input type="number" class="form-input" id="bannerOrder" value="1" min="1">
                        </div>
                        <div class="form-group">
                            <label class="form-label">ÁãÄÊÖã</label>
                            <select class="form-select" id="bannerStatus">
                                <option value="active" selected>ÂïüÁî®</option>
                                <option value="inactive">ÂÅúÁî®</option>
                            </select>
                        </div>
                    </div>
                </form>
                <div class="modal-footer">
                    <button type="button" class="btn secondary" onclick="closeModal('bannerModal')">ÂèñÊ∂à</button>
                    <button type="button" class="btn primary" onclick="saveBanner()">‰øùÂ≠ò</button>
                </div>
            </div>
        </div>

        <!-- FAQÁÆ°ÁêÜÊ®°ÊÖãÁ™óÂè£ -->
        <div id="faqModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Êñ∞Â¢ûÂ∏∏Ë¶ãÂïèÈ°å</h3>
                    <button class="modal-close" onclick="closeModal('faqModal')">&times;</button>
                </div>
                <form id="faqForm">
                    <div class="form-group">
                        <label class="form-label">ÂïèÈ°åÂàÜÈ°û</label>
                        <select class="form-select" id="faqCategory">
                            <option value="general">‰∏ÄËà¨ÂïèÈ°å</option>
                            <option value="account">Â∏≥Êà∂Áõ∏Èóú</option>
                            <option value="coupon">ÂÑ™ÊÉ†Âà∏‰ΩøÁî®</option>
                            <option value="payment">‰ªòÊ¨æÂïèÈ°å</option>
                            <option value="technical">ÊäÄË°ìÊîØÊè¥</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ÂïèÈ°åÂÖßÂÆπ *</label>
                        <textarea class="form-textarea" id="faqQuestion" required placeholder="Ë´ãËº∏ÂÖ•Â∏∏Ë¶ãÂïèÈ°å..."></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ÂõûÁ≠îÂÖßÂÆπ *</label>
                        <textarea class="form-textarea" id="faqAnswer" required placeholder="Ë´ãËº∏ÂÖ•ÂïèÈ°åÂõûÁ≠î..."
                            style="min-height: 120px;"></textarea>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                        <div class="form-group">
                            <label class="form-label">ÊéíÂ∫èÈ†ÜÂ∫è</label>
                            <input type="number" class="form-input" id="faqOrder" value="1" min="1">
                        </div>
                        <div class="form-group">
                            <label class="form-label">ÁãÄÊÖã</label>
                            <select class="form-select" id="faqStatus">
                                <option value="active" selected>ÂïüÁî®</option>
                                <option value="inactive">ÂÅúÁî®</option>
                            </select>
                        </div>
                    </div>
                </form>
                <div class="modal-footer">
                    <button type="button" class="btn secondary" onclick="closeModal('faqModal')">ÂèñÊ∂à</button>
                    <button type="button" class="btn primary" onclick="saveFAQ()">‰øùÂ≠ò</button>
                </div>
            </div>
        </div>

</body>

</html>